(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    602781,      13687]
NotebookOptionsPosition[    591828,      13495]
NotebookOutlinePosition[    592204,      13512]
CellTagsIndexPosition[    592161,      13509]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["HTMEK Kinetics Analysis v.2.0", "Title",
 CellChangeTimes->{{3.733169215591713*^9, 3.733169227491737*^9}, {
  3.756422200691414*^9, 3.756422201135063*^9}, {3.7564378318645687`*^9, 
  3.756437836577393*^9}, {3.759343485861298*^9, 3.759343486124338*^9}, {
  3.761239542647346*^9, 
  3.761239543720529*^9}},ExpressionUUID->"eb34816b-48f3-4f71-97ba-\
9ae535b70148"],

Cell[TextData[StyleBox["Craig Markin and Daniel Mokhtari\nHerschlag and \
Fordyce Labs", "Subchapter",
 FontSize->16]], "Section",
 CellChangeTimes->{{3.756438016270426*^9, 3.7564380278150587`*^9}, {
  3.756438098259276*^9, 
  3.756438117109954*^9}},ExpressionUUID->"545968aa-b484-429a-86b2-\
1e1a3eac1cd1"],

Cell[CellGroupData[{

Cell["Analysis and plotting functions:", "Section",
 CellChangeTimes->{{3.732732210052601*^9, 
  3.732732219292498*^9}},ExpressionUUID->"af3b0309-97dd-46b1-9be6-\
5230c63f43b2"],

Cell["\<\
The hidden cell below contains all the necessary functions for analyzing \
HTMEK kinetic and inhibition data. Evaluate this cell first.\
\>", "Text",
 CellChangeTimes->{{3.7564382272871923`*^9, 
  3.756438260651802*^9}},ExpressionUUID->"cdf60f84-c263-443e-a51e-\
53a1af7c21a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"importstandardcurve", "[", "path_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dataIN", ",", "parsed", ",", "standardcurvedata"}], "}"}], ",",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataIN", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"path", ",", "\"\<Data\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "iterating", " ", "n", " ", "from", " ", "2", " ", "drops", " ", 
        RowBox[{"the", " ", ".", "csv"}], " ", "header", " ", "text"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"parsed", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dataIN", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"dataIN", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{"dataIN", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "9"}], "]"}], "]"}], ",", 
           RowBox[{"dataIN", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "13"}], "]"}], "]"}], ",", 
           RowBox[{"dataIN", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "8"}], "]"}], "]"}], ",", 
           RowBox[{"dataIN", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "6"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "2", ",", 
           RowBox[{"Length", "[", "dataIN", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"convert", " ", "[", "]"}], " ", "brackets", " ", "to", " ", 
        "curly", " ", "brackets", " ", 
        RowBox[{"{", "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"standardcurvedata", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StringDelete", "[", 
            RowBox[{
             RowBox[{"parsed", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "\"\<\\\"\>\""}], 
            "]"}], ",", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"StringReplace", "[", 
               RowBox[{
                RowBox[{"parsed", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"\"\<(\>\"", "\[Rule]", "\"\<{\>\""}]}], "]"}], ",", 
              RowBox[{"\"\<)\>\"", "\[Rule]", "\"\<}\>\""}]}], "]"}], "]"}], 
           ",", 
           RowBox[{"parsed", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{"parsed", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "4"}], "]"}], "]"}], ",", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"Riffle", "[", 
              RowBox[{
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{"StringReplace", "[", 
                   RowBox[{
                    RowBox[{"parsed", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "5"}], "]"}], "]"}], ",", 
                    RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<{\>\""}]}], "]"}], 
                  ",", 
                  RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<}\>\""}]}], "]"}], 
                "]"}], ",", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{"StringReplace", "[", 
                   RowBox[{
                    RowBox[{"parsed", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "6"}], "]"}], "]"}], ",", 
                    RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<{\>\""}]}], "]"}], 
                  ",", 
                  RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<}\>\""}]}], "]"}], 
                "]"}]}], "]"}], ",", "2"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"Length", "[", "parsed", "]"}]}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"replaceBrackets", "[", "stringList_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"test1", ",", "stringReplaced"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"stringReplaced", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringQ", "[", "stringList", "]"}], "\[Equal]", "True"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"stringList", ",", "\"\<[\>\""}], "]"}], "\[Equal]", 
            "True"}], "||", 
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"stringList", ",", "\"\<(\>\""}], "]"}], "\[Equal]", 
            "True"}]}], ")"}]}], ",", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"stringList", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
             RowBox[{"\"\<(\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
             RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<}\>\""}], ",", 
             RowBox[{"\"\<)\>\"", "\[Rule]", "\"\<}\>\""}]}], "}"}]}], "]"}], 
         "]"}], ",", "stringList"}], "]"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"replaceBracketsBack", "[", "in_", "]"}], ":=", 
   RowBox[{"Return", "[", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ListQ", "[", "in", "]"}], "\[Equal]", "True"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"DecimalForm", "[", "in", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<[\>\""}], ",", 
          RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<]\>\""}]}], "}"}]}], "]"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "in"}], "]"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeProgressCurvePlotRFU", "[", 
    RowBox[{
    "timeData_", ",", "medianIntensityData_", ",", "rate_", ",", "intercept_",
      ",", "pointsUsed_", ",", "standardCurveSlope_", ",", 
     "standardCurveIntercept_", ",", "substrateConc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "data", ",", "noPointsFit", ",", "xmin", ",", "ymin", ",", "padding", 
       ",", "xscale", ",", "yscale"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Riffle", "[", 
          RowBox[{"timeData", ",", "medianIntensityData"}], "]"}], ",", "2"}],
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"noPointsFit", "=", 
       RowBox[{"Length", "[", "pointsUsed", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "set", " ", "plotting", " ", "and", " ", "padding", " ", "values"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"xmin", "=", 
       RowBox[{
        RowBox[{"Last", "[", "data", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ymin", "=", 
       RowBox[{
        RowBox[{"Last", "[", "data", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"padding", "=", "50"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xscale", "=", "1.1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"yscale", "=", "1.4"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Overlay", "[", 
       RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{"data", ",", 
           RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "200"}], ",", 
                RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
              RowBox[{"PointSize", "[", "0.015", "]"}]}], "]"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"False", ",", "True", ",", "True", ",", "False"}], 
             "}"}]}], ",", 
           RowBox[{"FrameStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "Black", ",", "Black", ",", "Black"}], 
             "}"}]}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", "All"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Time (s)\>\"", ",", "\"\<RFU\>\"", ",", "\"\<Time (s)\>\"", 
              ",", "\"\<RFU\>\""}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"None", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"standardCurveSlope", "*", "substrateConc"}], "+", 
                 "standardCurveIntercept"}], ",", "standardCurveIntercept"}], 
               "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Darker", "[", "Red", "]"}], ",", "Dashed"}], "]"}]}], 
           ",", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{"\"\<[S]=\>\"", ",", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"Round", "[", "substrateConc", "]"}], "]"}], ",", 
                  "\"\<uM\>\""}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xmin", "/", "1.25"}], ",", 
                 RowBox[{"ymin", "*", 
                  RowBox[{"yscale", "/", "4"}]}]}], "}"}]}], "]"}], "}"}]}]}],
           "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rate", "*", "time"}], "+", "intercept"}], ",", 
           RowBox[{"{", 
            RowBox[{"time", ",", 
             RowBox[{"-", "200"}], ",", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
              "150."}]}], "}"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
             "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "200"}], ",", 
                RowBox[{
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
                 "150."}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Dashed", ",", 
              RowBox[{"Darker", "[", 
               RowBox[{"Hue", "[", 
                RowBox[{"1", "*", "0.1"}], "]"}], "]"}]}], "]"}]}]}], "]"}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rate", "*", "time"}], "+", "intercept"}], ",", 
           RowBox[{"{", 
            RowBox[{"time", ",", 
             RowBox[{"-", "200"}], ",", 
             RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
             "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "200"}], ",", 
                RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Dashed", ",", 
              RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}]}]}], "]"}], ",",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "noPointsFit"}], "]"}], "]"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "200"}], ",", 
                RowBox[{
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
                 "150."}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False", ",", "False", ",", "True"}], 
             "}"}]}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", "All"}], ",", 
           RowBox[{"FrameStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "[", 
               RowBox[{
                RowBox[{"ColorData", "[", 
                 RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], ",", "Black", 
              ",", "Black", ",", 
              RowBox[{"Darker", "[", 
               RowBox[{
                RowBox[{"ColorData", "[", 
                 RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", 
           RowBox[{"AxesOrigin", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"AxesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Darker", "[", 
              RowBox[{
               RowBox[{"ColorData", "[", 
                RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Darker", "[", 
               RowBox[{
                RowBox[{"ColorData", "[", 
                 RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"PointSize", "[", "0.03", "]"}], ",", 
              RowBox[{"Opacity", "[", "0.8", "]"}]}], "]"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Time (s)\>\"", ",", "\"\<RFU\>\"", ",", "\"\<Time (s)\>\"", 
              ",", "\"\<RFU\>\""}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"None", ",", 
              RowBox[{"{", "65535.", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", "Dashed"}], 
             "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]",
         "}"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeProgressCurvePlot", "[", 
    RowBox[{
    "timeData_", ",", "progressCurve_", ",", "rate_", ",", "intercept_", ",", 
     "pointsUsed_", ",", "substrateConc_", ",", "expFitModel_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "data", ",", "noPointsFit", ",", "xmin", ",", "ymin", ",", "padding", 
       ",", "xscale", ",", "yscale", ",", "firstPointY"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"data", "=", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Riffle", "[", 
           RowBox[{"timeData", ",", "progressCurve"}], "]"}], ",", "2"}], 
         "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"timeData", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{"progressCurve", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"Length", "[", "timeData", "]"}]}], "}"}]}], "]"}], ",", 
         
         RowBox[{
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<", 
           RowBox[{"#2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"noPointsFit", "=", 
       RowBox[{"Length", "[", "pointsUsed", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "set", " ", "plotting", " ", "and", " ", "padding", " ", "values"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"xmin", "=", 
       RowBox[{
        RowBox[{"Last", "[", "data", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ymin", "=", 
       RowBox[{
        RowBox[{"Last", "[", "data", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"padding", "=", "50"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xscale", "=", "1.1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"yscale", "=", "1.4"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"firstPointY", "=", 
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "0.5"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Overlay", "[", 
       RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{"data", ",", 
           RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "200"}], ",", 
                RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"firstPointY", ",", 
                RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
              RowBox[{"PointSize", "[", "0.015", "]"}]}], "]"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"False", ",", "True", ",", "True", ",", "False"}], 
             "}"}]}], ",", 
           RowBox[{"FrameStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "Black", ",", "Black", ",", "Black"}], 
             "}"}]}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", "All"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Time (s)\>\"", ",", "\"\<Product (uM)\>\"", ",", 
              "\"\<Time (s)\>\"", ",", "\"\<Product (uM)\>\""}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"None", ",", 
              RowBox[{"{", "substrateConc", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Darker", "[", "Red", "]"}], ",", "Dashed"}], "]"}]}], 
           ",", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{"\"\<[S]=\>\"", ",", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"Round", "[", "substrateConc", "]"}], "]"}], ",", 
                  "\"\<uM\>\""}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xmin", "/", "1.25"}], ",", 
                 RowBox[{"ymin", "*", 
                  RowBox[{"yscale", "/", "4"}]}]}], "}"}]}], "]"}], "}"}]}]}],
           "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rate", "*", "time"}], "+", "intercept"}], ",", 
           RowBox[{"{", 
            RowBox[{"time", ",", 
             RowBox[{"-", "200"}], ",", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
              "150."}]}], "}"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
             "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "200"}], ",", 
                RowBox[{
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
                 "150."}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"firstPointY", ",", 
                RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Dashed", ",", 
              RowBox[{"Darker", "[", 
               RowBox[{"Hue", "[", 
                RowBox[{"1", "*", "0.1"}], "]"}], "]"}]}], "]"}]}]}], "]"}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rate", "*", "time"}], "+", "intercept"}], ",", 
           RowBox[{"{", 
            RowBox[{"time", ",", 
             RowBox[{"-", "200"}], ",", 
             RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
             "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "200"}], ",", 
                RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"firstPointY", ",", 
                RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Dashed", ",", 
              RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}]}]}], "]"}], ",",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "expFitModel", "]"}], "\[Equal]", "4"}], 
           ",", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"expFitModel", "[", "time", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{"-", "200"}], ",", 
               RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
             RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
             RowBox[{"Frame", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
               "}"}]}], ",", 
             RowBox[{"Axes", "\[Rule]", "False"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "200"}], ",", 
                  RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"firstPointY", ",", 
                  RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Dashed", ",", 
                RowBox[{"Darker", "[", 
                 RowBox[{"Hue", "[", 
                  RowBox[{"1", "*", "0.1"}], "]"}], "]"}]}], "]"}]}]}], "]"}],
            ",", "\"\<\>\""}], "]"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "noPointsFit"}], "]"}], "]"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "200"}], ",", 
                RowBox[{
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
                 "150."}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"firstPointY", ",", 
                RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False", ",", "False", ",", "True"}], 
             "}"}]}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", "All"}], ",", 
           RowBox[{"FrameStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "[", 
               RowBox[{
                RowBox[{"ColorData", "[", 
                 RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], ",", "Black", 
              ",", "Black", ",", 
              RowBox[{"Darker", "[", 
               RowBox[{
                RowBox[{"ColorData", "[", 
                 RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", 
           RowBox[{"AxesOrigin", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"AxesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Darker", "[", 
              RowBox[{
               RowBox[{"ColorData", "[", 
                RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Darker", "[", 
               RowBox[{
                RowBox[{"ColorData", "[", 
                 RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"PointSize", "[", "0.03", "]"}], ",", 
              RowBox[{"Opacity", "[", "0.8", "]"}]}], "]"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Time (s)\>\"", ",", "\"\<RFU\>\"", ",", "\"\<Time (s)\>\"", 
              ",", "\"\<RFU\>\""}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"None", ",", 
              RowBox[{"{", "65535.", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", "Dashed"}], 
             "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]",
         "}"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeProgressCurvePlotPBP", "[", 
    RowBox[{
    "timeData_", ",", "turnoverData_", ",", "rate_", ",", "intercept_", ",", 
     "pointsUsed_", ",", "substrateConc_", ",", "PBPconc_", ",", "coplotExp_",
      ",", "expFitModel_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "data", ",", "noPointsFit", ",", "xmin", ",", "ymin", ",", "padding", 
       ",", "xscale", ",", "yscale", ",", "kobstest"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Riffle", "[", 
          RowBox[{"timeData", ",", "turnoverData"}], "]"}], ",", "2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"noPointsFit", "=", 
       RowBox[{"Length", "[", "pointsUsed", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "set", " ", "plotting", " ", "and", " ", "padding", " ", "values"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"xmin", "=", 
       RowBox[{
        RowBox[{"Last", "[", "data", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ymin", "=", 
         RowBox[{
          RowBox[{"Last", "[", "data", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ymin", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Sort", "[", 
             RowBox[{"data", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ">", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", "60.0"}], ",", 
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"Sort", "[", 
            RowBox[{"data", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ">", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "]"}], "[", 
          
          RowBox[{"[", "2", "]"}], "]"}], ",", "60.0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"padding", "=", "50"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xscale", "=", "1.1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"yscale", "=", "1.4"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"kobstest", "=", 
         RowBox[{"kobs", "/.", 
          RowBox[{"expFitModel", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "kobstest", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"noPointsFit", "\[GreaterEqual]", "1"}], ",", 
        RowBox[{"Overlay", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{"data", ",", 
             RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "200"}], ",", 
                  RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
                RowBox[{"PointSize", "[", "0.015", "]"}]}], "]"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"False", ",", "True", ",", "True", ",", "False"}], 
               "}"}]}], ",", 
             RowBox[{"FrameStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Black", ",", "Black", ",", "Black", ",", "Black"}], 
               "}"}]}], ",", 
             RowBox[{"FrameTicks", "\[Rule]", "All"}], ",", 
             RowBox[{"Axes", "\[Rule]", "False"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Time (s)\>\"", ",", "\"\<[Pi]\>\"", ",", 
                "\"\<Time (s)\>\"", ",", "\"\<[Pi]\>\""}], "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
             RowBox[{"GridLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"None", ",", 
                RowBox[{"{", 
                 RowBox[{"substrateConc", ",", "PBPconc"}], "}"}]}], "}"}]}], 
             ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Darker", "[", "Red", "]"}], ",", "Dashed"}], "]"}]}],
              ",", 
             RowBox[{"Epilog", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Inset", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"StringJoin", "[", 
                   RowBox[{"\"\<[S]=\>\"", ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"Round", "[", "substrateConc", "]"}], "]"}], ",", 
                    "\"\<uM\>\""}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xmin", "/", "1.25"}], ",", 
                   RowBox[{"ymin", "*", 
                    RowBox[{"yscale", "/", "4"}]}]}], "}"}]}], "]"}], 
               "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "*", "time"}], "+", "intercept"}], ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{"-", "200"}], ",", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
                "150."}]}], "}"}], ",", 
             RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
             RowBox[{"Frame", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
               "}"}]}], ",", 
             RowBox[{"Axes", "\[Rule]", "False"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "200"}], ",", 
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
                   "150."}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Dashed", ",", 
                RowBox[{"Darker", "[", 
                 RowBox[{"Hue", "[", 
                  RowBox[{"1", "*", "0.1"}], "]"}], "]"}]}], "]"}]}]}], "]"}],
            ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "*", "time"}], "+", "intercept"}], ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{"-", "200"}], ",", 
               RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
             RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
             RowBox[{"Frame", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
               "}"}]}], ",", 
             RowBox[{"Axes", "\[Rule]", "False"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "200"}], ",", 
                  RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Dashed", ",", 
                RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}]}]}], "]"}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "expFitModel", "]"}], "\[Equal]", "4"}], 
             ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"expFitModel", "[", "time", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"time", ",", 
                 RowBox[{"-", "200"}], ",", 
                 RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
               RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
               RowBox[{"Frame", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
                 "}"}]}], ",", 
               RowBox[{"Axes", "\[Rule]", "False"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "200"}], ",", 
                    RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
               
               RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Dashed", ",", 
                  RowBox[{"Darker", "[", 
                   RowBox[{"Hue", "[", 
                    RowBox[{"1", "*", "0.1"}], "]"}], "]"}]}], "]"}]}]}], 
              "]"}], ",", "\"\<\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "noPointsFit"}], "]"}], "]"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "200"}], ",", 
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
                   "150."}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
             RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
             RowBox[{"Frame", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False", ",", "False", ",", "True"}], 
               "}"}]}], ",", 
             RowBox[{"FrameTicks", "\[Rule]", "All"}], ",", 
             RowBox[{"FrameStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Darker", "[", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], ",", "Black",
                 ",", "Black", ",", 
                RowBox[{"Darker", "[", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
             ",", 
             RowBox[{"Axes", "\[Rule]", "True"}], ",", 
             RowBox[{"AxesOrigin", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"AxesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Darker", "[", 
                RowBox[{
                 RowBox[{"ColorData", "[", 
                  RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
             
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Darker", "[", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"PointSize", "[", "0.03", "]"}], ",", 
                RowBox[{"Opacity", "[", "0.8", "]"}]}], "]"}]}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Time (s)\>\"", ",", "\"\<[Pi]\>\"", ",", 
                "\"\<Time (s)\>\"", ",", "\"\<[Pi]\>\""}], "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
             RowBox[{"GridLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"None", ",", 
                RowBox[{"{", "65535.", "}"}]}], "}"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", "Dashed"}], 
               "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "}"}], "]"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isotherm", "[", 
    RowBox[{"kd_", ",", "ptot_", ",", "scale_", ",", "offset_", ",", "x_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.5", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kd", "+", "x", "+", "ptot"}], ")"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"kd", "+", "x", "+", "ptot"}], ")"}], "^", "2"}], "-", 
            RowBox[{"(", 
             RowBox[{"4", "*", "x", "*", "ptot"}], ")"}]}], ")"}], "^", 
          "0.5"}]}], ")"}]}], ")"}], "*", "scale"}], "+", "offset"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inverseIsotherm", "[", 
    RowBox[{
    "kd_", ",", "ptot_", ",", "scale_", ",", "offset_", ",", "intensity_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1.`", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1.`", " ", 
         SuperscriptBox["intensity", "2"]}], "-", 
        RowBox[{"2.`", " ", "intensity", " ", "offset"}], "+", 
        RowBox[{"1.`", " ", 
         SuperscriptBox["offset", "2"]}], "-", 
        RowBox[{"1.`", " ", "intensity", " ", "kd", " ", "scale"}], "+", 
        RowBox[{"1.`", " ", "kd", " ", "offset", " ", "scale"}], "-", 
        RowBox[{"1.`", " ", "intensity", " ", "ptot", " ", "scale"}], "+", 
        RowBox[{"1.`", " ", "offset", " ", "ptot", " ", "scale"}]}], ")"}]}], 
     ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"scale", " ", 
      RowBox[{"(", 
       RowBox[{"intensity", "-", 
        RowBox[{"1.`", " ", "offset"}], "-", 
        RowBox[{"1.`", " ", "ptot", " ", "scale"}]}], ")"}]}], ")"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regenerateProgressCurve", "[", 
    RowBox[{
    "timeData_", ",", "medianIntensityData_", ",", "standardCurveParams_", 
     ",", "sensorConc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Riffle", "[", 
          RowBox[{"timeData", ",", "medianIntensityData"}], "]"}], ",", "2"}],
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"inverseIsotherm", "[", 
           RowBox[{
            RowBox[{
            "standardCurveParams", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "standardCurveParams", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "standardCurveParams", "\[LeftDoubleBracket]", "3", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "standardCurveParams", "\[LeftDoubleBracket]", "4", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "2"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makePBPcurvePlot", "[", 
    RowBox[{"standardCurveParams_", ",", "standardCurveData_"}], "]"}], ":=", 
   
   RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{"standardCurveData", ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<[\!\(\*SubscriptBox[\(P\), \(i\)]\)] (uM)\>\"", ",", 
          "\"\<PBP Intensity\>\""}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"50", ",", "50"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"50", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Darker", "[", "Cyan", "]"}], ",", 
          RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"isotherm", "[", 
        RowBox[{
         RowBox[{"standardCurveParams", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"standardCurveParams", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"standardCurveParams", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"standardCurveParams", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", "Pi"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"Pi", ",", "0", ",", "160"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "All"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Darker", "[", "Cyan", "]"}], "]"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", "Black"}]}], "]"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linearFitWalkingProgressCurve", "[", 
    RowBox[{"timeData_", ",", "progressCurve_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"data", ",", "linFits"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"n", ".", "b", ".", " ", "had"}], " ", "to", " ", "add", " ", 
        "Select", " ", "because", " ", "1", " ", "point", " ", "is", " ", 
        "expressed", " ", "in", " ", "scientific", " ", "notation", " ", "in",
         " ", "input", " ", "csv"}], ",", " ", 
       RowBox[{"and", " ", 
        RowBox[{"doesn", "'"}], "t", " ", "parse", " ", "properly"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Riffle", "[", 
            RowBox[{"timeData", ",", "progressCurve"}], "]"}], ",", "2"}], 
          "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Equal]", "Real"}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"linFits", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"LinearModelFit", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "n"}], "]"}], "]"}], ",", "x", ",", "x"}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "2", ",", 
           RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"linFits", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"linFits", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "2", ",", "1", ",", "2", ",", "2"}], "]"}], 
           "]"}], ",", 
          RowBox[{"linFits", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "2", ",", "1", ",", "2", ",", "1"}], "]"}], 
           "]"}], ",", 
          RowBox[{"linFits", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "linFits", "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"optimizeLinFit", "[", 
    RowBox[{
    "timeData_", ",", "progressCurve_", ",", "substrateConc_", ",", 
     "stdCurveSlope_", ",", "stdCurveIntercept_", ",", "cutoff_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "data", ",", "cutoffNew", ",", "dataForFit", ",", "sensorSat", ",", 
       "dataForFitTemp", ",", "fit"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "fit", " ", "all", " ", "points", " ", "under", " ", "30", "%", " ", 
        "of", " ", "total", " ", "expected", " ", "turnover"}], ",", " ", 
       RowBox[{
        RowBox[{"unless", " ", "this", " ", "leaves"}], " ", "<", " ", 
        RowBox[{
         RowBox[{
         "2", " ", "points", " ", "in", " ", "which", " ", "default", " ", 
          "to", " ", "a", " ", "2"}], "-", 
         RowBox[{"point", " ", "fit"}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"timeData", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{"progressCurve", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"Length", "[", "timeData", "]"}]}], "}"}]}], "]"}], ",", 
         
         RowBox[{
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<", 
           RowBox[{"#2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sensorSat", "=", 
       RowBox[{"65536.0", "*", "0.9"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"cutoffNew", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"substrateConc", "*", "stdCurveSlope"}], "+", 
            "stdCurveIntercept"}], ")"}], "<", "sensorSat"}], ",", 
         RowBox[{"cutoff", "*", "substrateConc"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"substrateConc", "*", "stdCurveSlope"}], "+", 
             "stdCurveIntercept"}], ")"}], "\[GreaterEqual]", "sensorSat"}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"substrateConc", "*", "cutoff", "*", "stdCurveSlope"}], 
             "+", "stdCurveIntercept"}], ")"}], "<", "sensorSat"}]}], ",", 
         RowBox[{"cutoff", "*", "substrateConc"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"substrateConc", "*", "stdCurveSlope"}], "+", 
             "stdCurveIntercept"}], ")"}], "\[GreaterEqual]", "sensorSat"}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"substrateConc", "*", "cutoff", "*", "stdCurveSlope"}], 
             "+", "stdCurveIntercept"}], ")"}], "\[GreaterEqual]", 
           "sensorSat"}]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"sensorSat", "-", "stdCurveIntercept"}], "stdCurveSlope"], 
          ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dataForFitTemp", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"data", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "<", "cutoffNew"}], "&"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dataForFit", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dataForFitTemp", "]"}], "<", "2"}], ",", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", "dataForFitTemp"}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitOptimized", "[", "dataIN_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"data", ",", "linFit", ",", "params"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "works", " ", "for", " ", "both", " ", "cMUP", " ", "and", " ", "MeP", 
       " ", "assays"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Normal", "[", "dataIN", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"linFit", "=", 
       RowBox[{
        RowBox[{"LinearModelFit", "[", 
         RowBox[{"data", ",", "x", ",", "x"}], "]"}], "//", "Quiet"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"params", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "data", "]"}], "<", "2"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", 
           "\"\<NaN\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"linFit", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"linFit", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], ",", "linFit", 
           ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "data", "]"}], ">", "2"}], ",", 
             RowBox[{"linFit", "[", "\"\<RSquared\>\"", "]"}], ",", "1.0"}], 
            "]"}], ",", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<OptLinFitSlope\>\"", "\[Rule]", 
         RowBox[{"params", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"\"\<OptLinFitIntercept\>\"", "->", 
         RowBox[{"params", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"\"\<OptLinFitModel\>\"", "->", 
         RowBox[{"params", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", 
        RowBox[{"\"\<OptLinFitR2\>\"", "->", 
         RowBox[{"params", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"optimizeLinFitPBP", "[", 
    RowBox[{
    "timeData_", ",", "progressCurve_", ",", "substrateConc_", ",", 
     "sensorConc_", ",", "cutoff_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "data", ",", "cutoffNew", ",", "dataForFitTemp", ",", "dataForFit"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Riffle", "[", 
          RowBox[{"timeData", ",", "progressCurve"}], "]"}], ",", "2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"for", " ", "the", " ", "PBP", " ", "coupled", " ", "assay"}],
         ",", " ", 
        RowBox[{
         RowBox[{
         "the", " ", "fitting", " ", "strategy", " ", "will", " ", "depend", 
          " ", "on", " ", "the", " ", "relative", " ", "concentrations", " ", 
          "of", " ", "substrate", " ", "and", " ", "PBP"}], " ", "\[Rule]", 
         " ", 
         RowBox[{
          RowBox[{"if", " ", "[", "S", "]"}], "<", 
          RowBox[{
           RowBox[{"[", "PBP", "]"}], " ", "use", " ", "cutoff", "*", 
           RowBox[{"[", "S", "]"}], " ", "as", " ", "cutoff"}]}]}], ",", " ", 
        
        RowBox[{"else", " ", "use", " ", "cutoff", "*", 
         RowBox[{"[", "PBP", "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"cutoffNew", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"substrateConc", "<", "sensorConc"}], ",", 
         RowBox[{"cutoff", "*", "substrateConc"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"cutoff", "*", "substrateConc"}], ")"}], ">", 
          RowBox[{"sensorConc", "*", 
           RowBox[{"2", "/", "3"}]}]}], ",", 
         RowBox[{"sensorConc", "*", 
          RowBox[{"2", "/", "3"}]}], ",", 
         RowBox[{
          RowBox[{"substrateConc", ">", "sensorConc"}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"cutoff", "*", "substrateConc"}], ")"}], "<", 
           RowBox[{"sensorConc", "*", 
            RowBox[{"2", "/", "3"}]}]}]}], ",", 
         RowBox[{"cutoff", "*", "substrateConc"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dataForFitTemp", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"data", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "<", "cutoffNew"}], "&"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dataForFit", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dataForFitTemp", "]"}], "<", "2"}], ",", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", "dataForFitTemp"}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitOptimizedLinFitPointsPBP", "[", "dataIN_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"linFit", ",", "data"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Normal", "[", "dataIN", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"linFit", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "data", "]"}], "\[GreaterEqual]", "2"}], ",", 
         RowBox[{"LinearModelFit", "[", 
          RowBox[{"data", ",", "x", ",", "x"}], "]"}], ",", "\"\<NaN\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "data", "]"}], "<", "2"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", 
          "\"\<NaN\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"linFit", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"linFit", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "data", "]"}], ">", "2"}], ",", 
            RowBox[{"linFit", "[", "\"\<RSquared\>\"", "]"}], ",", "1.0"}], 
           "]"}], ",", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exponentialFit", "[", 
    RowBox[{
    "timeData_", ",", "progressCurve_", ",", "substrateConc_", ",", 
     "stdCurveSlope_", ",", "stdCurveIntercept_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "forFit", ",", "expFit", ",", "kobsout", ",", "bout", ",", "cout", ",", 
       "forFitOnlyGoodPoints", ",", "out", ",", "data"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"timeData", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{"progressCurve", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"Length", "[", "timeData", "]"}]}], "}"}]}], "]"}], ",", 
         
         RowBox[{
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<", 
           RowBox[{"#2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"forFit", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"data", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Equal]", "Real"}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"stdCurveSlope", "*", "substrateConc"}], "+", 
            "stdCurveIntercept"}], ")"}], "\[LessEqual]", 
          RowBox[{"65536.0", "*", "0.9"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"expFit", "=", 
            RowBox[{"NonlinearModelFit", "[", 
             RowBox[{"forFit", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "kobs"}], "*", "t"}], "]"}]}], ")"}], "*", 
                  "b"}], "+", "c"}], ",", 
                RowBox[{
                 RowBox[{"b", ">", "0"}], "&&", 
                 RowBox[{"kobs", "<", "0.02"}], "&&", 
                 RowBox[{"b", "<", 
                  RowBox[{"substrateConc", "*", "1.25"}]}], "&&", 
                 RowBox[{"c", ">", 
                  RowBox[{"-", "4"}]}], "&&", 
                 RowBox[{"c", "<", "5"}], "&&", 
                 RowBox[{"kobs", ">", "0"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"kobs", ",", "0.00005"}], "}"}], ",", "b", ",", 
                RowBox[{"{", 
                 RowBox[{"c", ",", "1.5"}], "}"}]}], "}"}], ",", "t", ",", 
              RowBox[{"MaxIterations", "\[Rule]", "50"}]}], "]"}]}], ";"}], 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"expFit", "=", 
           RowBox[{"NonlinearModelFit", "[", 
            RowBox[{"forFit", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "kobs"}], "*", "t"}], "]"}]}], ")"}], "*", 
                 "b"}], "+", "c"}], ",", 
               RowBox[{
                RowBox[{"b", ">", "0"}], "&&", 
                RowBox[{"kobs", "<", "0.2"}], "&&", 
                RowBox[{"b", "<", 
                 RowBox[{"substrateConc", "*", "1.25"}]}], "&&", 
                RowBox[{"c", ">", 
                 RowBox[{"-", "4"}]}], "&&", 
                RowBox[{"c", "<", "5"}], "&&", 
                RowBox[{"kobs", ">", "0"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"kobs", ",", "0.00005"}], "}"}], ",", "b", ",", 
               RowBox[{"{", 
                RowBox[{"c", ",", "1.5"}], "}"}]}], "}"}], ",", "t", ",", 
             RowBox[{"MaxIterations", "\[Rule]", "50"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"kobsout", "=", 
           RowBox[{"kobs", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bout", "=", 
           RowBox[{"b", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cout", "=", 
           RowBox[{"c", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"kobsout", ",", "bout", ",", "cout", ",", 
            RowBox[{"expFit", "[", "\"\<RSquared\>\"", "]"}], ",", "expFit"}],
            "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"forFitOnlyGoodPoints", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"forFit", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "<", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"65536.0", "-", "stdCurveIntercept"}], ")"}], "/", 
                  "stdCurveSlope"}], ")"}], "*", "0.9"}]}], "&"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"expFit", "=", 
           RowBox[{"NonlinearModelFit", "[", 
            RowBox[{"forFitOnlyGoodPoints", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "kobs"}], "*", "t"}], "]"}]}], ")"}], "*", 
                 "substrateConc"}], "+", "c"}], ",", 
               RowBox[{
                RowBox[{"kobs", "<", "0.2"}], "&&", 
                RowBox[{"c", ">", 
                 RowBox[{"-", "2"}]}], "&&", 
                RowBox[{"c", "<", "5"}], "&&", 
                RowBox[{"kobs", ">", "0"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"kobs", ",", "0.00005"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"c", ",", "1.5"}], "}"}]}], "}"}], ",", "t"}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"kobsout", "=", 
           RowBox[{"kobs", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bout", "=", "substrateConc"}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"cout", "=", 
           RowBox[{"c", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"expFit", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", "3"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"kobsout", ",", "bout", ",", "cout", ",", 
              RowBox[{"expFit", "[", "\"\<RSquared\>\"", "]"}], ",", 
              "expFit"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", 
              "\"\<NaN\>\"", ",", "\"\<NaN\>\""}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "out"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exponentialFitPBP", "[", 
    RowBox[{
    "timeData_", ",", "progressCurve_", ",", "substrateConc_", ",", 
     "PBPconc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "forFit", ",", "expFit", ",", "kobsout", ",", "bout", ",", "cout", ",", 
       "forFitOnlyGoodPoints", ",", "out"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"forFit", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Riffle", "[", 
            RowBox[{"timeData", ",", "progressCurve"}], "]"}], ",", "2"}], 
          "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"NumberQ", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Equal]", "True"}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"substrateConc", "\[LessEqual]", "PBPconc"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"expFit", "=", 
           RowBox[{"NonlinearModelFit", "[", 
            RowBox[{"forFit", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "kobs"}], "*", "t"}], "]"}]}], ")"}], "*", 
                 "b"}], "+", "c"}], ",", 
               RowBox[{
                RowBox[{"b", ">", 
                 RowBox[{"substrateConc", "*", "0.8"}]}], "&&", 
                RowBox[{"b", "<", 
                 RowBox[{"substrateConc", "*", "1.2"}]}], "&&", 
                RowBox[{"kobs", "<", "0.02"}], "&&", 
                RowBox[{"c", ">", 
                 RowBox[{"-", "4"}]}], "&&", 
                RowBox[{"c", "<", "3"}], "&&", 
                RowBox[{"kobs", ">", "0"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"kobs", ",", "b", ",", "c"}], "}"}], ",", "t"}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"kobsout", "=", 
           RowBox[{"kobs", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bout", "=", 
           RowBox[{"b", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cout", "=", 
           RowBox[{"c", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"kobsout", ",", "bout", ",", "cout", ",", 
            RowBox[{"expFit", "[", "\"\<RSquared\>\"", "]"}], ",", "expFit"}],
            "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"forFitOnlyGoodPoints", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"forFit", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "<", 
                RowBox[{"PBPconc", "*", "0.85"}]}], "&&", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ">", "0"}]}], "&"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"expFit", "=", 
           RowBox[{"NonlinearModelFit", "[", 
            RowBox[{"forFitOnlyGoodPoints", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "kobs"}], "*", "t"}], "]"}]}], ")"}], "*", 
                 "substrateConc"}], "+", "c"}], ",", 
               RowBox[{
                RowBox[{"kobs", "<", "0.02"}], "&&", 
                RowBox[{"c", ">", 
                 RowBox[{"-", "4"}]}], "&&", 
                RowBox[{"c", "<", "3"}], "&&", 
                RowBox[{"kobs", ">", "0"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"kobs", ",", "c"}], "}"}], ",", "t"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"kobsout", "=", 
           RowBox[{"kobs", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bout", "=", "substrateConc"}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"cout", "=", 
           RowBox[{"c", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"expFit", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", "3"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"kobsout", ",", "bout", ",", "cout", ",", 
              RowBox[{"expFit", "[", "\"\<RSquared\>\"", "]"}], ",", 
              "expFit"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", 
              "\"\<NaN\>\"", ",", "\"\<NaN\>\""}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "out"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitStdCurve", "[", "data_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "fit", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fit", "=", 
       RowBox[{"LinearModelFit", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "data", "]"}], ",", "x", ",", "x"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fit", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"fit", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitStdCurveNew", "[", 
    RowBox[{"concentrations_", ",", "intensities_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fit", ",", "data"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"concentrations", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", 
           RowBox[{"intensities", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"Length", "[", "concentrations", "]"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fit", "=", 
       RowBox[{"LinearModelFit", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "data", "]"}], ",", "x", ",", "x"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fit", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"fit", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], ",", "fit"}], 
       "}"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeStdCurvePlot", "[", 
    RowBox[{"slope_", ",", "intercept_", ",", "data_"}], "]"}], ":=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{"data", ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<[cMU] (uM)\>\"", ",", "\"\<cMU Intensity\>\""}], 
         "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Darker", "[", "Cyan", "]"}], ",", 
          RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"slope", "*", "cMU"}], "+", "intercept"}], ",", 
       RowBox[{"{", 
        RowBox[{"cMU", ",", "0", ",", "105"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Darker", "[", "Cyan", "]"}], "]"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", "Black"}]}], "]"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeStdCurvePlotNew", "[", 
    RowBox[{
    "slope_", ",", "intercept_", ",", "concentrations_", ",", 
     "intensities_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"concentrations", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", 
           RowBox[{"intensities", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"Length", "[", "concentrations", "]"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{"data", ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<[cMU] (uM)\>\"", ",", "\"\<cMU Intensity\>\""}], 
            "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Darker", "[", "Cyan", "]"}], ",", 
             RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], "]"}], ",",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"slope", "*", "cMU"}], "+", "intercept"}], ",", 
          RowBox[{"{", 
           RowBox[{"cMU", ",", "0", ",", "105"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Darker", "[", "Cyan", "]"}], "]"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", "Black"}]}], "]"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "need", " ", "to", " ", "add", " ", "inhibitor", " ", "concentration", " ",
     "column", " ", "to", " ", "the", " ", "dataset"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitInhibition", "[", 
    RowBox[{"dataset_", ",", "rateKey_", ",", "keyAppend_", ",", 
     RowBox[{"scaleByGFP_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "removeControl", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"reads", " ", "in", " ", "Dataset"}], ",", " ", 
       RowBox[{
        RowBox[{"fits", " ", "chosen", " ", "rates", " ", 
         RowBox[{"(", 
          RowBox[{"determined", " ", "by", " ", "key"}], ")"}], " ", "to", 
         " ", "linear", " ", "and", " ", "Michaelis"}], "-", 
        RowBox[{"Menten", " ", "models"}]}], ",", " ", 
       RowBox[{
       "returning", " ", "a", " ", "list", " ", "of", " ", "associations"}], 
       ",", " ", 
       RowBox[{
       "and", " ", "merging", " ", "fit", " ", "data", " ", "with", " ", 
        "input", " ", "data", " ", "to", " ", "create", " ", "a", " ", "new", 
        " ", "aggregate", " ", "dataset"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"removeControl", "=", 
       RowBox[{"dataset", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"#AssayType", "\[Equal]", "1"}], "&"}], "]"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"grouped", "=", 
       RowBox[{"removeControl", "[", 
        RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"onlyControl", "=", 
       RowBox[{"dataset", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"#AssayType", "\[Equal]", "0"}], "&"}], "]"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"groupedControl", "=", 
       RowBox[{"onlyControl", "[", 
        RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fitdata", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Clear", "[", 
            RowBox[{
            "fits", ",", "data", ",", "data2", ",", "dataNorm", ",", "rates", 
             ",", "inhibitorConcentrations", ",", "eGFPscalingList"}], "]"}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"inhibitorConcentrations", "=", 
            RowBox[{"Normal", "[", 
             RowBox[{"grouped", "[", 
              RowBox[{
              "n", ",", "All", ",", "\"\<InhibitorConcentrations\>\""}], 
              "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"eGFPscalingList", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Normal", "[", 
                 RowBox[{"grouped", "[", 
                  RowBox[{"n", ",", "All", ",", "\"\<eGFPSummedI\>\""}], 
                  "]"}], "]"}], "/", "eGFPslope"}], "/", "1000."}], ",", 
              RowBox[{"scaleByGFP", "\[Equal]", "0"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Mean", "[", 
                   RowBox[{"Normal", "[", 
                    RowBox[{"grouped", "[", 
                    RowBox[{"n", ",", "All", ",", "\"\<eGFPSummedI\>\""}], 
                    "]"}], "]"}], "]"}], "/", "eGFPslope"}], "/", "1000."}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"Length", "[", "inhibitorconcentrations", "]"}], 
                 "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"rates", "=", 
            RowBox[{"Normal", "[", 
             RowBox[{"grouped", "[", 
              RowBox[{"n", ",", "All", ",", "rateKey"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"data", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"inhibitorConcentrations", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"rates", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"eGFPscalingList", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"Length", "[", "inhibitorConcentrations", "]"}]}], 
               "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"data2a", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"data", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", 
                   "\"\<NaN\>\""}], "&&", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], "&&", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ">", "0"}]}], "&"}]}], 
               "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"data2a", "=", "data"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"data2b", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"data2a", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"data2a", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "2"}], "]"}], "]"}], "/", 
                 RowBox[{"data2a", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"Length", "[", "data2a", "]"}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"dataMax", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"data2b", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"data2", "=", "data2b"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"dataNorm", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"data2", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"data2", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "2"}], "]"}], "]"}], "/", "dataMax"}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"Length", "[", "data2", "]"}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"fits", "=", 
            RowBox[{"NonlinearModelFit", "[", 
             RowBox[{"dataNorm", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Vmax", "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"inhibitor", "/", "Ki"}]}], ")"}]}], ",", 
                RowBox[{
                 RowBox[{"Ki", ">", "0.0"}], "&&", 
                 RowBox[{"Vmax", ">", "0.75"}], "&&", 
                 RowBox[{"Vmax", "<", "1.5"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Ki", ",", "Vmax"}], "}"}], ",", "inhibitor"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Vmaxout", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Vmax", "/.", 
               RowBox[{"fits", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ")"}], "*", 
             "dataMax"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"KIout", "=", 
            RowBox[{"Ki", "/.", 
             RowBox[{"fits", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "drop", " ", "individual", " ", "points", " ", "and", " ", 
             "refit"}], " ", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"droppedfits", "=", 
            RowBox[{
            "Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"dataNorm", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"NonlinearModelFit", "[", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{"dataNorm", ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Vmax", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"inhibitor", "/", "Ki"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"Ki", ">", "0.0"}], "&&", 
                    RowBox[{"Vmax", ">", "0.75"}], "&&", 
                    RowBox[{"Vmax", "<", "1.5"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Ki", ",", "Vmax"}], "}"}], ",", "inhibitor"}], 
                 "]"}]}], "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
               ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"Length", "[", "dataNorm", "]"}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"extract", " ", "parameters"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"VmaxDropouts", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Vmax", "/.", 
               RowBox[{"droppedfits", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2", ",", "1", ",", "2"}], "]"}], 
                "]"}]}], ")"}], "*", "dataMax"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"KIDropouts", "=", 
            RowBox[{"Ki", "/.", 
             RowBox[{"droppedfits", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2", ",", "1", ",", "2"}], "]"}], 
              "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"eGFPscaleUnits", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
              "\"\<Scaled initial rate (\!\(\*SuperscriptBox[\(s\), \
\(-1\)]\))\>\"", ",", "\"\<Initial rate (uM/s)\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"control", " ", "data"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"controlData", "=", 
            RowBox[{"groupedControl", "[", "n", "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"inhibitorConcentrationsControl", "=", 
            RowBox[{"Normal", "[", 
             RowBox[{"controlData", "[", 
              RowBox[{"All", ",", "\"\<InhibitorConcentrations\>\""}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"eGFPscalingListControl", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Normal", "[", 
                 RowBox[{"controlData", "[", 
                  RowBox[{"All", ",", "\"\<eGFPSummedI\>\""}], "]"}], "]"}], 
                "/", "eGFPslope"}], "/", "1000."}], ",", 
              RowBox[{"scaleByGFP", "\[Equal]", "0"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Mean", "[", 
                   RowBox[{"Normal", "[", 
                    RowBox[{"controlData", "[", 
                    RowBox[{"n", ",", "All", ",", "\"\<eGFPSummedI\>\""}], 
                    "]"}], "]"}], "]"}], "/", "eGFPslope"}], "/", "1000."}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"Length", "[", "inhibitorconcentrations", "]"}], 
                 "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"controlPlotTEMP", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"controlData", "[", 
                 RowBox[{"run", ",", "\"\<InhibitorConcentrations\>\""}], 
                 "]"}], ",", 
                RowBox[{"controlData", "[", 
                 RowBox[{"run", ",", "rateKey"}], "]"}], ",", 
                RowBox[{"eGFPscalingListControl", "[", 
                 RowBox[{"[", "run", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"run", ",", "1", ",", 
                RowBox[{"Length", "[", "controlData", "]"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"controlPlot", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"controlPlotTEMP", "[", 
                 RowBox[{"[", 
                  RowBox[{"run", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"controlPlotTEMP", "[", 
                  RowBox[{"[", 
                   RowBox[{"run", ",", "2"}], "]"}], "]"}], "/", 
                 RowBox[{"controlPlotTEMP", "[", 
                  RowBox[{"[", 
                   RowBox[{"run", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"run", ",", "1", ",", 
                RowBox[{"Length", "[", "controlPlotTEMP", "]"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"controlPlotNorm", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"controlPlotTEMP", "[", 
                 RowBox[{"[", 
                  RowBox[{"run", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"controlPlotTEMP", "[", 
                   RowBox[{"[", 
                    RowBox[{"run", ",", "2"}], "]"}], "]"}], "/", 
                  RowBox[{"controlPlotTEMP", "[", 
                   RowBox[{"[", 
                    RowBox[{"run", ",", "3"}], "]"}], "]"}]}], "/", 
                 "Vmaxout"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"run", ",", "1", ",", 
                RowBox[{"Length", "[", "controlPlotTEMP", "]"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"controlPlotReplace0", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"controlPlotTEMP", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                   "0.0"}], ",", "0.1", ",", 
                  RowBox[{"controlPlotTEMP", "[", 
                   RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"controlPlotTEMP", "[", 
                  RowBox[{"[", 
                   RowBox[{"run", ",", "2"}], "]"}], "]"}], "/", 
                 RowBox[{"controlPlotTEMP", "[", 
                  RowBox[{"[", 
                   RowBox[{"run", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"run", ",", "1", ",", 
                RowBox[{"Length", "[", "controlPlotTEMP", "]"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"controlPlotNormReplace0", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"controlPlotTEMP", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                   "0.0"}], ",", "0.1", ",", 
                  RowBox[{"controlPlotTEMP", "[", 
                   RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"controlPlotTEMP", "[", 
                   RowBox[{"[", 
                    RowBox[{"run", ",", "2"}], "]"}], "]"}], "/", 
                  RowBox[{"controlPlotTEMP", "[", 
                   RowBox[{"[", 
                    RowBox[{"run", ",", "3"}], "]"}], "]"}]}], "/", 
                 "Vmaxout"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"run", ",", "1", ",", 
                RowBox[{"Length", "[", "controlPlotTEMP", "]"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"controlPlotReplace02", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"controlPlotTEMP", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                   "0.0"}], ",", "0.01", ",", 
                  RowBox[{"controlPlotTEMP", "[", 
                   RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"controlPlotTEMP", "[", 
                  RowBox[{"[", 
                   RowBox[{"run", ",", "2"}], "]"}], "]"}], "/", 
                 RowBox[{"controlPlotTEMP", "[", 
                  RowBox[{"[", 
                   RowBox[{"run", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"run", ",", "1", ",", 
                RowBox[{"Length", "[", "controlPlotTEMP", "]"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"controlPlotNormReplace02", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"controlPlotTEMP", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                   "0.0"}], ",", "0.01", ",", 
                  RowBox[{"controlPlotTEMP", "[", 
                   RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"controlPlotTEMP", "[", 
                   RowBox[{"[", 
                    RowBox[{"run", ",", "2"}], "]"}], "]"}], "/", 
                  RowBox[{"controlPlotTEMP", "[", 
                   RowBox[{"[", 
                    RowBox[{"run", ",", "3"}], "]"}], "]"}]}], "/", 
                 "Vmaxout"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"run", ",", "1", ",", 
                RowBox[{"Length", "[", "controlPlotTEMP", "]"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"full", " ", "inhibition", " ", "fit"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"MMfitplot", "=", 
              RowBox[{"Show", "[", 
               RowBox[{
                RowBox[{"LogLinearPlot", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"fits", "[", "x", "]"}], "*", "dataMax"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "0.4", ",", "1250"}], "}"}], ",", 
                  RowBox[{"PlotRange", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                  RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                  RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                  RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                  RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                  RowBox[{"FrameLabel", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<[I] (uM)\>\"", ",", "\"\<Initial rate (uM/s)\>\""}], 
                    "}"}]}]}], "]"}], ",", 
                RowBox[{"ListLogLinearPlot", "[", 
                 RowBox[{"data2", ",", 
                  RowBox[{"PlotRange", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                  RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                  RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                  RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                  RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                  RowBox[{"GridLines", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"None", ",", 
                    RowBox[{"{", 
                    RowBox[{"data2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "}"}]}], "}"}]}], 
                  ",", 
                  RowBox[{"GridLinesStyle", "\[Rule]", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"Gray", ",", " ", "Dashed"}], "]"}]}], ",", 
                  RowBox[{"FrameLabel", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"\"\<[I] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                    "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"ListLogLinearPlot", "[", 
                 RowBox[{"controlPlot", ",", 
                  RowBox[{"PlotStyle", "\[Rule]", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                 "]"}], ",", 
                RowBox[{"ListLogLinearPlot", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                   "]"}], ",", 
                  RowBox[{"PlotStyle", "\[Rule]", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                 "]"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"xticks", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.1", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"10", ",", "10"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"50", ",", "50"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"100", ",", "100"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"500", ",", "500"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1000", ",", "1000"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5000", ",", "5000"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"10000", ",", "10000"}], "}"}]}], "}"}], ",", 
              "None"}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"xticks2", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.01", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.1", ",", "0.1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"10", ",", "10"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"50", ",", "50"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"100", ",", "100"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"500", ",", "500"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1000", ",", "1000"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5000", ",", "5000"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"10000", ",", "10000"}], "}"}]}], "}"}], ",", 
              "None"}], "}"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"brokenAxisPlot", "=", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"ReplacePart", "[", 
                 RowBox[{"data2", ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", "0.1"}]}], 
                 "]"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"PointSize", "[", "0.02", "]"}]}], ",", 
                RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                RowBox[{"FrameTicks", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                   "xticks"}], "}"}]}], ",", 
                RowBox[{"GridLines", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0.12", ",", "0.13"}], "}"}], ",", "None"}], 
                  "}"}]}], ",", 
                RowBox[{"GridLinesStyle", "\[Rule]", "Black"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                RowBox[{"FrameStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Black", ",", "18", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                  "]"}]}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<[I] (\[Mu]M)\>\"", ",", "eGFPscaleUnits"}], 
                  "}"}]}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{
                    RowBox[{"Max", "[", "inhibitorConcentrations", "]"}], "*",
                     "1.2"}]}], "}"}], ",", "All"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"LogLinearPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"fits", "[", "x", "]"}], "*", "dataMax"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "0.13", ",", "5000"}], "}"}]}], "]"}], ",",
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{"controlPlotReplace0", ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Black", ",", 
                   RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
               "]"}], ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"controlPlotReplace0", "[", 
                   RowBox[{"[", "run", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlotReplace0", "]"}]}], 
                   "}"}]}], "]"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"White", ",", 
                   RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
               "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}],
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"brokenAxisPlot2", "=", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"ReplacePart", "[", 
                 RowBox[{"data2", ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", "0.01"}]}], 
                 "]"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"PointSize", "[", "0.02", "]"}]}], ",", 
                RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                RowBox[{"FrameTicks", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                   "xticks2"}], "}"}]}], ",", 
                RowBox[{"GridLines", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0.015", ",", "0.018"}], "}"}], ",", "None"}], 
                  "}"}]}], ",", 
                RowBox[{"GridLinesStyle", "\[Rule]", "Black"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                RowBox[{"FrameStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Black", ",", "18", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                  "]"}]}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<[I] (\[Mu]M)\>\"", ",", "eGFPscaleUnits"}], 
                  "}"}]}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{
                    RowBox[{"Max", "[", "inhibitorConcentrations", "]"}], "*",
                     "1.2"}]}], "}"}], ",", "All"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"LogLinearPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"fits", "[", "x", "]"}], "*", "dataMax"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "0.01", ",", "5000"}], "}"}]}], "]"}], ",",
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{"controlPlotReplace02", ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Black", ",", 
                   RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
               "]"}], ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"controlPlotReplace02", "[", 
                   RowBox[{"[", "run", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlotReplace02", "]"}]}], 
                   "}"}]}], "]"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"White", ",", 
                   RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
               "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}],
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"brokenAxisPlot3", "=", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"ReplacePart", "[", 
                 RowBox[{"data2", ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", "0.1"}]}], 
                 "]"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"PointSize", "[", "0.02", "]"}]}], ",", 
                RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                RowBox[{"FrameTicks", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                   "xticks2"}], "}"}]}], ",", 
                RowBox[{"GridLines", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0.12", ",", "0.13"}], "}"}], ",", "None"}], 
                  "}"}]}], ",", 
                RowBox[{"GridLinesStyle", "\[Rule]", "Black"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                RowBox[{"FrameStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Black", ",", "18", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                  "]"}]}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<[I] (\[Mu]M)\>\"", ",", "eGFPscaleUnits"}], 
                  "}"}]}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{
                    RowBox[{"Max", "[", "inhibitorConcentrations", "]"}], "*",
                     "1.2"}]}], "}"}], ",", "All"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"LogLinearPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"fits", "[", "x", "]"}], "*", "dataMax"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "0.13", ",", "5000"}], "}"}]}], "]"}], ",", 
              RowBox[{"LogLinearPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"fits", "[", "0.00001", "]"}], "*", "dataMax"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "0.01", ",", "0.118"}], "}"}]}], "]"}], 
              ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{"controlPlotReplace0", ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Black", ",", 
                   RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
               "]"}], ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"controlPlotReplace0", "[", 
                   RowBox[{"[", "run", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlotReplace0", "]"}]}], 
                   "}"}]}], "]"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"White", ",", 
                   RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
               "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}],
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "normalized", " ", "broken", " ", "axis", " ", "loglinear", " ", 
              "plot"}], " ", "-", " ", 
             RowBox[{
             "normalization", " ", "is", " ", "to", " ", "fitted", " ", 
              "Vmax"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"brokenAxisPlotNormalized", "=", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"ReplacePart", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", "Vmaxout"}]}], "}"}],
                     "&"}], "/@", "data2"}], ")"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", "0.1"}]}], 
                 "]"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"PointSize", "[", "0.02", "]"}]}], ",", 
                RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                RowBox[{"FrameTicks", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                   "xticks"}], "}"}]}], ",", 
                RowBox[{"GridLines", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0.12", ",", "0.13"}], "}"}], ",", "None"}], 
                  "}"}]}], ",", 
                RowBox[{"GridLinesStyle", "\[Rule]", "Black"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                RowBox[{"GridLinesStyle", "\[Rule]", "Gray"}], ",", 
                RowBox[{"FrameStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Black", ",", "18", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                  "]"}]}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<[I] (\[Mu]M)\>\"", ",", "eGFPscaleUnits"}], 
                  "}"}]}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{
                    RowBox[{"Max", "[", "inhibitorConcentrations", "]"}], "*",
                     "1.2"}]}], "}"}], ",", "All"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"LogLinearPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"fits", "[", "x", "]"}], "*", 
                 RowBox[{"dataMax", "/", "Vmaxout"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "0.13", ",", "5000"}], "}"}]}], "]"}], ",",
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{"controlPlotNormReplace0", ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Black", ",", 
                   RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
               "]"}], ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"controlPlotNormReplace0", "[", 
                   RowBox[{"[", "run", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlotNormReplace0", "]"}]}],
                    "}"}]}], "]"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"White", ",", 
                   RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
               "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}],
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"brokenAxisPlotNormalized2", "=", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"ReplacePart", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", "Vmaxout"}]}], "}"}],
                     "&"}], "/@", "data2"}], ")"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", "0.01"}]}], 
                 "]"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"PointSize", "[", "0.02", "]"}]}], ",", 
                RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                RowBox[{"FrameTicks", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                   "xticks2"}], "}"}]}], ",", 
                RowBox[{"GridLines", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0.12", ",", "0.13"}], "}"}], ",", "None"}], 
                  "}"}]}], ",", 
                RowBox[{"GridLinesStyle", "\[Rule]", "Black"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                RowBox[{"GridLinesStyle", "\[Rule]", "Gray"}], ",", 
                RowBox[{"FrameStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Black", ",", "18", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                  "]"}]}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<[I] (\[Mu]M)\>\"", ",", "eGFPscaleUnits"}], 
                  "}"}]}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{
                    RowBox[{"Max", "[", "inhibitorConcentrations", "]"}], "*",
                     "1.2"}]}], "}"}], ",", "All"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"LogLinearPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"fits", "[", "x", "]"}], "*", 
                 RowBox[{"dataMax", "/", "Vmaxout"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "0.01", ",", "5000"}], "}"}]}], "]"}], ",",
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{"controlPlotNormReplace02", ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Black", ",", 
                   RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
               "]"}], ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"controlPlotNormReplace02", "[", 
                   RowBox[{"[", "run", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"run", ",", "1", ",", 
                    RowBox[{
                    "Length", "[", "controlPlotNormReplace02", "]"}]}], 
                   "}"}]}], "]"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"White", ",", 
                   RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
               "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}],
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"brokenAxisPlotNormalized3", "=", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"ReplacePart", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", "Vmaxout"}]}], "}"}],
                     "&"}], "/@", "data2"}], ")"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", "0.1"}]}], 
                 "]"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"PointSize", "[", "0.02", "]"}]}], ",", 
                RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                RowBox[{"FrameTicks", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                   "xticks2"}], "}"}]}], ",", 
                RowBox[{"GridLines", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0.12", ",", "0.13"}], "}"}], ",", "None"}], 
                  "}"}]}], ",", 
                RowBox[{"GridLinesStyle", "\[Rule]", "Black"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                RowBox[{"GridLinesStyle", "\[Rule]", "Gray"}], ",", 
                RowBox[{"FrameStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Black", ",", "18", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                  "]"}]}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<[I] (\[Mu]M)\>\"", ",", "eGFPscaleUnits"}], 
                  "}"}]}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{
                    RowBox[{"Max", "[", "inhibitorConcentrations", "]"}], "*",
                     "1.2"}]}], "}"}], ",", "All"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"LogLinearPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"fits", "[", "x", "]"}], "*", 
                 RowBox[{"dataMax", "/", "Vmaxout"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "0.13", ",", "5000"}], "}"}]}], "]"}], ",", 
              RowBox[{"LogLinearPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"fits", "[", "0.00001", "]"}], "*", "dataMax"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "0.01", ",", "0.118"}], "}"}]}], "]"}], 
              ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{"controlPlotNormReplace0", ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Black", ",", 
                   RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
               "]"}], ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"controlPlotNormReplace0", "[", 
                   RowBox[{"[", "run", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlotNormReplace0", "]"}]}],
                    "}"}]}], "]"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"White", ",", 
                   RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
               "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}],
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"plot", " ", "dropout", " ", "fitting"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"dropoutFitPlot", "=", 
              RowBox[{"Show", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogLinearPlot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "2"}], "]"}], "]"}], "[", "x", "]"}], 
                    "*", "dataMax"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0.4", ",", "1250"}], "}"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], ",", 
                    RowBox[{"ColorData", "[", 
                    RowBox[{"4", ",", "\"\<ColorList\>\""}], "]"}]}], "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
                    RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"ListLogLinearPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"ListLogLinearPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], ",", 
                    RowBox[{"ColorData", "[", 
                    RowBox[{"4", ",", "\"\<ColorList\>\""}], "]"}]}], "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "droppedfits", "]"}]}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"ListLogLinearPlot", "[", 
                 RowBox[{"controlPlot", ",", 
                  RowBox[{"PlotStyle", "\[Rule]", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                 "]"}], ",", 
                RowBox[{"ListLogLinearPlot", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                   "]"}], ",", 
                  RowBox[{"PlotStyle", "\[Rule]", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                 "]"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                RowBox[{"GridLines", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"None", ",", 
                   RowBox[{"{", 
                    RowBox[{"data2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "}"}]}], "}"}]}], 
                ",", 
                RowBox[{"GridLinesStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Gray", ",", " ", "Dashed"}], "]"}]}], ",", 
                RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<[I] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                  "}"}]}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"eGFPscaleAppend", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
              "\"\< PerPointScaled\>\"", ",", "\"\< Unscaled\>\""}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"StringJoin", "[", 
              RowBox[{
              "\"\<InhibitionFitPlot\>\"", ",", "\"\< \>\"", ",", "keyAppend",
                ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
             RowBox[{
              RowBox[{
              "MMfitplot", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<InhibitionFitPlotAll\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}]}], "\[Rule]", 
              "dropoutFitPlot"}]}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", " ", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "note", " ", "that", " ", "when", " ", "plotting", " ", 
             "MMFitObj", " ", "need", " ", "to", " ", "apply", " ", "the", 
             " ", "scale", " ", "factor"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Association", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<Indices\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"grouped", "[", 
                  RowBox[{"n", ",", "1", ",", "\"\<Indices\>\""}], "]"}], "//",
                  "Normal"}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<VmaxMMfit\>\"", ",", "\"\< \>\"", ",", "keyAppend", ",", 
                 "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Vmax", "/.", 
                   RowBox[{"fits", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ")"}], "*", 
                 "dataMax"}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<KiInhibitionFit\>\"", ",", "\"\< \>\"", ",", "keyAppend",
                  ",", "eGFPscaleAppend"}], "]"}], "->", 
               RowBox[{"(", 
                RowBox[{"Ki", "/.", 
                 RowBox[{"fits", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<InhibitionFitObj\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               RowBox[{"(", "fits", ")"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<InhibitionFit ScaleFactor\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend"}], "]"}], "\[Rule]", 
               RowBox[{"(", "dataMax", ")"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<InhibitionFitRsquared\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               RowBox[{"fits", "[", "\"\<RSquared\>\"", "]"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<DataPointsUsedforInhibitionfitting\>\"", ",", 
                 "\"\< \>\"", ",", "keyAppend", ",", "eGFPscaleAppend"}], 
                "]"}], "\[Rule]", 
               RowBox[{"Normal", "[", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"grouped", "[", 
                   RowBox[{"n", ",", "All", ",", "rateKey"}], "]"}], ",", 
                  "\"\<NaN\>\""}], "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<BrokenAxisFitPlot\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               "brokenAxisPlot"}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<BrokenAxisFitPlot2\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               "brokenAxisPlot2"}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<BrokenAxisFitPlot3\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               "brokenAxisPlot3"}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<BrokenAxisFitPlotNormalized\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               "brokenAxisPlotNormalized"}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<BrokenAxisFitPlotNormalized2\>\"", ",", "\"\< \>\"", ",",
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               "brokenAxisPlotNormalized2"}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<BrokenAxisFitPlotNormalized3\>\"", ",", "\"\< \>\"", ",",
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               "brokenAxisPlotNormalized3"}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<DropoutFitObjects\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               "droppedfits"}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<ControlPoints\>\"", ",", "\"\< \>\"", ",", "keyAppend", 
                 ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               "controlPlot"}]}], "}"}], "]"}]}], ")"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"Length", "[", "grouped", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Dataset", "[", 
       RowBox[{"JoinAcross", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "dataset", "]"}], ",", "fitdata", ",", 
         "\"\<Indices\>\"", ",", "\"\<Left\>\""}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitInhibitionRestrain0", "[", 
    RowBox[{"dataset_", ",", "rateKey_", ",", "keyAppend_", ",", 
     RowBox[{"scaleByGFP_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "removeControl", ",", "grouped", ",", "fitdata", ",", "fits", ",", 
       "rates", ",", "data", ",", "data2", ",", "dataMax", ",", "dataNorm", 
       ",", "droppedfits", ",", "Vmaxout", ",", "KIout", ",", 
       "dropoutFitPlot", ",", "slopeout", ",", "interceptout", ",", 
       "dropoutLinearFitPlot", ",", "MMfitplot", ",", "fullLinearFitPlot", 
       ",", "eGFPscalingList", ",", "data2a", ",", "data2b", ",", 
       "eGFPscaleAppend", ",", "eGFPscaleUnits", ",", 
       "inhibitorConcentrations", ",", "onlyControl", ",", "groupedControl", 
       ",", "controlData", ",", "inhibitorConcentrationsControl", ",", 
       "eGFPscalingListControl", ",", "controlPlotTEMP", ",", "controlPlot"}],
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"reads", " ", "in", " ", "Dataset"}], ",", " ", 
       RowBox[{
        RowBox[{"fits", " ", "chosen", " ", "rates", " ", 
         RowBox[{"(", 
          RowBox[{"determined", " ", "by", " ", "key"}], ")"}], " ", "to", 
         " ", "linear", " ", "and", " ", "Michaelis"}], "-", 
        RowBox[{"Menten", " ", "models"}]}], ",", " ", 
       RowBox[{
       "returning", " ", "a", " ", "list", " ", "of", " ", "associations"}], 
       ",", " ", 
       RowBox[{
       "and", " ", "merging", " ", "fit", " ", "data", " ", "with", " ", 
        "input", " ", "data", " ", "to", " ", "create", " ", "a", " ", "new", 
        " ", "aggregate", " ", "dataset"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"removeControl", "=", 
       RowBox[{"dataset", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"#AssayType", "\[Equal]", "1"}], "&"}], "]"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"grouped", "=", 
       RowBox[{"removeControl", "[", 
        RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"onlyControl", "=", 
       RowBox[{"dataset", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"#AssayType", "\[Equal]", "0"}], "&"}], "]"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"groupedControl", "=", 
       RowBox[{"onlyControl", "[", 
        RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fitdata", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Clear", "[", 
            RowBox[{
            "fits", ",", "data", ",", "data2", ",", "dataNorm", ",", "rates", 
             ",", "inhibitorConcentrations", ",", "eGFPscalingList"}], "]"}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"inhibitorConcentrations", "=", 
            RowBox[{"Normal", "[", 
             RowBox[{"grouped", "[", 
              RowBox[{
              "n", ",", "All", ",", "\"\<InhibitorConcentration\>\""}], "]"}],
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"eGFPscalingList", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Normal", "[", 
                 RowBox[{"grouped", "[", 
                  RowBox[{"n", ",", "All", ",", "\"\<eGFPSummedI\>\""}], 
                  "]"}], "]"}], "/", "eGFPslope"}], "/", "1000."}], ",", 
              RowBox[{"scaleByGFP", "\[Equal]", "0"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{"1", ",", 
                RowBox[{"{", 
                 RowBox[{"Length", "[", "inhibitorConcentrations", "]"}], 
                 "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"rates", "=", 
            RowBox[{"Normal", "[", 
             RowBox[{"grouped", "[", 
              RowBox[{"n", ",", "All", ",", "rateKey"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"data", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"inhibitorConcentrations", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"rates", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"eGFPscalingList", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"Length", "[", "inhibitorConcentrations", "]"}]}], 
               "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"data2a", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"data", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", 
                   "\"\<NaN\>\""}], "&&", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], "&&", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ">", "0"}]}], "&"}]}], 
               "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"data2a", "=", "data"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"data2b", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"data2a", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"data2a", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "2"}], "]"}], "]"}], "/", 
                 RowBox[{"data2a", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"Length", "[", "data2a", "]"}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"dataMax", "=", 
            RowBox[{"First", "[", 
             RowBox[{"data2b", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"data2", "=", "data2b"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"dataNorm", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"data2", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"data2", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "2"}], "]"}], "]"}], "/", "dataMax"}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"Length", "[", "data2", "]"}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "restraining", " ", "Vmax", " ", "to", " ", "the", " ", "0", " ", 
             "point"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"fits", "=", 
            RowBox[{"NonlinearModelFit", "[", 
             RowBox[{"dataNorm", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1.0", "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"inhibitor", "/", "Ki"}]}], ")"}]}], ",", 
                RowBox[{"Ki", ">", "0.0"}]}], "}"}], ",", 
              RowBox[{"{", "Ki", "}"}], ",", "inhibitor"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "drop", " ", "individual", " ", "points", " ", "and", " ", 
             "refit"}], " ", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"droppedfits", "=", 
            RowBox[{
            "Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"dataNorm", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"NonlinearModelFit", "[", 
                 RowBox[{"dataNorm", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"1.0", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"inhibitor", "/", "Ki"}]}], ")"}]}], ",", 
                    RowBox[{"Ki", ">", "0.0"}]}], "}"}], ",", 
                  RowBox[{"{", "Ki", "}"}], ",", "inhibitor"}], "]"}]}], 
               "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"Length", "[", "dataNorm", "]"}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"extract", " ", "parameters"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Vmaxout", "=", 
            RowBox[{"1.0", "*", "dataMax"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"KIout", "=", 
            RowBox[{"KI", "/.", 
             RowBox[{"droppedfits", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2", ",", "1", ",", "2"}], "]"}], 
              "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"eGFPscaleUnits", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
              "\"\<Scaled initial rate (\!\(\*SuperscriptBox[\(s\), \
\(-1\)]\))\>\"", ",", "\"\<Initial rate (uM/s)\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"control", " ", "data"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"controlData", "=", 
            RowBox[{"groupedControl", "[", "n", "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"inhibitorConcentrationsControl", "=", 
            RowBox[{"Normal", "[", 
             RowBox[{"controlData", "[", 
              RowBox[{"All", ",", "\"\<InhibitorConcentration\>\""}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"eGFPscalingListControl", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Normal", "[", 
                 RowBox[{"controlData", "[", 
                  RowBox[{"All", ",", "\"\<eGFPSummedI\>\""}], "]"}], "]"}], 
                "/", "eGFPslope"}], "/", "1000."}], ",", 
              RowBox[{"scaleByGFP", "\[Equal]", "0"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{"1", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "Length", "[", "inhibitorConcentrationsControl", "]"}], 
                 "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"controlPlotTEMP", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"controlData", "[", 
                 RowBox[{"run", ",", "\"\<InhibitorConcentration\>\""}], 
                 "]"}], ",", 
                RowBox[{"controlData", "[", 
                 RowBox[{"run", ",", "rateKey"}], "]"}], ",", 
                RowBox[{"eGFPscalingListControl", "[", 
                 RowBox[{"[", "run", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"run", ",", "1", ",", 
                RowBox[{"Length", "[", "controlData", "]"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"controlPlot", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"controlPlotTEMP", "[", 
                 RowBox[{"[", 
                  RowBox[{"run", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"controlPlotTEMP", "[", 
                  RowBox[{"[", 
                   RowBox[{"run", ",", "2"}], "]"}], "]"}], "/", 
                 RowBox[{"controlPlotTEMP", "[", 
                  RowBox[{"[", 
                   RowBox[{"run", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"run", ",", "1", ",", 
                RowBox[{"Length", "[", "controlPlotTEMP", "]"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"full", " ", "inhibition", " ", "fit"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"MMfitplot", "=", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"LogLinearPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"fits", "[", "x", "]"}], "*", "dataMax"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "0.4", ",", "1250"}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<[I] (uM)\>\"", ",", "\"\<Initial rate (uM/s)\>\""}], 
                  "}"}]}]}], "]"}], ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{"data2", ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                RowBox[{"GridLines", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"None", ",", 
                   RowBox[{"{", 
                    RowBox[{"data2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "}"}]}], "}"}]}], 
                ",", 
                RowBox[{"GridLinesStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Gray", ",", " ", "Dashed"}], "]"}]}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<[I] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                  "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{"controlPlot", ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Black", ",", 
                   RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
               "]"}], ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"controlPlot", "[", 
                   RowBox[{"[", "run", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"White", ",", 
                   RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
               "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"plot", " ", "dropout", " ", "fitting"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"dropoutFitPlot", "=", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"LogLinearPlot", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "2"}], "]"}], "]"}], "[", "x", "]"}], 
                    "*", "dataMax"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0.4", ",", "1250"}], "}"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], ",", 
                    RowBox[{"ColorData", "[", 
                    RowBox[{"4", ",", "\"\<ColorList\>\""}], "]"}]}], "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
                    RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}]}], "]"}], 
                  ",", 
                  RowBox[{"ListLogLinearPlot", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                   "]"}], ",", 
                  RowBox[{"ListLogLinearPlot", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], ",", 
                    RowBox[{"ColorData", "[", 
                    RowBox[{"4", ",", "\"\<ColorList\>\""}], "]"}]}], "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"run", ",", "1", ",", 
                  RowBox[{"Length", "[", "droppedfits", "]"}]}], "}"}]}], 
               "]"}], ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{"controlPlot", ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Black", ",", 
                   RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
               "]"}], ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"controlPlot", "[", 
                   RowBox[{"[", "run", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"White", ",", 
                   RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
               "]"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
              RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
              RowBox[{"GridLines", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"None", ",", 
                 RowBox[{"{", 
                  RowBox[{"data2", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "}"}]}], "}"}]}], 
              ",", 
              RowBox[{"GridLinesStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"Gray", ",", " ", "Dashed"}], "]"}]}], ",", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"Axes", "\[Rule]", "False"}], ",", 
              RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<[I] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"eGFPscaleAppend", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
              "\"\< PerPointScaled\>\"", ",", "\"\< Unscaled\>\""}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "note", " ", "that", " ", "when", " ", "plotting", " ", 
             "MMFitObj", " ", "need", " ", "to", " ", "apply", " ", "the", 
             " ", "scale", " ", "factor"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Association", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<Indices\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"grouped", "[", 
                  RowBox[{"n", ",", "1", ",", "\"\<Indices\>\""}], "]"}], "//",
                  "Normal"}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<VmaxMMfit\>\"", ",", "\"\< \>\"", ",", "keyAppend", ",", 
                 "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               RowBox[{"(", "dataMax", ")"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<KiInhibitionFit\>\"", ",", "\"\< \>\"", ",", "keyAppend",
                  ",", "eGFPscaleAppend"}], "]"}], "->", 
               RowBox[{"(", 
                RowBox[{"Ki", "/.", 
                 RowBox[{"fits", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<InhibitionFitObj\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               RowBox[{"(", "fits", ")"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<InhibitionFit ScaleFactor\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend"}], "]"}], "\[Rule]", 
               RowBox[{"(", "dataMax", ")"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<InhibitionFitRsquared\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               RowBox[{"fits", "[", "\"\<RSquared\>\"", "]"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<DataPointsUsedforInhibitionfitting\>\"", ",", 
                 "\"\< \>\"", ",", "keyAppend", ",", "eGFPscaleAppend"}], 
                "]"}], "\[Rule]", 
               RowBox[{"Length", "[", 
                RowBox[{"Normal", "[", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"grouped", "[", 
                    RowBox[{"n", ",", "All", ",", "rateKey"}], "]"}], ",", 
                   "\"\<NaN\>\""}], "]"}], "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<InhibitionFitPlot\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               "MMfitplot"}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<InhibitionFitPlotAll\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               "dropoutFitPlot"}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<DropoutFitObjects\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               "droppedfits"}]}], "}"}], "]"}]}], ")"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"Length", "[", "grouped", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Dataset", "[", 
       RowBox[{"JoinAcross", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "dataset", "]"}], ",", "fitdata", ",", 
         "\"\<Indices\>\"", ",", "\"\<Left\>\""}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fitMichaelisMentenNoPlotting", "[", 
     RowBox[{"dataset_", ",", "rateKey_", ",", "keyAppend_", ",", 
      RowBox[{"scaleByGFP_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "removeControl", ",", "grouped", ",", "fitdata", ",", "fits", ",", 
        "rates", ",", "data", ",", "data2", ",", "dataMax", ",", "dataNorm", 
        ",", "droppedfits", ",", "Vmaxout", ",", "KIout", ",", 
        "dropoutFitPlot", ",", "slopeout", ",", "interceptout", ",", 
        "dropoutLinearFitPlot", ",", "MMfitplot", ",", "fullLinearFitPlot", 
        ",", "eGFPscalingList", ",", "data2a", ",", "data2b", ",", 
        "eGFPscaleAppend", ",", "eGFPscaleUnits", ",", 
        "substrateconcentrations", ",", "onlyControl", ",", "groupedControl", 
        ",", "controlData", ",", "substrateConcentrationsControl", ",", 
        "eGFPscalingListControl", ",", "controlPlotTEMP", ",", 
        "controlPlot"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"reads", " ", "in", " ", "Dataset"}], ",", " ", 
        RowBox[{
         RowBox[{"fits", " ", "chosen", " ", "rates", " ", 
          RowBox[{"(", 
           RowBox[{"determined", " ", "by", " ", "key"}], ")"}], " ", "to", 
          " ", "linear", " ", "and", " ", "Michaelis"}], "-", 
         RowBox[{"Menten", " ", "models"}]}], ",", " ", 
        RowBox[{
        "returning", " ", "a", " ", "list", " ", "of", " ", "associations"}], 
        ",", " ", 
        RowBox[{
        "and", " ", "merging", " ", "fit", " ", "data", " ", "with", " ", 
         "input", " ", "data", " ", "to", " ", "create", " ", "a", " ", "new",
          " ", "aggregate", " ", "dataset"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"start", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"removeControl", "=", 
        RowBox[{"dataset", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"#AssayType", "\[Equal]", "1"}], "&"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"grouped", "=", 
        RowBox[{"removeControl", "[", 
         RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"onlyControl", "=", 
        RowBox[{"dataset", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"#AssayType", "\[Equal]", "0"}], "&"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"groupedControl", "=", 
        RowBox[{"onlyControl", "[", 
         RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"fitdata", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Clear", "[", 
             RowBox[{
             "fits", ",", "data", ",", "data2", ",", "rates", ",", 
              "substrateconcentrations", ",", "eGFPscalingList"}], "]"}], ";",
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"substrateconcentrations", "=", 
             RowBox[{"Normal", "[", 
              RowBox[{"grouped", "[", 
               RowBox[{"n", ",", "All", ",", "\"\<SubstrateConc\>\""}], "]"}],
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"eGFPscalingList", "=", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Normal", "[", 
                  RowBox[{"grouped", "[", 
                   RowBox[{"n", ",", "All", ",", "\"\<eGFPSummedI\>\""}], 
                   "]"}], "]"}], "/", "eGFPslope"}], "/", "1000."}], ",", 
               RowBox[{"scaleByGFP", "\[Equal]", "0"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "substrateconcentrations", "]"}], 
                  "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"rates", "=", 
             RowBox[{"Normal", "[", 
              RowBox[{"grouped", "[", 
               RowBox[{"n", ",", "All", ",", "rateKey"}], "]"}], "]"}]}], ";",
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"data", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"substrateconcentrations", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], ",", 
                 RowBox[{"rates", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], ",", 
                 RowBox[{"eGFPscalingList", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "substrateconcentrations", "]"}]}], 
                "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"data2a", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"data", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", 
                    "\"\<NaN\>\""}], "&&", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], "&&", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ">", "0"}]}], "&"}]}], 
                "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"data2a", "=", "data"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"data2b", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"data2a", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"data2a", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], "/", 
                  RowBox[{"data2a", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "data2a", "]"}]}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"dataMax", "=", 
             RowBox[{"Max", "[", 
              RowBox[{"data2b", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"data2", "=", "data2b"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"dataNorm", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"data2", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"data2", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], "/", "dataMax"}]}],
                 "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "data2", "]"}]}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"fits", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"LinearModelFit", "[", 
                RowBox[{"data2", ",", "x", ",", "x"}], "]"}], ",", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"dataNorm", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Vmax", "*", 
                    RowBox[{"substrate", "/", 
                    RowBox[{"(", 
                    RowBox[{"KM", "+", "substrate"}], ")"}]}]}], ",", 
                   RowBox[{
                    RowBox[{"KM", ">", "0"}], "&&", 
                    RowBox[{"Vmax", ">", "0"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Vmax", ",", "KM"}], "}"}], ",", "substrate"}], 
                "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "drop", " ", "individual", " ", "points", " ", "and", " ", 
              "refit"}], " ", "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"droppedfits", "=", 
             RowBox[{
             "Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"dataNorm", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], ",", 
                 RowBox[{"NonlinearModelFit", "[", 
                  RowBox[{
                   RowBox[{"Drop", "[", 
                    RowBox[{"dataNorm", ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Vmax", "*", 
                    RowBox[{"substrate", "/", 
                    RowBox[{"(", 
                    RowBox[{"KM", "+", "substrate"}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"KM", ">", "0"}], "&&", 
                    RowBox[{"Vmax", ">", "0"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"Vmax", ",", "KM"}], "}"}], ",", "substrate"}], 
                  "]"}], ",", 
                 RowBox[{"LinearModelFit", "[", 
                  RowBox[{
                   RowBox[{"Drop", "[", 
                    RowBox[{"data2", ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}], ",", "x", ",", "x"}], 
                  "]"}]}], "}"}], "\[IndentingNewLine]", 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "dataNorm", "]"}]}], "}"}]}], "]"}]}],
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"extract", " ", "parameters"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Vmaxout", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Vmax", "/.", 
                RowBox[{"droppedfits", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2", ",", "1", ",", "2"}], "]"}], 
                 "]"}]}], ")"}], "*", "dataMax"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"KMout", "=", 
             RowBox[{"KM", "/.", 
              RowBox[{"droppedfits", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2", ",", "1", ",", "2"}], "]"}], 
               "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"slopeout", "=", 
             RowBox[{"droppedfits", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3", ",", "1", ",", "2", ",", "2"}], "]"}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"interceptout", "=", 
             RowBox[{"droppedfits", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3", ",", "1", ",", "2", ",", "1"}], "]"}],
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"eGFPscaleUnits", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               "\"\<Scaled initial rate (\!\(\*SuperscriptBox[\(s\), \
\(-1\)]\))\>\"", ",", "\"\<Initial rate (uM/s)\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"eGFPscaleAppend", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               "\"\< PerPointScaled\>\"", ",", "\"\< Unscaled\>\""}], "]"}]}],
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Vmaxorkcat", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               "\"\<kcatMMfit\>\"", ",", "\"\<VmaxMMfit\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "note", " ", "that", " ", "when", " ", "plotting", " ", 
              "MMFitObj", " ", "need", " ", "to", " ", "apply", " ", "the", 
              " ", "scale", " ", "factor"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Association", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<Indices\>\"", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"grouped", "[", 
                   RowBox[{"n", ",", "1", ",", "\"\<Indices\>\""}], "]"}], "//",
                   "Normal"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<LinFitSlope\>\"", ",", "\"\< \>\"", ",", "keyAppend", 
                  ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"fits", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}]}],
                ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<LinFitIntercept\>\"", ",", "\"\< \>\"", ",", 
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "->", 
                RowBox[{"fits", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}]}],
                ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<LinMMFitObj\>\"", ",", "\"\< \>\"", ",", "keyAppend", 
                  ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"fits", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<LinMMFitRsquared\>\"", ",", "\"\< \>\"", ",", 
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"fits", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<RSquared\>\"", 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "Vmaxorkcat", ",", "\"\< \>\"", ",", "keyAppend", ",", 
                  "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Vmax", "/.", 
                    RowBox[{"fits", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], ")"}], 
                  "*", "dataMax"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<KmMMfit\>\"", ",", "\"\< \>\"", ",", "keyAppend", ",", 
                  "eGFPscaleAppend"}], "]"}], "->", 
                RowBox[{"(", 
                 RowBox[{"KM", "/.", 
                  RowBox[{"fits", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], 
                 ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<MMFitObj\>\"", ",", "\"\< \>\"", ",", "keyAppend", ",", 
                  "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"fits", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<MMFit ScaleFactor\>\"", ",", "\"\< \>\"", ",", 
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"(", "dataMax", ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<MMFitRsquared\>\"", ",", "\"\< \>\"", ",", "keyAppend", 
                  ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"fits", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<RSquared\>\"", 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<DataPointsUsedforMMfitting\>\"", ",", "\"\< \>\"", ",", 
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"Length", "[", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"grouped", "[", 
                    RowBox[{"n", ",", "All", ",", "rateKey"}], "]"}], ",", 
                    "\"\<NaN\>\""}], "]"}], "]"}], "]"}]}]}], "}"}], "]"}]}], 
           ")"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "grouped", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Dataset", "[", 
        RowBox[{"JoinAcross", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "dataset", "]"}], ",", "fitdata", ",", 
          "\"\<Indices\>\"", ",", "\"\<Left\>\""}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fitMichaelisMenten", "[", 
     RowBox[{"dataset_", ",", "rateKey_", ",", "keyAppend_", ",", 
      RowBox[{"scaleByGFP_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "removeControl", ",", "grouped", ",", "fitdata", ",", "fits", ",", 
        "rates", ",", "data", ",", "data2", ",", "dataMax", ",", "dataNorm", 
        ",", "droppedfits", ",", "Vmaxout", ",", "KIout", ",", 
        "dropoutFitPlot", ",", "slopeout", ",", "interceptout", ",", 
        "dropoutLinearFitPlot", ",", "MMfitplot", ",", "fullLinearFitPlot", 
        ",", "eGFPscalingList", ",", "data2a", ",", "data2b", ",", 
        "eGFPscaleAppend", ",", "eGFPscaleUnits", ",", 
        "substrateconcentrations", ",", "onlyControl", ",", "groupedControl", 
        ",", "controlData", ",", "substrateConcentrationsControl", ",", 
        "eGFPscalingListControl", ",", "controlPlotTEMP", ",", "controlPlot", 
        ",", "jknifemmFitkcats", ",", "jknifemmFitKMs", ",", 
        "jknifelinFitSlopes", ",", "jknifelinFitIntercept", ",", 
        "Vmaxorkcat"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"reads", " ", "in", " ", "Dataset"}], ",", " ", 
        RowBox[{
         RowBox[{"fits", " ", "chosen", " ", "rates", " ", 
          RowBox[{"(", 
           RowBox[{"determined", " ", "by", " ", "key"}], ")"}], " ", "to", 
          " ", "linear", " ", "and", " ", "Michaelis"}], "-", 
         RowBox[{"Menten", " ", "models"}]}], ",", " ", 
        RowBox[{
        "returning", " ", "a", " ", "list", " ", "of", " ", "associations"}], 
        ",", " ", 
        RowBox[{
        "and", " ", "merging", " ", "fit", " ", "data", " ", "with", " ", 
         "input", " ", "data", " ", "to", " ", "create", " ", "a", " ", "new",
          " ", "aggregate", " ", "dataset"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"removeControl", "=", 
        RowBox[{"dataset", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"#AssayType", "\[Equal]", "1"}], "&"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"grouped", "=", 
        RowBox[{"removeControl", "[", 
         RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"onlyControl", "=", 
        RowBox[{"dataset", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"#AssayType", "\[Equal]", "0"}], "&"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"groupedControl", "=", 
        RowBox[{"onlyControl", "[", 
         RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"fitdata", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Clear", "[", 
             RowBox[{
             "fits", ",", "data", ",", "data2", ",", "rates", ",", 
              "substrateconcentrations", ",", "eGFPscalingList"}], "]"}], ";",
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"substrateconcentrations", "=", 
             RowBox[{"Normal", "[", 
              RowBox[{"grouped", "[", 
               RowBox[{"n", ",", "All", ",", "\"\<SubstrateConc\>\""}], "]"}],
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"eGFPscalingList", "=", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Normal", "[", 
                  RowBox[{"grouped", "[", 
                   RowBox[{"n", ",", "All", ",", "\"\<eGFPSummedI\>\""}], 
                   "]"}], "]"}], "/", "eGFPslope"}], "/", "1000."}], ",", 
               RowBox[{"scaleByGFP", "\[Equal]", "0"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "substrateconcentrations", "]"}], 
                  "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"rates", "=", 
             RowBox[{"Normal", "[", 
              RowBox[{"grouped", "[", 
               RowBox[{"n", ",", "All", ",", "rateKey"}], "]"}], "]"}]}], ";",
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"data", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"substrateconcentrations", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], ",", 
                 RowBox[{"rates", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], ",", 
                 RowBox[{"eGFPscalingList", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "substrateconcentrations", "]"}]}], 
                "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"data2a", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"data", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", 
                    "\"\<NaN\>\""}], "&&", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], "&&", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ">", "0"}]}], "&"}]}], 
                "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"data2a", "=", "data"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"data2b", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"data2a", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"data2a", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], "/", 
                  RowBox[{"data2a", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "data2a", "]"}]}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"dataMax", "=", 
             RowBox[{"Max", "[", 
              RowBox[{"data2b", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"data2", "=", "data2b"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"dataNorm", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"data2", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"data2", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], "/", "dataMax"}]}],
                 "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "data2", "]"}]}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"fits", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"LinearModelFit", "[", 
                RowBox[{"data2", ",", "x", ",", "x"}], "]"}], ",", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"dataNorm", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Vmax", "*", 
                    RowBox[{"substrate", "/", 
                    RowBox[{"(", 
                    RowBox[{"KM", "+", "substrate"}], ")"}]}]}], ",", 
                   RowBox[{
                    RowBox[{"KM", ">", "0"}], "&&", 
                    RowBox[{"Vmax", ">", "0"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Vmax", ",", "KM"}], "}"}], ",", "substrate"}], 
                "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "drop", " ", "individual", " ", "points", " ", "and", " ", 
              "refit"}], " ", "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"droppedfits", "=", 
               RowBox[{
               "Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"dataNorm", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], ",", 
                   RowBox[{"NonlinearModelFit", "[", 
                    RowBox[{
                    RowBox[{"Drop", "[", 
                    RowBox[{"dataNorm", ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Vmax", "*", 
                    RowBox[{"substrate", "/", 
                    RowBox[{"(", 
                    RowBox[{"KM", "+", "substrate"}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"KM", ">", "0"}], "&&", 
                    RowBox[{"Vmax", ">", "0"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Vmax", ",", "KM"}], "}"}], ",", "substrate"}], 
                    "]"}], ",", 
                   RowBox[{"LinearModelFit", "[", 
                    RowBox[{
                    RowBox[{"Drop", "[", 
                    RowBox[{"data2", ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}], ",", "x", ",", "x"}], 
                    "]"}]}], "}"}], "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", "1", ",", 
                   RowBox[{"Length", "[", "dataNorm", "]"}]}], "}"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"extract", " ", "parameters"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"Vmaxout", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Vmax", "/.", 
                  RowBox[{"droppedfits", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2", ",", "1", ",", "2"}], "]"}], 
                   "]"}]}], ")"}], "*", "dataMax"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"KMout", "=", 
               RowBox[{"KM", "/.", 
                RowBox[{"droppedfits", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2", ",", "1", ",", "2"}], "]"}], 
                 "]"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"slopeout", "=", 
               RowBox[{"droppedfits", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "3", ",", "1", ",", "2", ",", "2"}], 
                 "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"interceptout", "=", 
               RowBox[{"droppedfits", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "3", ",", "1", ",", "2", ",", "1"}], 
                 "]"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"eGFPscaleUnits", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               "\"\<Scaled initial rate (\!\(\*SuperscriptBox[\(s\), \
\(-1\)]\))\>\"", ",", "\"\<Initial rate (uM/s)\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"control", " ", "data"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"controlData", "=", 
             RowBox[{"groupedControl", "[", "n", "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"substrateConcentrationsControl", "=", 
             RowBox[{"Normal", "[", 
              RowBox[{"controlData", "[", 
               RowBox[{"All", ",", "\"\<SubstrateConc\>\""}], "]"}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"eGFPscalingListControl", "=", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Normal", "[", 
                  RowBox[{"controlData", "[", 
                   RowBox[{"All", ",", "\"\<eGFPSummedI\>\""}], "]"}], "]"}], 
                 "/", "eGFPslope"}], "/", "1000."}], ",", 
               RowBox[{"scaleByGFP", "\[Equal]", "0"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "Length", "[", "substrateConcentrationsControl", "]"}], 
                  "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"controlPlotTEMP", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"controlData", "[", 
                  RowBox[{"run", ",", "\"\<SubstrateConc\>\""}], "]"}], ",", 
                 RowBox[{"controlData", "[", 
                  RowBox[{"run", ",", "rateKey"}], "]"}], ",", 
                 RowBox[{"eGFPscalingListControl", "[", 
                  RowBox[{"[", "run", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"run", ",", "1", ",", 
                 RowBox[{"Length", "[", "controlData", "]"}]}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"controlPlot", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"controlPlotTEMP", "[", 
                  RowBox[{"[", 
                   RowBox[{"run", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"controlPlotTEMP", "[", 
                   RowBox[{"[", 
                    RowBox[{"run", ",", "2"}], "]"}], "]"}], "/", 
                  RowBox[{"controlPlotTEMP", "[", 
                   RowBox[{"[", 
                    RowBox[{"run", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"run", ",", "1", ",", 
                 RowBox[{"Length", "[", "controlPlotTEMP", "]"}]}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"full", " ", "MM", " ", "fit"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"MMfitplot", "=", 
               RowBox[{"Show", "[", 
                RowBox[{
                 RowBox[{"Plot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"fits", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "x", "]"}], "*", 
                    "dataMax"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1250"}], "}"}], ",", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                   RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                   RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                   RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<[cMUP] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                    "}"}]}]}], "]"}], ",", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{"data2", ",", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                   RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                   RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                   RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<[cMUP] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                    "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{"controlPlot", ",", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                  "]"}], ",", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Callout", "[", 
                    RowBox[{
                    RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                    "\"\<Remeasured\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                  "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"MMfitplot", "=", 
             RowBox[{"Show", "[", 
              RowBox[{
               RowBox[{"Plot", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"fits", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "x", "]"}], "*", 
                  "dataMax"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "0", ",", 
                   RowBox[{
                    RowBox[{"Last", "[", "substrateconcentrations", "]"}], 
                    "*", "1.25"}]}], "}"}], ",", 
                 RowBox[{"PlotRange", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                 RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                 RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                 RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                 RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                 RowBox[{"FrameLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<[Substrate] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                   "}"}]}]}], "]"}], ",", 
               RowBox[{"ListPlot", "[", 
                RowBox[{"data2", ",", 
                 RowBox[{"PlotRange", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                 RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                 RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                 RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                 RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                 RowBox[{"FrameLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<[cMUP] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                   "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"ListPlot", "[", 
                RowBox[{"controlPlot", ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                "]"}], ",", 
               RowBox[{"ListPlot", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                  "]"}], ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"full", " ", "linear", " ", "fit"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"fullLinearFitPlot", "=", 
             RowBox[{"Show", "[", 
              RowBox[{
               RowBox[{"Plot", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"fits", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", "x", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "0", ",", "1250"}], "}"}]}], "]"}], ",", 
               RowBox[{"ListPlot", "[", 
                RowBox[{"data2", ",", 
                 RowBox[{"PlotRange", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                 RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                 RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                 RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                 RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                 RowBox[{"FrameLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<[cMUP] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                   "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"ListPlot", "[", 
                RowBox[{"controlPlot", ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"ListPlot", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Callout", "[", 
                    RowBox[{
                    RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                    "\"\<Remeasured\>\""}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                  "]"}], ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"fullLinearFitPlot", "=", 
             RowBox[{"Show", "[", 
              RowBox[{
               RowBox[{"Plot", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"fits", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", "x", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "0", ",", 
                   RowBox[{
                    RowBox[{"Last", "[", "substrateconcentrations", "]"}], 
                    "*", "1.25"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"ListPlot", "[", 
                RowBox[{"data2", ",", 
                 RowBox[{"PlotRange", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                 RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                 RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                 RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                 RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                 RowBox[{"FrameLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<[Substrate] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                   "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"ListPlot", "[", 
                RowBox[{"controlPlot", ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"ListPlot", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                  "]"}], ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"plot", " ", "dropout", " ", "fitting"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"dropoutFitPlot", "=", 
               RowBox[{"Show", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "2"}], "]"}], "]"}], "[", "x", "]"}], 
                    "*", "dataMax"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1250"}], "}"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
                    RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{"controlPlot", ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Callout", "[", 
                    RowBox[{
                    RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                    "\"\<Remeasured\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "droppedfits", "]"}]}], "}"}]}], 
                  "]"}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                 RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                 RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                 RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                 RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                 RowBox[{"FrameLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<[cMUP] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                   "}"}]}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"dropoutFitPlot", "=", 
               RowBox[{"Show", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "2"}], "]"}], "]"}], "[", "x", "]"}], 
                    "*", "dataMax"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "substrateconcentrations", "]"}], 
                    "*", "1.25"}]}], "}"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
                    RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{"controlPlot", ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "droppedfits", "]"}]}], "}"}]}], 
                  "]"}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                 RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                 RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                 RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                 RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                 RowBox[{"FrameLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<[Substrate] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                   "}"}]}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"dropoutLinearFitPlot", "=", 
               RowBox[{"Show", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "3"}], "]"}], "]"}], "[", "x", "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1250"}], "}"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
                    RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "droppedfits", "]"}]}], "}"}]}], 
                  "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{"controlPlot", ",", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                  "]"}], ",", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Callout", "[", 
                    RowBox[{
                    RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                    "\"\<Remeasured\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                  "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                 RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                 RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                 RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                 RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                 RowBox[{"FrameLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<[cMUP] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                   "}"}]}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"dropoutLinearFitPlot", "=", 
               RowBox[{"Show", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "3"}], "]"}], "]"}], "[", "x", "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "substrateconcentrations", "]"}], 
                    "*", "1.25"}]}], "}"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
                    RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "droppedfits", "]"}]}], "}"}]}], 
                  "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{"controlPlot", ",", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                  "]"}], ",", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                  "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                 RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                 RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                 RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                 RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                 RowBox[{"FrameLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<[Substrate] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                   "}"}]}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"eGFPscaleAppend", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", "\"\<scaled\>\"",
                ",", "\"\<unscaled\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"jknifemmFitkcats", "=", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Vmax", "/.", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}], 
                   "&"}], "/@", "droppedfits"}], "]"}], "*", "dataMax"}]}], 
              ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"jknifemmFitKMs", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"KM", "/.", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}], 
                  "&"}], "/@", "droppedfits"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"jknifelinFitSlopes", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}], 
                 "&"}], "/@", "droppedfits"}]}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"jknifelinFitIntercept", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"3", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], 
                 "&"}], "/@", "droppedfits"}]}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Vmaxorkcat", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               "\"\<kcatMMfit\>\"", ",", "\"\<VmaxMMfit\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "note", " ", "that", " ", "when", " ", "plotting", " ", 
              "MMFitObj", " ", "need", " ", "to", " ", "apply", " ", "the", 
              " ", "scale", " ", "factor"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Association", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<Indices\>\"", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"grouped", "[", 
                   RowBox[{"n", ",", "1", ",", "\"\<Indices\>\""}], "]"}], "//",
                   "Normal"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", "\"\<_lin_slope\>\""}], "]"}], 
                "\[Rule]", 
                RowBox[{"fits", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}]}],
                ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", "\"\<_lin_slope_param_error\>\""}], 
                 "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"fits", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  "\"\<ParameterErrors\>\"", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", "\"\<_lin_intercept\>\""}], "]"}], "->", 
                RowBox[{"fits", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}]}],
                ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", 
                  "\"\<_lin_intercept_param_error\>\""}], "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"fits", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  "\"\<ParameterErrors\>\"", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", "\"\<_lin_model\>\""}], "]"}], 
                "\[Rule]", 
                RowBox[{"fits", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", "\"\<_lin_r2\>\""}], "]"}], 
                "\[Rule]", 
                RowBox[{
                 RowBox[{"fits", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<RSquared\>\"", 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", "\"\<_\>\"", ",", "Vmaxorkcat"}], 
                 "]"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Vmax", "/.", 
                    RowBox[{"fits", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], ")"}], 
                  "*", "dataMax"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", "\"\<_\>\"", ",", "Vmaxorkcat", ",", 
                  "\"\<_param_error\>\""}], "]"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"fits", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    "\"\<ParameterErrors\>\"", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ")"}], "*", "dataMax"}], 
                 ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", "\"\<_KM\>\""}], "]"}], "->", 
                RowBox[{"(", 
                 RowBox[{"KM", "/.", 
                  RowBox[{"fits", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], 
                 ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", "\"\<_KM_param_error\>\""}], "]"}], "->", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"fits", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   "\"\<ParameterErrors\>\"", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", "\"\<_curved_model\>\""}], "]"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"fits", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", "\"\<_scale_factor\>\""}], "]"}], 
                "\[Rule]", 
                RowBox[{"(", "dataMax", ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", "\"\<_curved_r2\>\""}], "]"}], 
                "\[Rule]", 
                RowBox[{
                 RowBox[{"fits", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<RSquared\>\"", 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", "\"\<_datapoints\>\""}], "]"}], 
                "\[Rule]", "dataNorm"}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", "\"\<_numdatapoints\>\""}], "]"}], 
                "\[Rule]", 
                RowBox[{"Length", "[", "dataNorm", "]"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", "\"\<_curved_plot\>\""}], "]"}], 
                "\[Rule]", "MMfitplot"}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<fit_mm\>\"", ",", "eGFPscaleAppend", ",", "\"\<-\>\"", 
                  ",", "keyAppend", ",", "\"\<_lin_plot\>\""}], "]"}], 
                "\[Rule]", "fullLinearFitPlot"}]}], "}"}], "]"}]}], ")"}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "grouped", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Dataset", "[", 
        RowBox[{"JoinAcross", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "dataset", "]"}], ",", "fitdata", ",", 
          "\"\<Indices\>\"", ",", "\"\<Left\>\""}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "local", " ", "background", " ", "interpolation", " ", "and", " ", 
    "plotting", " ", "functions"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interpolateDeadMutantsPerColumn", "[", 
    RowBox[{
    "mutantList_", ",", "expIndex_", ",", "column_", ",", "datasetIN_", ",", 
     "rateKey_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"selected", ",", "selectedRates", ",", "out", ",", "dataset"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataset", "=", "datasetIN"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selected", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"Values", "[", 
           RowBox[{"dataset", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Apply", "[", 
                  RowBox[{"Or", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"#MutantID", "\[Equal]", 
                    RowBox[{"mutantList", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "1", ",", 
                    RowBox[{"Length", "[", "mutantList", "]"}]}], "}"}]}], 
                    "]"}]}], "]"}], ")"}], "&&", 
                RowBox[{"#ExpIndex", "\[Equal]", "expIndex"}], "&&", 
                RowBox[{
                 RowBox[{"#Indices", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "column"}]}], 
               " ", "&"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Indices\>\"", ",", "rateKey", ",", "\"\<MutantID\>\""}], 
              "}"}]}], "]"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "<", 
           RowBox[{"#2", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"selectedRates", "=", 
       RowBox[{"selected", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"out", "=", "selectedRates"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"selectedRates", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], ",", 
         "out", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"out", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"column", ",", "1"}], "}"}], ",", " ", 
             RowBox[{"selectedRates", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"selectedRates", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], ",", "56"}], 
          "]"}], ",", "out", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"out", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"column", ",", "56"}], "}"}], ",", " ", 
             RowBox[{"selectedRates", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", " ", "2"}], "]"}], "]"}]}], "}"}]}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"Length", "[", "out", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", " ", "56", ",", " ", "1"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"calculateLocalBGRatio", "[", 
    RowBox[{
    "chamber_", ",", "expIndex_", ",", "interpolation_", ",", "datasetIN_", 
     ",", "rateKey_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "column", ",", "measuredChamberRate", ",", "dataset", ",", 
       "backgroundRate"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataset", "=", "datasetIN"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"measuredChamberRate", "=", 
       RowBox[{
        RowBox[{"Values", "[", 
         RowBox[{"Normal", "[", 
          RowBox[{"dataset", "[", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#Indices", "\[Equal]", "chamber"}], "&&", 
               RowBox[{"#ExpIndex", "\[Equal]", "expIndex"}]}], "&"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Indices\>\"", ",", "rateKey", ",", "\"\<MutantID\>\""}], 
             "}"}]}], "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"backgroundRate", "=", 
       RowBox[{"interpolation", "[", 
        RowBox[{"[", 
         RowBox[{"chamber", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"measuredChamberRate", "/", "backgroundRate"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"generateLocalBGPlot", "[", 
     RowBox[{
     "chamber_", ",", "expIndex_", ",", "interpolation_", ",", 
      "boundingMutants_", ",", "datasetIN_", ",", "rateKey_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "allinColumn", ",", "column", ",", "row", ",", "dataset", ",", 
        "upperBound", ",", "lowerBound"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "upper", " ", "and", " ", "lower", " ", "bounds", " ", "are", " ", 
         "dynamic", " ", "range", " ", "limits"}], ",", " ", 
        RowBox[{
        "often", " ", "set", " ", "by", " ", "wtMedian", " ", "and", " ", 
         "T79Smedian", " ", 
         RowBox[{"(", 
          RowBox[{
          "culling", " ", "for", " ", "chambers", " ", "with", " ", 
           "expression"}], ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dataset", "=", "datasetIN"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"column", "=", 
        RowBox[{"chamber", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"row", "=", 
        RowBox[{"chamber", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"upperBound", "=", 
        RowBox[{
         RowBox[{"Mean", "[", 
          RowBox[{"Values", "[", 
           RowBox[{"Normal", "[", 
            RowBox[{"dataset", "[", 
             RowBox[{
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#MutantID", "\[Equal]", 
                  RowBox[{"boundingMutants", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
                 RowBox[{"#ExpIndex", "\[Equal]", "expIndex"}], "&&", 
                 RowBox[{"#eGFPSummedI", ">", 
                  RowBox[{"0.5", "*", "eGFPslope"}]}]}], "&"}], "]"}], ",", 
              RowBox[{"{", "rateKey", "}"}]}], "]"}], "]"}], "]"}], "]"}], 
         "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"lowerBound", "=", 
        RowBox[{
         RowBox[{"Mean", "[", 
          RowBox[{"Values", "[", 
           RowBox[{"Normal", "[", 
            RowBox[{"dataset", "[", 
             RowBox[{
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#MutantID", "\[Equal]", 
                  RowBox[{"boundingMutants", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
                 RowBox[{"#ExpIndex", "\[Equal]", "expIndex"}], "&&", 
                 RowBox[{"#eGFPSummedI", ">", 
                  RowBox[{"0.5", "*", "eGFPslope"}]}]}], "&"}], "]"}], ",", 
              RowBox[{"{", "rateKey", "}"}]}], "]"}], "]"}], "]"}], "]"}], 
         "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"allinColumn", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Values", "[", 
           RowBox[{"Normal", "[", 
            RowBox[{"dataset", "[", 
             RowBox[{
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#Indices", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "column"}], "&&", 
                 RowBox[{"#ExpIndex", "\[Equal]", "expIndex"}]}], "&"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Indices\>\"", ",", "rateKey", ",", "\"\<MutantID\>\""}], 
               "}"}]}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "<", 
            RowBox[{"#2", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListLogPlot", "[", 
          RowBox[{"interpolation", ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Dashed", ",", "Black"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "56"}], "}"}], ",", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"10", "^", 
                 RowBox[{"-", "5"}]}], ",", " ", 
                RowBox[{"10", "^", "0"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"FontSize", "\[Rule]", "12"}], ",", " ", "Black"}], 
             "]"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"FrameStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "0.002", "]"}], ",", "Black", ",", 
              RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<Y Index\>\"", ",", "\"\<Rate (\[Micro]M/s)\>\""}], 
             "}"}]}], ",", 
           RowBox[{"PlotMarkers", "\[Rule]", "None"}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"None", ",", 
              RowBox[{"{", 
               RowBox[{"upperBound", ",", " ", "lowerBound"}], "}"}]}], 
             "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "0.5"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ListLogPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Callout", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"allinColumn", "[", 
                 RowBox[{"[", 
                  RowBox[{"row", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"allinColumn", "[", 
                 RowBox[{"[", 
                  RowBox[{"row", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"allinColumn", "[", 
               RowBox[{"[", 
                RowBox[{"row", ",", "3"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"allinColumn", "[", 
                 RowBox[{"[", 
                  RowBox[{"row", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
                "0.01"}], "}"}]}], "]"}], "}"}], ",", 
           RowBox[{"PlotMarkers", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Green", ",", " ", "4"}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ListLogPlot", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"allinColumn", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"allinColumn", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1", ",", "56"}], "}"}]}], "]"}], ",", 
           RowBox[{"PlotMarkers", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Green", ",", " ", "4"}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"generateLocalBGPlot", "[", 
    RowBox[{"chamber_", ",", "expIndex_", ",", "interpolation_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"column", ",", "row"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"column", "=", 
       RowBox[{"chamber", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"row", "=", 
       RowBox[{"chamber", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListLogPlot", "[", 
         RowBox[{"interpolation", ",", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Dashed", ",", "Black"}], "]"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "56"}], "}"}], ",", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"10", "^", 
                RowBox[{"-", "5"}]}], ",", " ", 
               RowBox[{"10", "^", "0"}]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"FontSize", "\[Rule]", "12"}], ",", " ", "Black"}], 
            "]"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.002", "]"}], ",", "Black", ",", 
             RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Y Index\>\"", ",", "\"\<Rate (\[Micro]M/s)\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", "None"}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{"{", 
              RowBox[{"upperBound", ",", " ", "lowerBound"}], "}"}]}], 
            "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "0.5"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ListLogPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Callout", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"allinColumn", "[", 
                RowBox[{"[", 
                 RowBox[{"column", ",", "row", ",", "1", ",", "2"}], "]"}], 
                "]"}], ",", 
               RowBox[{"allinColumn", "[", 
                RowBox[{"[", 
                 RowBox[{"column", ",", "row", ",", "2"}], "]"}], "]"}]}], 
              "}"}], ",", 
             RowBox[{"allinColumn", "[", 
              RowBox[{"[", 
               RowBox[{"column", ",", "row", ",", "3"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"allinColumn", "[", 
                RowBox[{"[", 
                 RowBox[{"column", ",", "row", ",", "1", ",", "2"}], "]"}], 
                "]"}], ",", "0.01"}], "}"}]}], "]"}], "}"}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Green", ",", " ", "4"}], "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ListLogPlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"allinColumn", "[", 
               RowBox[{"[", 
                RowBox[{"column", ",", "n", ",", "1", ",", "2"}], "]"}], 
               "]"}], ",", 
              RowBox[{"allinColumn", "[", 
               RowBox[{"[", 
                RowBox[{"column", ",", "n", ",", "2"}], "]"}], "]"}]}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", "56"}], "}"}]}], "]"}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Green", ",", " ", "4"}], "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getGFPImage", "[", 
    RowBox[{
    "mutantIN_", ",", "xindex_", ",", "yindex_", ",", "scalingFactor_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "mutant", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mutant", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"mutantIN", ",", 
         RowBox[{"\"\</\>\"", "\[Rule]", "\"\<_\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ImageResize", "[", 
       RowBox[{
        RowBox[{"Image", "[", 
         RowBox[{
          RowBox[{"ImageData", "[", 
           RowBox[{"Import", "[", 
            RowBox[{"StringJoin", "[", 
             RowBox[{
             "repoPath", ",", "mutant", ",", "\"\</\>\"", ",", "\"\<(\>\"", 
              ",", 
              RowBox[{"ToString", "[", "xindex", "]"}], ",", "\"\<, \>\"", 
              ",", 
              RowBox[{"ToString", "[", "yindex", "]"}], ",", "\"\<)/\>\"", 
              ",", "deviceID", ",", "\"\<_eGFP_500ms_ButtonQuant/\>\"", ",", 
              "\"\<(\>\"", ",", 
              RowBox[{"ToString", "[", "xindex", "]"}], ",", "\"\<, \>\"", 
              ",", 
              RowBox[{"ToString", "[", "yindex", "]"}], ",", "\"\<)_\>\"", 
              ",", "mutant", ",", "\"\<.png\>\""}], "]"}], "]"}], "]"}], "*", 
          "scalingFactor"}], "]"}], ",", "75"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeGrid", "[", 
    RowBox[{"datasetIN_", ",", "indices_", ",", "assayType_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grouped", ",", "progresscurves"}], "}"}], ",", 
     RowBox[{
      RowBox[{"grouped", "=", 
       RowBox[{"datasetIN", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"#Indices", "\[Equal]", "indices"}], "&"}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"progresscurves", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"grouped", "[", 
         RowBox[{"All", ",", "\"\<ProgressCurveOptFit\>\""}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"grouped", "[", 
              RowBox[{"1", ",", "\"\<eGFPPostSDSImage\>\""}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Mutant\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Substrate\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Chamber\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<\!\(\*SubsuperscriptBox[\(k\), \(cat\), \(Michaelis - \
Menten\)]\) (\!\(\*SuperscriptBox[\(s\), \(-1\)]\))\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<\!\(\*SubsuperscriptBox[\(K\), \(M\), \(Michaelis - Menten\
\)]\) (uM)\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<\!\(\*SubscriptBox[\(k\), \
\(cat\)]\)/\!\(\*SubsuperscriptBox[\(K\), \(M\), \(Michaelis - Menten\)]\) \
(\!\(\*SuperscriptBox[\(M\), \(-1\)]\) \!\(\*SuperscriptBox[\(s\), \(-1\)]\))\
\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<\!\(\*SubscriptBox[\(k\), \
\(cat\)]\)/\!\(\*SubsuperscriptBox[\(K\), \(M\), \(Linear\)]\) \
(\!\(\*SuperscriptBox[\(M\), \(-1\)]\) \!\(\*SuperscriptBox[\(s\), \(-1\)]\))\
\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<\!\(\*SubscriptBox[\(K\), \(I\)]\) (uM)\>\"", ",", "Bold", 
               ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<LocalBGRatios\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<\!\(\*SuperscriptBox[\(R\), \(2\)]\)\>\"", ",", "Bold", 
               ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<[E]\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<eGFP Intensity\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}], 
            "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"SpanFromAbove", ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"grouped", "[", 
                RowBox[{"1", ",", "\"\<MutantID\>\""}], "]"}], ",", "Bold", 
               ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{"assayType", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"grouped", "[", 
                 RowBox[{"1", ",", "\"\<Indices\>\""}], "]"}], "]"}], ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"grouped", "[", 
                 RowBox[{"1", ",", "\"\<fit_mmscaled-optlin_kcatMMfit\>\""}], 
                 "]"}], "]"}], ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"assayType", "!=", "\"\<Inhibition\>\""}], ",", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"grouped", "[", 
                  RowBox[{"1", ",", "\"\<fit_mmscaled-optlin_KM\>\""}], "]"}],
                  ",", "Bold", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
               ",", "\"\<NaN\>\""}], "]"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"grouped", "[", 
                 RowBox[{"1", ",", "\"\<fit_mmscaled-optlin_kcatMMfit\>\""}], 
                 "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Normal", "[", 
                   RowBox[{"grouped", "[", 
                    RowBox[{"1", ",", "\"\<fit_mmscaled-optlin_KM\>\""}], 
                    "]"}], "]"}], " ", 
                  RowBox[{"10", "^", 
                   RowBox[{"-", "6"}]}]}], ")"}]}], ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Normal", "[", 
              RowBox[{
               RowBox[{"grouped", "[", 
                RowBox[{"1", ",", "\"\<fit_mmscaled-optlin_lin_slope\>\""}], 
                "]"}], "*", 
               RowBox[{"10", "^", "6.0"}]}], "]"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"assayType", "\[Equal]", "\"\<cMUP\>\""}], "||", 
                RowBox[{"assayType", "\[Equal]", "\"\<MecMUP\>\""}], "||", 
                RowBox[{"assayType", "\[Equal]", "\"\<MeP\>\""}]}], ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<NaN\>\"", ",", "Bold", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
               ",", 
               RowBox[{"assayType", "\[Equal]", "\"\<Inhibition\>\""}], ",", 
               RowBox[{"Style", "[", 
                RowBox[{"grouped", "[", 
                 RowBox[{
                 "1", ",", "\"\<KiInhibitionFit Opt. PerPointScaled\>\""}], 
                 "]"}], "]"}], ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"grouped", "[", 
                   RowBox[{"1", ",", "\"\<LocalBackgroundRatio\>\""}], "]"}], 
                  "]"}], ",", "\"\<\\n\>\"", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"grouped", "[", 
                   RowBox[{
                    RowBox[{"Length", "[", "grouped", "]"}], ",", 
                    "\"\<LocalBackgroundRatio\>\""}], "]"}], "]"}]}], "]"}], 
               ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"Normal", "[", 
                 RowBox[{"grouped", "[", 
                  RowBox[{"1", ",", "\"\<fit_mmscaled-optlin_curved_r2\>\""}],
                   "]"}], "]"}], "]"}], ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Normal", "[", 
                 RowBox[{"grouped", "[", 
                  RowBox[{"1", ",", "\"\<eGFPSummedI\>\""}], "]"}], "]"}], 
                "/", 
                RowBox[{"Normal", "[", 
                 RowBox[{"grouped", "[", 
                  RowBox[{"1", ",", "\"\<eGFPSlope\>\""}], "]"}], "]"}]}], 
               ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"grouped", "[", 
                 RowBox[{"1", ",", "\"\<eGFPSummedI\>\""}], "]"}], "]"}], ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}], 
            "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"TableForm", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Show", "[", 
                 RowBox[{
                  RowBox[{"grouped", "[", 
                   RowBox[{
                   "1", ",", "\"\<fit_mmscaled-optlin_curved_plot\>\""}], 
                   "]"}], ",", 
                  RowBox[{
                  "PlotLabel", "\[Rule]", 
                   "\"\<\!\(\*SubscriptBox[\(k\), \
\(cat\)]\)/\!\(\*SubsuperscriptBox[\(K\), \(M\), \(Michaelis - Menten\)]\) \
Fit\>\""}], ",", 
                  RowBox[{"PlotRange", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "All"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}]}], "]"}], ",", 
                RowBox[{"Normal", "[", 
                 RowBox[{"grouped", "[", 
                  RowBox[{"1", ",", "\"\<eGFPIntensityPlot\>\""}], "]"}], 
                 "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"assayType", "==", "\"\<MeP\>\""}], ",", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"Normal", "[", 
                    RowBox[{"grouped", "[", 
                    RowBox[{"1", ",", "\"\<IsothermFit\>\""}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<[Pi] (uM)\>\"", ",", "\"\<Intensity\>\""}], 
                    "}"}]}]}], "]"}], ",", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"Normal", "[", 
                    RowBox[{"grouped", "[", 
                    RowBox[{"1", ",", "\"\<StandardCurvePlot\>\""}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"Epilog", "\[Rule]", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<\!\(\*SuperscriptBox[\(R\), \(2\)]\)\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"Normal", "[", 
                    RowBox[{"grouped", "[", 
                    RowBox[{"1", ",", "\"\<StdCurveRSquared\>\""}], "]"}], 
                    "]"}], "]"}]}], ",", "12"}], "]"}], ",", 
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.8", ",", "0.25"}], "}"}], "]"}]}], "]"}]}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"Normal", "[", 
                 RowBox[{"grouped", "[", 
                  RowBox[{
                   RowBox[{"Length", "[", "grouped", "]"}], ",", 
                   "\"\<MaxLocalBackgroundPlot\>\""}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", "SpanFromLeft", ",", 
             RowBox[{"TableForm", "[", 
              RowBox[{"Partition", "[", 
               RowBox[{
                RowBox[{"PadRight", "[", 
                 RowBox[{"progresscurves", ",", 
                  RowBox[{
                   RowBox[{"Ceiling", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "progresscurves", "]"}], "/", 
                    "2"}], "]"}], "*", "2"}], ",", "\"\<\>\""}], "]"}], ",", 
                "2"}], "]"}], "]"}], ",", "SpanFromLeft"}], "}"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}], ",", 
        RowBox[{"Spacings", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], ",", 
        RowBox[{"Alignment", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Center", ",", "Top"}], "}"}]}], ",", 
        RowBox[{"ItemSize", "\[Rule]", "Full"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"safeExport", "[", 
    RowBox[{"file_String", ",", "args___"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
     "ChoiceDialog", "[", "\"\<Is export filename correct?\>\"", "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FileExistsQ", "[", "file", "]"}]}], "||", 
        RowBox[{
        "ChoiceDialog", "[", "\"\<File already exists. Overwrite?\>\"", 
         "]"}]}], ",", 
       RowBox[{"Export", "[", 
        RowBox[{"file", ",", "args"}], "]"}], ",", "$Failed"}], "]"}], ",", 
     "$Failed"}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"generateLocalBGMMPlot", "[", 
   RowBox[{"chamber_", ",", "datasetIN_", ",", "rateKey_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "column", ",", "measuredChamberRate", ",", "dataset", ",", 
      "backgroundRates"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dataset", "=", "datasetIN"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"measuredChamberRate", "=", 
      RowBox[{
       RowBox[{"Values", "[", 
        RowBox[{"Normal", "[", 
         RowBox[{"dataset", "[", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"#Indices", "\[Equal]", "chamber"}], "&"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Indices\>\"", ",", "rateKey", ",", "\"\<MutantID\>\"", ",", 
             "\"\<SubstrateConc\>\"", ",", "\"\<Interpolation\>\"", ",", 
             "\"\<eGFPSummedI\>\"", ",", "\"\<eGFPSlope\>\""}], "}"}]}], 
          "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"backgroundRates", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"measuredChamberRate", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"measuredChamberRate", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "2", ",", 
              RowBox[{"chamber", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"measuredChamberRate", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3"}], "]"}], "]"}], "/", 
               RowBox[{"measuredChamberRate", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "4"}], "]"}], "]"}]}], ")"}], "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "3"}]}]}], ")"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "measuredChamberRate", "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"backgroundRates", ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "12"}], "]"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"PointSize", "[", "0.025", "]"}], ",", 
           RowBox[{"GrayLevel", "[", "0.5", "]"}]}], "]"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<[S] (\[Mu]M)\>\"", ",", 
           "\"\<BG Rate/[E] (\!\(\*SuperscriptBox[\(s\), \(-1\)]\))\>\""}], 
          "}"}]}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", "50"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.732734519313447*^9, 3.7327345196081133`*^9}, 
   3.7327347490239773`*^9, {3.732816795354333*^9, 3.732816923862208*^9}, {
   3.732817108610519*^9, 3.732817133925861*^9}, {3.732817916793426*^9, 
   3.732817917236841*^9}, {3.732817957911532*^9, 3.732817968559558*^9}, {
   3.732818744915225*^9, 3.732818778441243*^9}, {3.732819682017524*^9, 
   3.732819682703261*^9}, {3.732819713850809*^9, 3.7328197494685926`*^9}, {
   3.7328199689110518`*^9, 3.7328199978194027`*^9}, {3.732820032345057*^9, 
   3.7328200450938473`*^9}, 3.732820247429782*^9, {3.732821310369616*^9, 
   3.732821379044612*^9}, {3.732821427444298*^9, 3.732821443586916*^9}, {
   3.7328214959574966`*^9, 3.7328215665296383`*^9}, {3.7328217499603777`*^9, 
   3.732821769973604*^9}, {3.732821889876337*^9, 3.732821893708391*^9}, {
   3.732827678461425*^9, 3.732827996439777*^9}, {3.732828030379079*^9, 
   3.732828058610034*^9}, {3.7328282995683603`*^9, 3.732828299713214*^9}, {
   3.732828374802285*^9, 3.732828376060054*^9}, {3.732828408738184*^9, 
   3.73282841095273*^9}, {3.732828465926602*^9, 3.7328284711041307`*^9}, {
   3.732828696137602*^9, 3.732828719001034*^9}, {3.732829078498312*^9, 
   3.732829079084334*^9}, {3.7328291248049*^9, 3.732829220794536*^9}, {
   3.732829320938328*^9, 3.732829322684307*^9}, {3.732830061758718*^9, 
   3.732830085241437*^9}, {3.7328301205055437`*^9, 3.732830204045191*^9}, {
   3.7328304884940767`*^9, 3.7328305373073177`*^9}, {3.732830638817354*^9, 
   3.732830642442947*^9}, {3.732830685052309*^9, 3.732830712525044*^9}, {
   3.732830757872312*^9, 3.732830758866479*^9}, {3.732831049085156*^9, 
   3.732831051305684*^9}, {3.732831509171523*^9, 3.7328315235149117`*^9}, {
   3.732831560308303*^9, 3.732831562269196*^9}, {3.732832612641382*^9, 
   3.73283263889312*^9}, {3.7328327357011423`*^9, 3.732832777578816*^9}, {
   3.73283292059835*^9, 3.732832926404221*^9}, {3.732832989877523*^9, 
   3.73283301795411*^9}, {3.732833051028429*^9, 3.732833139644775*^9}, {
   3.732833277925747*^9, 3.732833288796887*^9}, 3.7328333349390173`*^9, {
   3.732833384496855*^9, 3.732833392030738*^9}, {3.7328338927022047`*^9, 
   3.732833894829845*^9}, {3.732900899557596*^9, 3.732900935441663*^9}, {
   3.732901367394619*^9, 3.732901377706794*^9}, {3.732901769517828*^9, 
   3.732901787255741*^9}, {3.73290307923744*^9, 3.732903176329398*^9}, {
   3.732903345221506*^9, 3.732903354967257*^9}, {3.732904174108536*^9, 
   3.732904184487029*^9}, {3.7329105287055597`*^9, 3.732910556222013*^9}, {
   3.7329113090682173`*^9, 3.732911346832547*^9}, {3.732914079585999*^9, 
   3.732914105962956*^9}, {3.732974145736065*^9, 3.732974173173771*^9}, {
   3.7329742242867613`*^9, 3.7329742410056467`*^9}, 3.732974278238517*^9, {
   3.7329743497072287`*^9, 3.7329743986938963`*^9}, {3.732975280109962*^9, 
   3.732975340732807*^9}, {3.732975443996851*^9, 3.732975511175679*^9}, {
   3.732975617720545*^9, 3.732975618960536*^9}, {3.7329757659111834`*^9, 
   3.732975826450919*^9}, {3.732976127826898*^9, 3.7329761905475597`*^9}, {
   3.732976408778714*^9, 3.7329764135262747`*^9}, {3.7329764781054497`*^9, 
   3.732976490556306*^9}, {3.732976594358453*^9, 3.732976601351533*^9}, {
   3.7329781807604094`*^9, 3.732978186385721*^9}, {3.732978289620611*^9, 
   3.732978308233391*^9}, {3.7329785000837708`*^9, 3.7329785060958977`*^9}, {
   3.732978571732277*^9, 3.732978575159197*^9}, {3.732978744166198*^9, 
   3.732978769075718*^9}, {3.732978805708539*^9, 3.732978866854314*^9}, {
   3.732986234380019*^9, 3.732986235630916*^9}, {3.732986269887087*^9, 
   3.732986315845764*^9}, 3.732986440197185*^9, {3.7329864717463923`*^9, 
   3.732986509294257*^9}, {3.732986778419056*^9, 3.732986812471532*^9}, {
   3.7329868575940723`*^9, 3.73298686237047*^9}, {3.732986936813566*^9, 
   3.732987015889592*^9}, {3.732987641441877*^9, 3.732987672151244*^9}, {
   3.732988314755776*^9, 3.732988407359716*^9}, {3.732992851563038*^9, 
   3.7329928592062187`*^9}, {3.732994063423956*^9, 3.732994117559099*^9}, {
   3.732994570266694*^9, 3.732994583163463*^9}, {3.73299469377363*^9, 
   3.732994699210587*^9}, {3.7329947394190063`*^9, 3.732994742874988*^9}, {
   3.733071262016165*^9, 3.733071270157156*^9}, {3.7330714850743847`*^9, 
   3.733071563833626*^9}, {3.7330734622294397`*^9, 3.7330735186273727`*^9}, {
   3.733073729282876*^9, 3.7330737608412848`*^9}, 3.733169206923683*^9, {
   3.7335233088329144`*^9, 3.733523309426903*^9}, {3.73352362789248*^9, 
   3.73352362856034*^9}, {3.733524795761491*^9, 3.733524796121278*^9}, {
   3.7335252140619802`*^9, 3.7335252217079678`*^9}, {3.733525584267128*^9, 
   3.733525681772966*^9}, 3.733526171688204*^9, 3.733526304008156*^9, 
   3.733526463370901*^9, {3.733527091076243*^9, 3.733527097641474*^9}, {
   3.733539934823739*^9, 3.7335399773576317`*^9}, {3.7335400413774433`*^9, 
   3.7335400697682943`*^9}, {3.733580032045431*^9, 3.733580121628709*^9}, 
   3.733580153452415*^9, {3.7335813405652227`*^9, 3.733581437247617*^9}, {
   3.733581682438512*^9, 3.733581686342469*^9}, {3.733581720503249*^9, 
   3.73358173786865*^9}, {3.733581804197515*^9, 3.7335818287569036`*^9}, {
   3.733581859794587*^9, 3.733581884356617*^9}, {3.733581927633657*^9, 
   3.733581930226996*^9}, {3.733581969823296*^9, 3.733582054015933*^9}, {
   3.733582639515339*^9, 3.733582641572007*^9}, {3.733582684276441*^9, 
   3.733582750335287*^9}, {3.733582785567206*^9, 3.73358287435598*^9}, {
   3.733584600930997*^9, 3.733584607194882*^9}, {3.733584714054255*^9, 
   3.733584716356299*^9}, {3.73358506776369*^9, 3.733585092481868*^9}, 
   3.733585448128916*^9, 3.733585497874857*^9, {3.7335855472924137`*^9, 
   3.733585577019393*^9}, {3.7335857627448883`*^9, 3.733585800406435*^9}, {
   3.7335860334726133`*^9, 3.7335861079667664`*^9}, {3.733586175079207*^9, 
   3.733586188616827*^9}, {3.733586244151793*^9, 3.73358626744171*^9}, {
   3.733586550540979*^9, 3.7335866068478203`*^9}, {3.7335866390357103`*^9, 
   3.733586664931033*^9}, {3.733586714172065*^9, 3.7335868153162823`*^9}, {
   3.733586974376109*^9, 3.733586974627686*^9}, 3.733588072743037*^9, {
   3.7336019045417213`*^9, 3.733601905303759*^9}, {3.7336206136293364`*^9, 
   3.7336206193441687`*^9}, {3.733621024353992*^9, 3.7336210517205133`*^9}, {
   3.733669699076766*^9, 3.733669752368237*^9}, {3.733669783903408*^9, 
   3.733669788953875*^9}, {3.7336699762465467`*^9, 3.733670048856525*^9}, {
   3.7336701335704603`*^9, 3.733670141827681*^9}, {3.733670882390532*^9, 
   3.7336710292956944`*^9}, {3.73367124841921*^9, 3.7336712807891417`*^9}, {
   3.733672555488739*^9, 3.733672586877502*^9}, {3.733672921850686*^9, 
   3.733673008619944*^9}, {3.7336730598959627`*^9, 3.7336730615052643`*^9}, {
   3.7336730938064337`*^9, 3.7336730994558992`*^9}, {3.733675371695413*^9, 
   3.7336754827263823`*^9}, {3.7336761723595953`*^9, 
   3.7336761874767838`*^9}, {3.733676226896441*^9, 3.733676227231368*^9}, 
   3.7336762932643337`*^9, {3.7336764360894136`*^9, 3.733676462987051*^9}, {
   3.733676654228499*^9, 3.733676655555245*^9}, {3.733676781291296*^9, 
   3.733676842221814*^9}, {3.7336770016928387`*^9, 3.7336771667108192`*^9}, 
   3.73367722337584*^9, {3.7336772607324057`*^9, 3.7336772632865057`*^9}, {
   3.733677393485457*^9, 3.733677418702405*^9}, {3.7336774792091703`*^9, 
   3.733677571764861*^9}, 3.733677616369994*^9, {3.733677657216261*^9, 
   3.733677670558032*^9}, {3.733677712087888*^9, 3.733677731217332*^9}, {
   3.7336784185058537`*^9, 3.733678451369204*^9}, {3.733678524648044*^9, 
   3.733678623411716*^9}, {3.733678715300603*^9, 3.7336787485152493`*^9}, {
   3.733678786818431*^9, 3.733678789098339*^9}, {3.733678832306197*^9, 
   3.7336788607933207`*^9}, {3.733688712406824*^9, 3.7336887125394707`*^9}, {
   3.733693090493923*^9, 3.733693097169958*^9}, {3.733693139136533*^9, 
   3.733693161138483*^9}, {3.733697474970674*^9, 3.733697565740472*^9}, {
   3.7336976485036077`*^9, 3.7336977247546387`*^9}, {3.73369775477815*^9, 
   3.733697858983171*^9}, 3.733698752852519*^9, {3.733711919122966*^9, 
   3.733712033602973*^9}, {3.733712142476025*^9, 3.73371215601793*^9}, {
   3.733712194644359*^9, 3.733712205317951*^9}, {3.733712410242655*^9, 
   3.7337124226400337`*^9}, {3.733840091140026*^9, 3.733840195195918*^9}, {
   3.733840237752372*^9, 3.733840250250374*^9}, {3.733840319598802*^9, 
   3.7338403582445498`*^9}, {3.733840397392871*^9, 3.7338404552781687`*^9}, {
   3.733840688229357*^9, 3.733840723278563*^9}, {3.73384079132439*^9, 
   3.733840791488686*^9}, {3.733840953527513*^9, 3.7338409689735107`*^9}, {
   3.7338410020657663`*^9, 3.733841071497875*^9}, {3.733841291839361*^9, 
   3.733841487710513*^9}, {3.733841560770466*^9, 3.733841562278227*^9}, {
   3.733842253577468*^9, 3.733842326858755*^9}, {3.733842373993767*^9, 
   3.733842403221422*^9}, {3.733852719154397*^9, 3.733852719855132*^9}, {
   3.733852852385244*^9, 3.733852869757676*^9}, {3.733854210801893*^9, 
   3.7338542758856897`*^9}, {3.733854359455984*^9, 3.7338543664343452`*^9}, 
   3.7338558767417173`*^9, {3.733855936522031*^9, 3.733856049895083*^9}, {
   3.733856081016286*^9, 3.733856145772255*^9}, 3.733857969472001*^9, {
   3.7338580539832287`*^9, 3.733858127782983*^9}, {3.7338581725775337`*^9, 
   3.733858304114077*^9}, {3.733858341065535*^9, 3.733858545854528*^9}, {
   3.73385903349981*^9, 3.733859036715982*^9}, {3.733877074842589*^9, 
   3.733877076248534*^9}, {3.7338771885352*^9, 3.733877192595757*^9}, {
   3.733877229237485*^9, 3.733877232295741*^9}, {3.7338776420395*^9, 
   3.733877661547361*^9}, {3.733877739334601*^9, 3.7338777402666063`*^9}, {
   3.733879387042007*^9, 3.733879414348316*^9}, {3.7339672498584433`*^9, 
   3.7339673046655493`*^9}, {3.73402356371062*^9, 3.73402356770019*^9}, {
   3.734023708136651*^9, 3.734023710750595*^9}, {3.7340238903443203`*^9, 
   3.7340238935148287`*^9}, {3.734024110417019*^9, 3.734024110752839*^9}, {
   3.7340245036924*^9, 3.734024711147957*^9}, {3.734030229005494*^9, 
   3.734030406068544*^9}, {3.734030442620573*^9, 3.734030456662874*^9}, {
   3.734030657291059*^9, 3.73403068034512*^9}, {3.734030882338685*^9, 
   3.734030886987094*^9}, {3.734031150862287*^9, 3.734031154991104*^9}, {
   3.734031189116404*^9, 3.734031196749164*^9}, {3.734031231800437*^9, 
   3.734031234085478*^9}, {3.7340313002582827`*^9, 3.734031306409092*^9}, {
   3.73403134806138*^9, 3.734031370079598*^9}, {3.734031443006906*^9, 
   3.73403146240981*^9}, {3.734031514290284*^9, 3.734031527778647*^9}, {
   3.734031618394594*^9, 3.73403162197003*^9}, {3.734031665887533*^9, 
   3.734031699044362*^9}, {3.734031740216502*^9, 3.734031786584784*^9}, {
   3.7340318240303926`*^9, 3.734031899010791*^9}, {3.7340329575265427`*^9, 
   3.734032968224812*^9}, {3.734033063800127*^9, 3.7340330673321953`*^9}, {
   3.734033114111987*^9, 3.734033158882132*^9}, {3.734033199067768*^9, 
   3.734033254847139*^9}, {3.734035004771326*^9, 3.734035048476191*^9}, {
   3.734035291331463*^9, 3.734035314116694*^9}, {3.734037345464484*^9, 
   3.734037435681094*^9}, {3.734037466606188*^9, 3.734037498229741*^9}, {
   3.734037557017335*^9, 3.734037558733577*^9}, {3.7340376222451277`*^9, 
   3.734037646054015*^9}, {3.734037694865665*^9, 3.734037728186798*^9}, 
   3.734037794450131*^9, {3.73403783023135*^9, 3.734037869263329*^9}, {
   3.734038097448037*^9, 3.734038105047957*^9}, {3.734038164043486*^9, 
   3.734038176019947*^9}, {3.734038464593*^9, 3.734038464972134*^9}, {
   3.73403850113256*^9, 3.734038537190089*^9}, {3.734038572244535*^9, 
   3.7340386489158983`*^9}, {3.7340387961618757`*^9, 3.734038861783283*^9}, {
   3.734038910402994*^9, 3.734038913425106*^9}, {3.7340391341577177`*^9, 
   3.7340391347845287`*^9}, {3.7340391747633533`*^9, 3.734039174922222*^9}, {
   3.734039271544156*^9, 3.7340393041820583`*^9}, {3.734039396109185*^9, 
   3.7340393965435867`*^9}, {3.7340394299324493`*^9, 3.734039430269527*^9}, {
   3.734056471256012*^9, 3.734056482887496*^9}, {3.734108907826023*^9, 
   3.7341089227366734`*^9}, {3.73413962721021*^9, 3.734139628347063*^9}, {
   3.734139698531764*^9, 3.734139744891881*^9}, {3.7341399261448793`*^9, 
   3.7341400191751547`*^9}, {3.734140118004689*^9, 3.734140121513126*^9}, {
   3.734140632137581*^9, 3.734140632713992*^9}, {3.734140903494321*^9, 
   3.73414090741297*^9}, {3.734140949191661*^9, 3.734141003867133*^9}, {
   3.734147348669187*^9, 3.734147355569417*^9}, {3.734147391867716*^9, 
   3.734147400977798*^9}, {3.734147443110043*^9, 3.7341474580540237`*^9}, {
   3.734147493527686*^9, 3.734147501496972*^9}, {3.734188446102886*^9, 
   3.734188450724017*^9}, {3.734188576599265*^9, 3.734188582673435*^9}, {
   3.734188622211691*^9, 3.7341886438921843`*^9}, {3.7341886916288843`*^9, 
   3.734188710253643*^9}, {3.7341893542820044`*^9, 3.734189355315675*^9}, {
   3.734210636503215*^9, 3.734210741856217*^9}, {3.734210969450945*^9, 
   3.7342110210210752`*^9}, {3.734211079707856*^9, 3.734211157430358*^9}, {
   3.734214225623418*^9, 3.7342142405478897`*^9}, {3.734214294908456*^9, 
   3.734214298283016*^9}, {3.7342143654675837`*^9, 3.734214365686014*^9}, {
   3.7342153449348373`*^9, 3.734215351088167*^9}, {3.7342154277597218`*^9, 
   3.7342154545046883`*^9}, {3.734215664995411*^9, 3.734215682294071*^9}, {
   3.734215747184712*^9, 3.734215748385208*^9}, {3.7342157952308817`*^9, 
   3.734215795535522*^9}, {3.734274435732127*^9, 3.73427448218687*^9}, {
   3.7342745406714087`*^9, 3.734274556427906*^9}, {3.734274990625436*^9, 
   3.734274991783163*^9}, {3.734276215609601*^9, 3.734276234499785*^9}, {
   3.734276364515594*^9, 3.7342763768166*^9}, {3.734276409839817*^9, 
   3.734276426324629*^9}, {3.7342820287414427`*^9, 3.734282058805512*^9}, {
   3.734282114732484*^9, 3.734282119865986*^9}, {3.734282182240958*^9, 
   3.7342822553612833`*^9}, {3.734283319508627*^9, 3.7342833309648952`*^9}, {
   3.734286856145506*^9, 3.734286874439314*^9}, {3.734288919988215*^9, 
   3.7342889384716883`*^9}, {3.734289081477953*^9, 3.734289083528413*^9}, {
   3.734289135010078*^9, 3.7342891444539013`*^9}, {3.734293095771418*^9, 
   3.7342931273060904`*^9}, {3.734530010413245*^9, 3.734530027482436*^9}, 
   3.734892518207178*^9, {3.734969161037169*^9, 3.734969161633851*^9}, {
   3.734972772092067*^9, 3.734972772580101*^9}, {3.734973117358954*^9, 
   3.734973117773056*^9}, {3.7349749078387423`*^9, 3.7349749211932507`*^9}, {
   3.734975908092991*^9, 3.73497591316818*^9}, {3.7349760112254477`*^9, 
   3.734976011778899*^9}, {3.73497619988389*^9, 3.73497620397626*^9}, {
   3.734976523392186*^9, 3.734976523565981*^9}, 3.7350630215811996`*^9, {
   3.735239982723688*^9, 3.735240021703841*^9}, {3.7352535564937897`*^9, 
   3.735253569134162*^9}, {3.735253628404776*^9, 3.735253672342433*^9}, {
   3.737570471338642*^9, 3.7375704755693617`*^9}, {3.737570525194326*^9, 
   3.737570548665976*^9}, {3.737570683139051*^9, 3.737570685774927*^9}, {
   3.737570716961128*^9, 3.737570721101488*^9}, {3.737571442244533*^9, 
   3.7375714475913153`*^9}, {3.737571598261306*^9, 3.7375716245116*^9}, {
   3.737571655561507*^9, 3.7375716770568237`*^9}, {3.737571811612252*^9, 
   3.7375718770374804`*^9}, {3.737571922241153*^9, 3.7375719612053823`*^9}, 
   3.7375773779167767`*^9, {3.737577463953577*^9, 3.737577476061975*^9}, {
   3.737577551662818*^9, 3.7375776364112577`*^9}, {3.7376542397741117`*^9, 
   3.73765424079217*^9}, {3.737658264561183*^9, 3.7376582897249117`*^9}, {
   3.737667970068084*^9, 3.737667970493943*^9}, {3.737669244351408*^9, 
   3.7376692476825037`*^9}, 3.737759040610319*^9, {3.7377641368929653`*^9, 
   3.737764138660573*^9}, {3.737769872828918*^9, 3.7377698763578587`*^9}, {
   3.73785412611405*^9, 3.737854176033641*^9}, {3.737916837752796*^9, 
   3.7379168424257936`*^9}, {3.737916875441382*^9, 3.737916896696247*^9}, {
   3.737916992595715*^9, 3.73791713363774*^9}, {3.737917445583084*^9, 
   3.7379174766238413`*^9}, 3.7379175127391243`*^9, {3.7379178466336117`*^9, 
   3.737917930779887*^9}, {3.737918039034185*^9, 3.737918068434218*^9}, {
   3.737918130159965*^9, 3.737918160234638*^9}, {3.737918232900326*^9, 
   3.737918241123665*^9}, {3.737918422693502*^9, 3.737918532926385*^9}, {
   3.7379186125954313`*^9, 3.737918612811882*^9}, {3.737918667754281*^9, 
   3.737918800948429*^9}, {3.737918893719441*^9, 3.7379188938841867`*^9}, {
   3.737937723263713*^9, 3.737937786241351*^9}, {3.737937883837834*^9, 
   3.737937884261117*^9}, {3.7379990144955378`*^9, 3.7379990392878103`*^9}, {
   3.7379995356414013`*^9, 3.737999541219558*^9}, {3.738084818854475*^9, 
   3.738084823213779*^9}, {3.738084923388687*^9, 3.738084925587632*^9}, 
   3.738361069534914*^9, {3.738361360483739*^9, 3.7383613609756117`*^9}, {
   3.738372571096882*^9, 3.738372573898559*^9}, {3.7390359121640787`*^9, 
   3.739035965052684*^9}, {3.739036069027746*^9, 3.7390360860507307`*^9}, {
   3.739148746346395*^9, 3.739148856536462*^9}, {3.7391489080428467`*^9, 
   3.739148951436638*^9}, {3.7391499761112843`*^9, 3.7391499807862167`*^9}, 
   3.7392096860878468`*^9, 3.739225460698892*^9, 3.7392266512209806`*^9, {
   3.7392268510507193`*^9, 3.739226862119904*^9}, {3.739288075673464*^9, 
   3.739288101968483*^9}, {3.7392896798765583`*^9, 3.73928968434632*^9}, {
   3.73928986218896*^9, 3.739289875236154*^9}, {3.739289908158998*^9, 
   3.7392899090340033`*^9}, {3.742224439940547*^9, 3.742224447661696*^9}, {
   3.742224538307603*^9, 3.742224538938814*^9}, {3.742224642844996*^9, 
   3.742224678153907*^9}, {3.742224743443242*^9, 3.74222474409764*^9}, {
   3.742227556604864*^9, 3.742227560854061*^9}, {3.742329152647215*^9, 
   3.7423292545993567`*^9}, {3.742329317158984*^9, 3.742329317512218*^9}, {
   3.74232936315471*^9, 3.742329413405532*^9}, {3.742330091477186*^9, 
   3.7423301042685423`*^9}, {3.742336852880432*^9, 3.742336856384544*^9}, {
   3.742337013544416*^9, 3.742337085116579*^9}, {3.7423377680067263`*^9, 
   3.742337769553334*^9}, {3.742337876377363*^9, 3.742337876815234*^9}, {
   3.742400988101449*^9, 3.742400989564479*^9}, {3.742401158648314*^9, 
   3.7424011607082443`*^9}, {3.7424013317098827`*^9, 3.742401372754129*^9}, {
   3.7424014150421333`*^9, 3.742401443234839*^9}, {3.7424016312033157`*^9, 
   3.7424017051667767`*^9}, {3.7424017477827063`*^9, 3.742401761376645*^9}, {
   3.742403100371982*^9, 3.742403111317441*^9}, {3.742406476261313*^9, 
   3.742406479579471*^9}, {3.742406532190673*^9, 3.742406599621166*^9}, {
   3.742406817412684*^9, 3.7424068825853643`*^9}, {3.7424069876102743`*^9, 
   3.742406989719503*^9}, {3.742407043739781*^9, 3.742407102498275*^9}, {
   3.742407659240632*^9, 3.742407664142395*^9}, {3.742407947966217*^9, 
   3.742408021489871*^9}, {3.7424082205334663`*^9, 3.742408244812108*^9}, {
   3.742484312795879*^9, 3.742484324696354*^9}, {3.742484385121903*^9, 
   3.742484432999587*^9}, {3.7424844901728897`*^9, 3.742484556639249*^9}, {
   3.742484604665175*^9, 3.742484617099135*^9}, {3.742484667011324*^9, 
   3.742484697310604*^9}, {3.7424847315015907`*^9, 3.74248475299867*^9}, {
   3.7424847867794447`*^9, 3.742484813500937*^9}, {3.742488656275077*^9, 
   3.742488689844284*^9}, {3.7424887305171537`*^9, 3.7424887704892673`*^9}, {
   3.742492169142069*^9, 3.742492194518332*^9}, {3.742740706144685*^9, 
   3.742740749298997*^9}, {3.7427461976477003`*^9, 3.7427462810554867`*^9}, {
   3.742746950433608*^9, 3.7427469794935093`*^9}, {3.742747184068451*^9, 
   3.742747184807315*^9}, {3.742748079635243*^9, 3.742748155841671*^9}, {
   3.74274902973811*^9, 3.742749094773481*^9}, {3.742749892565727*^9, 
   3.742749900741918*^9}, {3.742758309411875*^9, 3.742758319191327*^9}, {
   3.742835097584693*^9, 3.742835106789473*^9}, 3.7428420461260023`*^9, {
   3.74291003447348*^9, 3.742910086619381*^9}, {3.742910412364387*^9, 
   3.7429104739789333`*^9}, {3.7429130463392563`*^9, 3.742913097150812*^9}, {
   3.742913132150887*^9, 3.742913149643331*^9}, {3.742918918605036*^9, 
   3.742918937677882*^9}, {3.742927097568115*^9, 3.742927100013342*^9}, 
   3.742927353965307*^9, {3.742927490202506*^9, 3.7429274924390163`*^9}, {
   3.7520041496573887`*^9, 3.75200415100222*^9}, {3.752019112393065*^9, 
   3.752019123450185*^9}, {3.752022888817384*^9, 3.752022902699222*^9}, {
   3.752024309108433*^9, 3.752024309793751*^9}, {3.752028484486722*^9, 
   3.752028485350422*^9}, {3.752028522418043*^9, 3.752028527687737*^9}, {
   3.752028587871409*^9, 3.752028599500024*^9}, {3.752200473982185*^9, 
   3.752200484044595*^9}, {3.752804132365212*^9, 3.7528041394595346`*^9}, {
   3.7528066679477463`*^9, 3.752806669223419*^9}, {3.757558225752104*^9, 
   3.757558229208365*^9}, {3.757558276307562*^9, 3.7575582774104633`*^9}, 
   3.757874030075857*^9, {3.759347447114423*^9, 3.759347464726899*^9}, {
   3.759349276935472*^9, 3.759349277503755*^9}, {3.75934996672112*^9, 
   3.759349977307921*^9}, {3.759350140089383*^9, 3.759350227959701*^9}, {
   3.7593502792305393`*^9, 3.7593502806324997`*^9}, {3.761236387796117*^9, 
   3.761236400629051*^9}, {3.7612379938713827`*^9, 3.761238001277614*^9}, {
   3.761238041590514*^9, 3.7612380532404613`*^9}, {3.761238104083747*^9, 
   3.761238134082617*^9}, {3.7612382055392036`*^9, 3.761238224791182*^9}, 
   3.76123953891201*^9, {3.761240184349931*^9, 3.761240225229135*^9}},
 CellLabel->
  "In[947]:=",ExpressionUUID->"3910e96f-8244-473b-938a-b403469393f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Input", "Section",
 CellChangeTimes->{{3.732732210052601*^9, 3.732732219292498*^9}, {
   3.7331692470144167`*^9, 3.733169248195539*^9}, 3.733169607436493*^9, {
   3.756422191566696*^9, 
   3.756422195562387*^9}},ExpressionUUID->"ba452b1b-3762-41f2-91e4-\
7d42bc0a6dd5"],

Cell[CellGroupData[{

Cell["Experiment and microscope setup parameters:", "Subsubsection",
 CellChangeTimes->{{3.756438166255608*^9, 
  3.756438182277766*^9}},ExpressionUUID->"a1c2ac4d-c70b-4b9a-a35f-\
542c3fe76cda"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"parameters", " ", "for", " ", 
    RowBox[{"calculating", "[", "E", "]"}], " ", "and", " ", "reading", " ", 
    "in", " ", "image", " ", "tiles", " ", "from", " ", "repository"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"deviceID", "=", "\"\<d1\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{"setup", "=", "3"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"expDate", "=", "\"\<180528\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{"experiment", "=", "\"\<PafA_ValScan\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{"substrateType", "=", "\"\<cMUP\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{"replicate", "=", "1"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "parameter", " ", "used", " ", "to", " ", "select", " ", "which", " ", 
     "experiment", " ", "for", " ", "local", " ", "background", " ", 
     "calculation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"whichExpt", "=", "1"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"PO4sensorConc", "=", "0"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "check", " ", "date", " ", "of", " ", "experiment", " ", "in", " ", 
     "case", " ", "processing", " ", "a", " ", "S2", " ", "assay", " ", 
     "using", " ", "original", " ", "eGFP", " ", "slope"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eGFPslope", "=", "100000.0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outName", "=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"expDate", ",", "\"\<_S\>\"", ",", 
       RowBox[{"ToString", "[", "setup", "]"}], ",", "deviceID", ",", 
       "\"\<_\>\"", ",", "experiment"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.734964014733989*^9, 3.734964021925211*^9}, {
   3.734964052418363*^9, 3.734964086857307*^9}, {3.7349676756347847`*^9, 
   3.73496769605987*^9}, 3.7349680340611687`*^9, {3.734976718349825*^9, 
   3.734976718773717*^9}, {3.73506362784694*^9, 3.735063673714023*^9}, {
   3.735238315209505*^9, 3.735238331526716*^9}, {3.735248120428743*^9, 
   3.73524812072314*^9}, {3.7352514600752897`*^9, 3.7352514606503983`*^9}, {
   3.735579593244824*^9, 3.735579623515791*^9}, {3.735579666850457*^9, 
   3.735579669252502*^9}, {3.735585158739811*^9, 3.735585159582024*^9}, {
   3.735585247758215*^9, 3.7355852512740307`*^9}, {3.735587491358225*^9, 
   3.7355874933363123`*^9}, {3.7361819642838917`*^9, 3.736182001411949*^9}, {
   3.736182040812271*^9, 3.7361820433230743`*^9}, {3.736224593177724*^9, 
   3.736224593508443*^9}, {3.736707193635943*^9, 3.7367072005367317`*^9}, {
   3.736707335770254*^9, 3.7367073366776342`*^9}, {3.736737753950644*^9, 
   3.736737759535718*^9}, {3.736738054628145*^9, 3.736738054868475*^9}, {
   3.736989049138788*^9, 3.736989109998204*^9}, {3.736989213775238*^9, 
   3.73698921564515*^9}, {3.7370420223849688`*^9, 3.737042026438854*^9}, {
   3.7370421276698914`*^9, 3.7370421311364403`*^9}, {3.737052060907675*^9, 
   3.737052081001637*^9}, {3.737307594976301*^9, 3.7373077069470997`*^9}, {
   3.7373254236622143`*^9, 3.73732543128017*^9}, {3.737570842848168*^9, 
   3.737570850738658*^9}, {3.737649706564823*^9, 3.7376497453054647`*^9}, 
   3.737687909722445*^9, {3.737687956512867*^9, 3.737687962168976*^9}, {
   3.737742362393643*^9, 3.73774237751749*^9}, {3.73782550226198*^9, 
   3.7378255080049057`*^9}, {3.737831249400578*^9, 3.737831262165799*^9}, {
   3.738355387863851*^9, 3.738355416714403*^9}, {3.7384263480453176`*^9, 
   3.7384263557665854`*^9}, {3.738951719215248*^9, 3.738951742265087*^9}, {
   3.739204129335066*^9, 3.739204137728134*^9}, {3.739204409188264*^9, 
   3.7392044215589733`*^9}, {3.739204466256764*^9, 3.7392044711168747`*^9}, {
   3.7400996684332457`*^9, 3.7400996731602373`*^9}, {3.740342429671131*^9, 
   3.7403424648771257`*^9}, {3.7404282028112917`*^9, 3.740428212395084*^9}, {
   3.740950079281798*^9, 3.740950088992066*^9}, {3.740967306314831*^9, 
   3.740967317321631*^9}, {3.740967350751754*^9, 3.740967355960145*^9}, {
   3.7409674926506453`*^9, 3.740967518663988*^9}, {3.740967706290674*^9, 
   3.740967707497099*^9}, {3.74118745608778*^9, 3.741187456212831*^9}, {
   3.741311743227998*^9, 3.741311752170285*^9}, {3.741311950873787*^9, 
   3.741311953273878*^9}, {3.741316548801387*^9, 3.74131654895303*^9}, {
   3.741319288963711*^9, 3.741319289799755*^9}, {3.742054989161138*^9, 
   3.742055028567163*^9}, {3.742055156179563*^9, 3.742055156867341*^9}, {
   3.742055198333457*^9, 3.7420553420455112`*^9}, {3.742055481969606*^9, 
   3.742055483345149*^9}, 3.7420560515963173`*^9, {3.742131219227887*^9, 
   3.742131263964753*^9}, {3.742131322115923*^9, 3.742131323670547*^9}, {
   3.74215294581196*^9, 3.742152958382104*^9}, {3.742154103889192*^9, 
   3.7421541104204082`*^9}, {3.7422286911040163`*^9, 3.742228705666182*^9}, {
   3.742253888659059*^9, 3.742253897853512*^9}, {3.742321382759263*^9, 
   3.74232145430963*^9}, {3.742397790262035*^9, 3.742397852683387*^9}, {
   3.742410444929583*^9, 3.742410445035557*^9}, {3.742414701925768*^9, 
   3.742414729129323*^9}, {3.742485203661749*^9, 3.7424852505563517`*^9}, {
   3.742485292381824*^9, 3.742485293892666*^9}, {3.742485758942935*^9, 
   3.742485759781733*^9}, {3.742503202100919*^9, 3.742503209923315*^9}, {
   3.742505649087583*^9, 3.7425057012553883`*^9}, {3.7425118612275352`*^9, 
   3.742511898660386*^9}, 3.742512179386075*^9, 3.7425155066433783`*^9, {
   3.74251609348212*^9, 3.7425160943187857`*^9}, {3.7427391924635363`*^9, 
   3.742739225913971*^9}, {3.7427392996565857`*^9, 3.7427393257107964`*^9}, {
   3.742739357097248*^9, 3.742739410058236*^9}, 3.7427395571799107`*^9, 
   3.742755045248253*^9, {3.742758246732478*^9, 3.742758290109139*^9}, {
   3.742758329693853*^9, 3.742758361532405*^9}, {3.7427624989699574`*^9, 
   3.742762515000156*^9}, {3.7427625852847633`*^9, 3.742762627123375*^9}, {
   3.742766794188614*^9, 3.7427667994707813`*^9}, {3.752000107352159*^9, 
   3.7520001090269938`*^9}, {3.752000181297971*^9, 3.752000193974887*^9}, {
   3.752000274525454*^9, 3.752000275226565*^9}, {3.752010706679998*^9, 
   3.752010708319831*^9}, {3.7521976032070303`*^9, 3.752197603487947*^9}, {
   3.752207741612713*^9, 3.75220774182123*^9}, {3.752707800121058*^9, 
   3.752707809662479*^9}, {3.752806867036797*^9, 3.752806868177814*^9}, {
   3.756421148337595*^9, 3.75642115979652*^9}, {3.756437858085082*^9, 
   3.756437859357243*^9}, {3.757030679093539*^9, 3.757030691256228*^9}, {
   3.757118901657913*^9, 3.757118909495098*^9}, {3.7575535193767023`*^9, 
   3.757553545942484*^9}, {3.757605213601734*^9, 3.7576052167966213`*^9}, {
   3.7576224633873663`*^9, 3.757622469684347*^9}, {3.7576385379619417`*^9, 
   3.757638538937289*^9}, {3.757644501225037*^9, 3.757644501294964*^9}, 
   3.757644661774774*^9, {3.75778966117406*^9, 3.7577896672748938`*^9}, {
   3.757795101631342*^9, 3.757795112117988*^9}, {3.757821548792602*^9, 
   3.7578215610525713`*^9}, {3.7593434945133266`*^9, 3.7593435118701067`*^9}},
 
 CellLabel->
  "In[326]:=",ExpressionUUID->"c302fd43-2b8c-4e60-afba-6a3c47888d9d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Files:", "Subsubsection",
 CellChangeTimes->{{3.7564381534396477`*^9, 
  3.7564381554077673`*^9}},ExpressionUUID->"3040847f-1ddf-475b-9487-\
6211f982bf00"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"inputData", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
     "\"\<~/atlas/media/dmokhtari/Atlas-HDD/eMITOMI_Workup/Setup3/180528/\
Assays/d1_cMUP/Kinetics/d1_TitrationSeries_Analysis.csv.bz2\>\"", ",", 
      "\"\<Data\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"standardCurve", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\<~/atlas/media/dmokhtari/Atlas-HDD/eMITOMI_Workup/Setup3/180528/\
Standards/d1_cMU/Analysis/d1_3dapi_StandardSeries_Analysis.csv.bz2\>\"", ",", 
     "\"\<Data\>\""}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.719686981281328*^9, 3.7196870143732147`*^9}, {
   3.7196870619526043`*^9, 3.719687115845892*^9}, {3.719687574714863*^9, 
   3.719687590225253*^9}, {3.722298635950145*^9, 3.7222987203144913`*^9}, {
   3.7223008567285547`*^9, 3.722300869992189*^9}, {3.7223013454080267`*^9, 
   3.7223013609682426`*^9}, {3.722795325202532*^9, 3.7227953418066*^9}, {
   3.7227958453940487`*^9, 3.722795853800312*^9}, {3.72279588695693*^9, 
   3.722795896532625*^9}, {3.722795985773534*^9, 3.722795987361333*^9}, {
   3.7228058499185743`*^9, 3.722805851577468*^9}, {3.724447004393304*^9, 
   3.7244470341373997`*^9}, {3.724447300434081*^9, 3.72444730610441*^9}, {
   3.728125370586198*^9, 3.728125475262018*^9}, 3.728125532717168*^9, {
   3.728129872267164*^9, 3.7281298976600323`*^9}, {3.728241092209907*^9, 
   3.728241136404192*^9}, {3.728241463099566*^9, 3.728241481510487*^9}, {
   3.728241649213969*^9, 3.728241714391842*^9}, {3.7282418706141157`*^9, 
   3.728241936831512*^9}, {3.728832696757757*^9, 3.728832743669137*^9}, {
   3.728832979357912*^9, 3.7288330330920477`*^9}, {3.728833073126194*^9, 
   3.728833098362237*^9}, 3.728833150201289*^9, {3.7297256054733887`*^9, 
   3.72972567335534*^9}, {3.729725971087227*^9, 3.729725991519813*^9}, {
   3.7324658716702623`*^9, 3.7324658790014*^9}, {3.732465946749613*^9, 
   3.732465970777063*^9}, {3.7326467251495943`*^9, 3.732646733863511*^9}, 
   3.732646831615788*^9, {3.732646944726405*^9, 3.7326469705784616`*^9}, {
   3.732648125174499*^9, 3.7326481446111803`*^9}, {3.732648205743279*^9, 
   3.732648307844205*^9}, {3.732648504577067*^9, 3.732648524481887*^9}, {
   3.7326485800469913`*^9, 3.732648594654457*^9}, {3.7326486691301126`*^9, 
   3.732648697262788*^9}, {3.732648801961879*^9, 3.732648994625415*^9}, {
   3.732649392554352*^9, 3.7326494056335917`*^9}, 3.732649460788621*^9, {
   3.732649660408043*^9, 3.73264966365586*^9}, {3.7326496941398363`*^9, 
   3.732649697894216*^9}, {3.732649813779859*^9, 3.732649845586029*^9}, {
   3.732649878713727*^9, 3.732649881202785*^9}, {3.7326499287764273`*^9, 
   3.7326499452201347`*^9}, {3.7326500541898127`*^9, 
   3.7326500546409073`*^9}, {3.7326513713200083`*^9, 3.73265139945721*^9}, {
   3.7326517206194553`*^9, 3.732651721990458*^9}, {3.7327337077615223`*^9, 
   3.732733713329822*^9}, {3.732733858020467*^9, 3.732733864469529*^9}, {
   3.732734640252248*^9, 3.732734645394642*^9}, {3.732818000072907*^9, 
   3.732818083481278*^9}, {3.7328183711030493`*^9, 3.7328183810848427`*^9}, {
   3.7329124198125772`*^9, 3.732912422718884*^9}, {3.73291246787379*^9, 
   3.732912539155284*^9}, {3.7330705445479107`*^9, 3.733070678524457*^9}, {
   3.7331693083730927`*^9, 3.733169328011593*^9}, {3.733169363218368*^9, 
   3.733169377870604*^9}, {3.7331694666342382`*^9, 3.7331695360604067`*^9}, {
   3.7335194627508163`*^9, 3.733519526868702*^9}, {3.733520668211026*^9, 
   3.733520776272703*^9}, {3.733608878586123*^9, 3.73360888972289*^9}, {
   3.733668186030753*^9, 3.7336681973474493`*^9}, {3.73367490739804*^9, 
   3.733674908679576*^9}, {3.733674940423601*^9, 3.733674945607609*^9}, {
   3.7336789387455263`*^9, 3.7336789585890703`*^9}, {3.7336789989912157`*^9, 
   3.733679010400441*^9}, {3.7338603798710003`*^9, 3.733860497681521*^9}, {
   3.7340342439419813`*^9, 3.734034273427771*^9}, {3.734034307382618*^9, 
   3.734034321361485*^9}, 3.734034439983488*^9, {3.7340345189442863`*^9, 
   3.7340346189305573`*^9}, {3.734034752275317*^9, 3.73403494425093*^9}, {
   3.734188849599023*^9, 3.7341888678449802`*^9}, {3.734188906189155*^9, 
   3.734188967077825*^9}, {3.734196647676587*^9, 3.734196649483823*^9}, {
   3.734201316358087*^9, 3.734201319478313*^9}, {3.7342014375301743`*^9, 
   3.7342014734846087`*^9}, {3.734201509777323*^9, 3.734201560029715*^9}, 
   3.7342016133079567`*^9, {3.734201911033637*^9, 3.734201914380883*^9}, 
   3.73420195324163*^9, 3.734202561048195*^9, {3.734211744673091*^9, 
   3.734211744844627*^9}, {3.734211799180675*^9, 3.734211899477729*^9}, {
   3.734216097484249*^9, 3.734216104588684*^9}, {3.7342162100373*^9, 
   3.73421621021294*^9}, {3.7342751361057177`*^9, 3.734275142047041*^9}, {
   3.734282943736418*^9, 3.734283044519186*^9}, {3.7342880355093393`*^9, 
   3.73428804548411*^9}, {3.7342880884886*^9, 3.734288090663431*^9}, {
   3.734288144273013*^9, 3.734288234195674*^9}, {3.734288309756802*^9, 
   3.734288312080306*^9}, {3.73429215386412*^9, 3.734292232451767*^9}, {
   3.734363025683156*^9, 3.734363100052793*^9}, 3.734363142348414*^9, {
   3.734363992890905*^9, 3.7343640296234503`*^9}, {3.734407802461458*^9, 
   3.734407814232445*^9}, {3.7344079883757763`*^9, 3.734408040301859*^9}, {
   3.734429673518608*^9, 3.7344296913676777`*^9}, {3.734429751714628*^9, 
   3.734429752023541*^9}, {3.7345297131084948`*^9, 3.734529909729228*^9}, {
   3.73453011166396*^9, 3.734530113243692*^9}, 3.734530189452145*^9, {
   3.734531213528365*^9, 3.734531223437697*^9}, {3.734531279111516*^9, 
   3.734531311955874*^9}, {3.7345313488389606`*^9, 3.734531361901145*^9}, {
   3.734564021080226*^9, 3.734564165753985*^9}, {3.734564218074211*^9, 
   3.734564218973591*^9}, {3.7346255936226892`*^9, 3.734625608995781*^9}, {
   3.734625742888916*^9, 3.734625753337165*^9}, {3.73462578837831*^9, 
   3.734625849988392*^9}, {3.734627560933373*^9, 3.7346275714064207`*^9}, {
   3.734627614785612*^9, 3.734627724850898*^9}, {3.734627798728932*^9, 
   3.7346277994277287`*^9}, {3.734701373569454*^9, 3.7347015051031513`*^9}, {
   3.734701542583242*^9, 3.7347015483751802`*^9}, {3.734963989668551*^9, 
   3.7349640058097897`*^9}, {3.734964084385892*^9, 3.734964085224422*^9}, {
   3.734967596024148*^9, 3.7349676321595097`*^9}, {3.734967671572461*^9, 
   3.734967690971408*^9}, {3.7349767138472347`*^9, 3.734976717103578*^9}, {
   3.73506368218574*^9, 3.7350637765954323`*^9}, {3.735248118266777*^9, 
   3.7352481193997507`*^9}, {3.73557967985233*^9, 3.7355797132357264`*^9}, {
   3.7355852681466427`*^9, 3.735585281379787*^9}, {3.735587498474905*^9, 
   3.735587510402534*^9}, {3.7361821731917048`*^9, 3.736182214580009*^9}, {
   3.7361822532456703`*^9, 3.736182260663166*^9}, {3.736183113573625*^9, 
   3.736183140791787*^9}, {3.7362247460754547`*^9, 3.736224770908342*^9}, {
   3.736224859527961*^9, 3.7362248771948338`*^9}, {3.736707144428987*^9, 
   3.7367071917731943`*^9}, {3.736707307213275*^9, 3.736707317666621*^9}, {
   3.736737833728593*^9, 3.736737895649665*^9}, {3.736738028543518*^9, 
   3.7367380628862658`*^9}, {3.73698925301647*^9, 3.736989319357328*^9}, {
   3.73704211936248*^9, 3.737042119693857*^9}, {3.737052138183648*^9, 
   3.737052167527493*^9}, {3.7373077228780117`*^9, 3.7373077894121513`*^9}, {
   3.737325436538725*^9, 3.737325486096095*^9}, {3.737570758649069*^9, 
   3.7375707892530527`*^9}, {3.7375708941254787`*^9, 
   3.7375708947318287`*^9}, {3.7375710016050587`*^9, 
   3.7375710076866837`*^9}, {3.737571051756422*^9, 3.737571054302744*^9}, {
   3.737649755509664*^9, 3.7376498117119417`*^9}, 3.737687917760963*^9, {
   3.7376879685173063`*^9, 3.737687985780139*^9}, {3.7376880681265574`*^9, 
   3.737688068278554*^9}, {3.737742401973859*^9, 3.737742433583186*^9}, {
   3.737742513289399*^9, 3.737742513398801*^9}, {3.737742558368967*^9, 
   3.737742564284441*^9}, {3.7377426453791122`*^9, 3.737742645554881*^9}, {
   3.737825511353839*^9, 3.737825526799364*^9}, {3.737831265159649*^9, 
   3.737831308511771*^9}, {3.737907584911677*^9, 3.7379076372870483`*^9}, {
   3.738355424658463*^9, 3.738355476931364*^9}, {3.738426366200244*^9, 
   3.7384263779512653`*^9}, {3.7389517477617207`*^9, 3.7389517484034*^9}, {
   3.7389517859955263`*^9, 3.738951837640295*^9}, {3.73920436531511*^9, 
   3.7392044059117327`*^9}, {3.7392044403014393`*^9, 3.739204477798026*^9}, {
   3.740099690997126*^9, 3.740099739310871*^9}, {3.740099771097682*^9, 
   3.740099780783484*^9}, {3.7403424863234386`*^9, 3.740342539761587*^9}, {
   3.740342573783567*^9, 3.740342584816802*^9}, {3.740428229311924*^9, 
   3.7404282984652443`*^9}, {3.740967750808845*^9, 3.7409677644733467`*^9}, 
   3.740967820758934*^9, {3.741187461785075*^9, 3.741187468244834*^9}, 
   3.741187530061776*^9, {3.741187753790522*^9, 3.741187763315621*^9}, {
   3.741187808753048*^9, 3.741187809927372*^9}, {3.7413119701726513`*^9, 
   3.741312022909355*^9}, {3.7413120779808397`*^9, 3.74131208739224*^9}, {
   3.741316508769141*^9, 3.74131653682555*^9}, {3.741316636392205*^9, 
   3.7413166382700787`*^9}, {3.7413192298180847`*^9, 3.741319281990838*^9}, {
   3.7413195090948963`*^9, 3.741319520555995*^9}, {3.742055871378789*^9, 
   3.742055881877234*^9}, {3.7420559318098993`*^9, 3.742055985429653*^9}, {
   3.742056023437755*^9, 3.742056036266975*^9}, {3.7421314107481813`*^9, 
   3.7421314175616713`*^9}, {3.7421314570240707`*^9, 3.74213151175408*^9}, {
   3.742154131255121*^9, 3.742154174279929*^9}, {3.742154206618226*^9, 
   3.74215421630256*^9}, {3.74225394166757*^9, 3.7422539948013363`*^9}, {
   3.74232146623031*^9, 3.7423215206984863`*^9}, {3.742321582030098*^9, 
   3.74232159543827*^9}, {3.7423216387532797`*^9, 3.742321651582473*^9}, {
   3.7423217285339413`*^9, 3.742321728812295*^9}, {3.742397869915855*^9, 
   3.742397901847144*^9}, {3.74239794598068*^9, 3.742397953459338*^9}, {
   3.7423979857421722`*^9, 3.742398019373465*^9}, {3.742406443128488*^9, 
   3.7424064454908037`*^9}, {3.742410307259613*^9, 3.7424103126355257`*^9}, {
   3.7424103848065863`*^9, 3.742410394042651*^9}, {3.7424104367030354`*^9, 
   3.7424104374201393`*^9}, {3.742411689238265*^9, 3.742411694881049*^9}, {
   3.7424147429529057`*^9, 3.74241479685322*^9}, {3.742414831487589*^9, 
   3.742414843718832*^9}, {3.742485318614438*^9, 3.742485370709558*^9}, {
   3.742485403114234*^9, 3.7424854100343313`*^9}, {3.7424854680297937`*^9, 
   3.742485469325735*^9}, 3.742485679407564*^9, {3.742486251350935*^9, 
   3.742486254495932*^9}, 3.742503228092073*^9, {3.742505735348215*^9, 
   3.742505776075811*^9}, {3.7425058097676764`*^9, 3.742505819896546*^9}, {
   3.742505861549191*^9, 3.7425058695277*^9}, {3.742508476057128*^9, 
   3.742508489562951*^9}, 3.742508545902155*^9, {3.7425085828078213`*^9, 
   3.7425085893538637`*^9}, {3.7425119123952208`*^9, 3.742511953128724*^9}, {
   3.7425120123532257`*^9, 3.742512020159037*^9}, {3.74251610058675*^9, 
   3.742516112496251*^9}, {3.74251614821178*^9, 3.7425161751755123`*^9}, {
   3.742516500764825*^9, 3.7425165350939093`*^9}, {3.742739417316168*^9, 
   3.742739507210273*^9}, {3.742739541003927*^9, 3.7427395483673162`*^9}, 
   3.7427550632364492`*^9, {3.742758388287735*^9, 3.742758497859083*^9}, {
   3.7427626494795218`*^9, 3.742762761276267*^9}, {3.742766829198325*^9, 
   3.742766850882601*^9}, {3.7427668884603252`*^9, 3.74276697358365*^9}, {
   3.7519973222459087`*^9, 3.7519974116480837`*^9}, {3.751997730910787*^9, 
   3.75199773375739*^9}, {3.752000411764309*^9, 3.752000432716065*^9}, {
   3.7520107260014067`*^9, 3.752010756233213*^9}, {3.752197610193578*^9, 
   3.7521976136600924`*^9}, {3.752207746181835*^9, 3.752207746368573*^9}, {
   3.7527078242375174`*^9, 3.75270786192143*^9}, {3.752708134007622*^9, 
   3.75270818982413*^9}, {3.756421183106577*^9, 3.75642121216341*^9}, {
   3.756438146267419*^9, 3.756438147242853*^9}, {3.756438187677431*^9, 
   3.756438188142839*^9}, {3.756669679081346*^9, 3.756669689121387*^9}, 
   3.756669735826488*^9, {3.757030740318953*^9, 3.7570307847091103`*^9}, {
   3.757118933011319*^9, 3.7571189583532467`*^9}, {3.757118997176503*^9, 
   3.757119015033182*^9}, {3.757553565071705*^9, 3.75755359140553*^9}, {
   3.7575580053514557`*^9, 3.757558010100936*^9}, {3.757558289436051*^9, 
   3.757558292668738*^9}, {3.757558517370019*^9, 3.757558517959146*^9}, 
   3.757559003130742*^9, {3.757605229943265*^9, 3.757605230917427*^9}, {
   3.7576224848941803`*^9, 3.757622514225753*^9}, {3.757644506374537*^9, 
   3.757644510820204*^9}, {3.757690398906248*^9, 3.757690406764916*^9}, {
   3.757690459878024*^9, 3.757690459977179*^9}, {3.757789729058041*^9, 
   3.757789759716531*^9}, {3.757795125529551*^9, 3.7577951277114058`*^9}, {
   3.757795168758481*^9, 3.757795175584675*^9}, {3.757821600982777*^9, 
   3.757821631976611*^9}, {3.7593435291157427`*^9, 3.759343548933062*^9}},
 CellLabel->
  "In[336]:=",ExpressionUUID->"bc4ea9a4-2bd6-45db-834f-23c53e78f053"]
}, Open  ]],

Cell[CellGroupData[{

Cell["eGFP summary image (for manual spot culling):", "Subsubsection",
 CellChangeTimes->{{3.756438192322126*^9, 
  3.756438209425757*^9}},ExpressionUUID->"6f9bfa0d-d327-433f-a9ee-\
d0c7c9032dcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rawImageIn", "=", 
   RowBox[{
   "Import", "[", 
    "\"\<~/atlas/media/dmokhtari/Atlas-HDD/eMITOMI_Workup/Setup3/180528/\
Assays/d1_cMUP/Button_Quants/20180529-001827-d1_10uM_cMUP_PreAssay_\
ButtonQuant/4egfp/StitchedImages/SummaryImages/Summary_BGSubtracted_\
StitchedImg_500_GFP_0.tif\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.742920546558391*^9, {3.743034726869567*^9, 3.743034728843207*^9}, {
   3.752000472604884*^9, 3.752000480285246*^9}, {3.752709467551*^9, 
   3.7527094764247293`*^9}, 3.752709513957013*^9, 3.7564212514710197`*^9, {
   3.756669765865182*^9, 3.7566697832342997`*^9}, {3.757030714477322*^9, 
   3.757030715824666*^9}, {3.757118986581114*^9, 3.757118987412416*^9}, {
   3.757119017940979*^9, 3.7571190192540407`*^9}, {3.757553629989017*^9, 
   3.7575536306833572`*^9}, 3.757622548982703*^9, {3.75764452527894*^9, 
   3.757644529123254*^9}, {3.757690431183916*^9, 3.7576904337261333`*^9}, {
   3.757789787974122*^9, 3.757789791593886*^9}, 3.757795214329564*^9, {
   3.757821660884942*^9, 3.757821667225984*^9}, {3.759343598885215*^9, 
   3.759343599560322*^9}, {3.759343712938095*^9, 3.7593437137264977`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"5a1ce303-0331-486d-be4d-2ddcfd247a22"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Assay conditions:", "Subsubsection",
 CellChangeTimes->{{3.756438212667343*^9, 
  3.7564382168902197`*^9}},ExpressionUUID->"9144f08b-142c-4bf3-a463-\
262ed5147c13"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"substrates", "=", 
   RowBox[{"AssociationThread", "[", 
    RowBox[{
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"inputData", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"2", ";;", "All"}], ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "10.0", ",", "25.0", ",", "50.0", ",", "100.0", ",", "200.0", ",", 
       "500", ",", "1000.0"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"substrates", "=", 
    RowBox[{"AssociationThread", "[", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"inputData", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"2", ";;", "All"}], ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{"50.0", ",", 
        RowBox[{"{", "6", "}"}]}], "]"}]}], "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"types", "=", 
  RowBox[{"AssociationThread", "[", 
   RowBox[{
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"inputData", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"2", ";;", "All"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
     "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"inhibitors", "=", 
  RowBox[{"AssociationThread", "[", 
   RowBox[{
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"inputData", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"2", ";;", "All"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{"0.0", ",", 
      RowBox[{"{", "7", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"other", "=", 
  RowBox[{"AssociationThread", "[", 
   RowBox[{
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"inputData", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"2", ";;", "All"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{"100.0", ",", 
      RowBox[{"{", "7", "}"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7519985259432287`*^9, 3.7519985326538563`*^9}, {
   3.751998999839628*^9, 3.751999018377705*^9}, {3.75200049207158*^9, 
   3.752000496710327*^9}, {3.752010770542321*^9, 3.75201077420686*^9}, {
   3.7520108136538563`*^9, 3.752010881904608*^9}, {3.7520123702001057`*^9, 
   3.752012371913227*^9}, 3.7520192658702707`*^9, {3.752197683788988*^9, 
   3.7521977413231792`*^9}, 3.7522077658208857`*^9, {3.752207852826932*^9, 
   3.752207882458908*^9}, {3.752709483238833*^9, 3.7527094888461123`*^9}, {
   3.752804278250906*^9, 3.752804280214324*^9}, {3.756421395216943*^9, 
   3.756421446888955*^9}, {3.7571102230903063`*^9, 3.757110248611266*^9}, {
   3.757119026385969*^9, 3.757119044502818*^9}, {3.757553638123158*^9, 
   3.757553678077059*^9}, {3.757821756172254*^9, 3.757821789929348*^9}},
 CellLabel->
  "In[338]:=",ExpressionUUID->"11515cb3-fd5a-4707-bf76-b0283a52be97"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analysis", "Section",
 CellChangeTimes->{{3.732732210052601*^9, 3.732732219292498*^9}, {
  3.7331692470144167`*^9, 3.733169248195539*^9}, {3.73316960366033*^9, 
  3.733169606101077*^9}},ExpressionUUID->"46e27fd9-8d24-4613-b1a0-\
27d6bce139d6"],

Cell[CellGroupData[{

Cell["\<\
1a. Generate the initial Dataset or import a saved Dataset in which to append \
additional analyses:\
\>", "Subsubsection",
 CellChangeTimes->{{3.732981294756315*^9, 3.732981301817131*^9}, {
   3.734963641059845*^9, 3.734963655470152*^9}, {3.7349637316623917`*^9, 
   3.7349637552439127`*^9}, {3.7392041930226183`*^9, 3.7392041934248037`*^9}, 
   3.7519975657065783`*^9},ExpressionUUID->"eb4fc38c-b472-4b23-b4ea-\
71356699cde5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<Parsing intensity data...\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProgressIndicator", "[", 
   RowBox[{
    RowBox[{"Dynamic", "[", "i", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{
       RowBox[{"Length", "[", "inputData", "]"}], "-", "1"}]}], "}"}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"keys", "=", 
    RowBox[{"inputData", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "adding", " ", "GFP", " ", "intensities", " ", "from", " ", "earlier", " ",
     "experiment", " ", "as", " ", "something", " ", "is", " ", "wrong", " ", 
    "with", " ", "eGFP", " ", "images"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"eGFPfromcMUP", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"oldDataset", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"#ExpIndex", "\[Equal]", "1"}], "&"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Indices\>\"", ",", "\"\<eGFPSummedI\>\""}], "}"}]}], 
       "]"}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"assayDataSetIn", "=", 
    RowBox[{"Dataset", "[", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"keys", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "\[Rule]", 
                RowBox[{"replaceBrackets", "[", 
                 RowBox[{"inputData", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "n"}], "]"}], "]"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"Length", "[", "keys", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<GlobalExperimentIndex\>\"", "\[Rule]", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{"expDate", ",", "\"\<_S\>\"", ",", 
                  RowBox[{"ToString", "[", "setup", "]"}], ",", "\"\<_\>\"", 
                  ",", "deviceID", ",", "\"\<_\>\"", ",", "substrateType", 
                  ",", "\"\<_\>\"", ",", 
                  RowBox[{"ToString", "[", "replicate", "]"}]}], "]"}]}], ",", 
               RowBox[{"\"\<Date\>\"", "\[Rule]", "expDate"}], ",", 
               RowBox[{"\"\<Experiment\>\"", "\[Rule]", "experiment"}], ",", 
               RowBox[{"\"\<Setup\>\"", "\[Rule]", "setup"}], ",", 
               RowBox[{"\"\<Device\>\"", "\[Rule]", "deviceID"}], ",", 
               RowBox[{
               "\"\<PhosphateSensorConc\>\"", "\[Rule]", "PO4sensorConc"}], 
               ",", 
               RowBox[{"\"\<eGFPSlope\>\"", "->", "eGFPslope"}]}], "}"}], 
             "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "inputData", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", "1"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"assayDataSet2a", "=", 
    RowBox[{"assayDataSetIn", "[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"\"\<Indices\>\"", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"#x", ",", "#y"}], "}"}]}]}], "]"}], "&"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"assayDataSet2", "=", 
    RowBox[{"assayDataSet2a", "[", 
     RowBox[{"All", ",", 
      RowBox[{"KeyMap", "[", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<id\>\"", "\[Rule]", "\"\<MutantID\>\""}], ",", 
            RowBox[{
            "\"\<summed_button_BGsub_Button_Quant\>\"", "\[Rule]", 
             "\"\<eGFPSummedI\>\""}]}], "}"}]}], "]"}], "&"}], "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"assayDataSet2b", "=", 
     RowBox[{"assayDataSet2a", "[", 
      RowBox[{"All", ",", 
       RowBox[{"KeyMap", "[", 
        RowBox[{
         RowBox[{"StringReplace", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<id\>\"", "\[Rule]", "\"\<MutantID\>\""}], "}"}]}], 
          "]"}], "&"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"assayDataSet2", "=", 
     RowBox[{"Dataset", "[", 
      RowBox[{"JoinAcross", "[", 
       RowBox[{
        RowBox[{"Normal", "[", "assayDataSet2b", "]"}], ",", "eGFPfromcMUP", 
        ",", "\"\<Indices\>\"", ",", "\"\<Left\>\""}], "]"}], "]"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"assayDataSetGrouped", "=", 
    RowBox[{"assayDataSet2", "[", 
     RowBox[{
      RowBox[{"GroupBy", "[", "\"\<series_index\>\"", "]"}], ",", 
      RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Remapping keys for processing...\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProgressIndicator", "[", 
   RowBox[{
    RowBox[{"Dynamic", "[", "m", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"Length", "[", "substrates", "]"}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"assayDataSet", "=", 
    RowBox[{"Dataset", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"times", "=", 
         RowBox[{"Normal", "[", 
          RowBox[{"assayDataSetGrouped", "[", 
           RowBox[{"m", ",", "i", ",", "All", ",", "\"\<time_s\>\""}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"intensities", "=", 
         RowBox[{"Normal", "[", 
          RowBox[{"assayDataSetGrouped", "[", 
           RowBox[{"m", ",", "i", ",", "All", ",", "\"\<median_chamber\>\""}],
            "]"}], "]"}]}], ";", 
        RowBox[{"Normal", "[", 
         RowBox[{
          RowBox[{"assayDataSetGrouped", "[", 
           RowBox[{"m", ",", "i"}], "]"}], "[", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<Times\>\"", "\[Rule]", "times"}], ",", 
                RowBox[{
                "\"\<MedianIntensities\>\"", "\[Rule]", "intensities"}], ",", 
                
                RowBox[{"\"\<ExpIndex\>\"", "\[Rule]", "m"}], ",", 
                RowBox[{"\"\<AssayType\>\"", "\[Rule]", 
                 RowBox[{"types", "[", 
                  RowBox[{"#", "[", "\"\<series_index\>\"", "]"}], "]"}]}], 
                ",", 
                RowBox[{"\"\<SubstrateConc\>\"", "\[Rule]", 
                 RowBox[{"substrates", "[", 
                  RowBox[{"#", "[", "\"\<series_index\>\"", "]"}], "]"}]}], 
                ",", 
                RowBox[{"\"\<InhibitorConcentrations\>\"", "\[Rule]", 
                 RowBox[{"inhibitors", "[", 
                  RowBox[{"#", "[", "\"\<series_index\>\"", "]"}], "]"}]}], 
                ",", 
                RowBox[{"\"\<Zn2+\>\"", "\[Rule]", 
                 RowBox[{"other", "[", 
                  RowBox[{"#", "[", "\"\<series_index\>\"", "]"}], "]"}]}]}], 
               "}"}]}], "]"}], "&"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"Length", "[", "substrates", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "1568"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "commented", " ", "out", " ", "code", " ", "below", " ", "removes", " ", 
    "a", " ", "bad", " ", "point", " ", "if", " ", "known"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "remove", " ", "100", "uM", " ", "VO4", " ", "point", " ", "as", " ", 
     "this", " ", "is", " ", "bad"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"assayDataSet2", "=", 
     RowBox[{"assayDataSet", "[", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          "\"\<InhibitorConcentrations\>\"", "]"}], "\[NotEqual]", "100.0"}], 
        "&"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"assayDataSet", "=", "assayDataSet2"}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"assayDataSetWorking", "=", 
    RowBox[{
    "Import", "[", 
     "\"\</Users/craig/atlas/media/dmokhtari/Atlas-HDD/eMITOMI_Processed/mx_\
format_files/180402_S2d2_MeP_titration_series_50uMpointDropped_reprocessed.mx\
\>\"", "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.732733742235869*^9, 3.732733810785824*^9}, {
   3.732733877909441*^9, 3.7327338942128*^9}, {3.7327339879235992`*^9, 
   3.732734003754887*^9}, {3.732734388263599*^9, 3.732734411338696*^9}, {
   3.732734555760565*^9, 3.7327346187711763`*^9}, {3.7327347758715773`*^9, 
   3.732734806873704*^9}, {3.7327348459740467`*^9, 3.732734854516893*^9}, {
   3.732818508195798*^9, 3.732818541269745*^9}, {3.732819814248485*^9, 
   3.732819851400675*^9}, {3.7329125613809423`*^9, 3.73291257157535*^9}, 
   3.732981305135995*^9, 3.733519568541795*^9, {3.733520135696691*^9, 
   3.733520153053665*^9}, 3.733534771213159*^9, 3.733677780138608*^9, {
   3.733678964971322*^9, 3.733679020660479*^9}, {3.733860529209201*^9, 
   3.733860534267825*^9}, {3.733860656584486*^9, 3.733860657546772*^9}, {
   3.73414013232673*^9, 3.734140145665807*^9}, {3.734188949090075*^9, 
   3.734188949464633*^9}, {3.734211937767874*^9, 3.7342119449306107`*^9}, {
   3.734530219556903*^9, 3.734530245397016*^9}, 3.734531421756034*^9, 
   3.734531513755706*^9, {3.7345642298064833`*^9, 3.7345642372417393`*^9}, {
   3.7349636590723877`*^9, 3.734963695431684*^9}, {3.735063785005704*^9, 
   3.73506379138988*^9}, {3.735237985905282*^9, 3.73523802654568*^9}, {
   3.735253712909093*^9, 3.7352537186092577`*^9}, {3.736182404259791*^9, 
   3.7361824051608953`*^9}, {3.738090811786775*^9, 3.738090812434824*^9}, {
   3.739149154549178*^9, 3.739149164695356*^9}, {3.739204151641117*^9, 
   3.739204170282782*^9}, {3.751997423867313*^9, 3.751997538691221*^9}, {
   3.7519977695000067`*^9, 3.751997774024879*^9}, {3.7519978219955263`*^9, 
   3.751997845990554*^9}, {3.751998159513932*^9, 3.751998160576384*^9}, {
   3.751998452204705*^9, 3.7519985907219057`*^9}, {3.751999020892675*^9, 
   3.7519990405220623`*^9}, {3.751999073206131*^9, 3.751999125804852*^9}, {
   3.751999191679756*^9, 3.751999201888988*^9}, {3.752019283031736*^9, 
   3.752019284918983*^9}, {3.7520232978048477`*^9, 3.752023314943676*^9}, {
   3.7520233752277184`*^9, 3.7520233931216297`*^9}, {3.752023568974905*^9, 
   3.752023569473145*^9}, {3.7520239801961184`*^9, 3.752024004600452*^9}, {
   3.752025898506793*^9, 3.752025904133279*^9}, {3.752026021664897*^9, 
   3.752026069893105*^9}, {3.7520261287559*^9, 3.752026150110868*^9}, {
   3.752026921015366*^9, 3.752026922953755*^9}, {3.752029148559822*^9, 
   3.752029163898479*^9}, {3.752197918450362*^9, 3.752197929377893*^9}, {
   3.752768536691299*^9, 3.752768562254566*^9}, {3.756421628732827*^9, 
   3.756421646534346*^9}, {3.756421872504672*^9, 3.7564219017195063`*^9}, {
   3.757110273617939*^9, 3.7571102786968803`*^9}},
 CellLabel->
  "In[342]:=",ExpressionUUID->"1ba4cf3e-134b-4920-8d7d-da19aaefba58"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
1b. Generate dataset of standard curve data in proper format:\
\>", "Subsubsection",
 CellChangeTimes->{{3.742910162092506*^9, 3.742910169049345*^9}, {
  3.751997562215514*^9, 
  3.751997613329698*^9}},ExpressionUUID->"283873b0-06e4-4db6-99c7-\
a58cb3d5d5aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"keysSC", "=", 
    RowBox[{"standardCurve", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SCDatasetIn", "=", 
    RowBox[{"Dataset", "[", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"keysSC", "[", 
               RowBox[{"[", "n", "]"}], "]"}], "\[Rule]", 
              RowBox[{"replaceBrackets", "[", 
               RowBox[{"standardCurve", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "n"}], "]"}], "]"}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"Length", "[", "keysSC", "]"}]}], "}"}]}], "]"}], "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "standardCurve", "]"}], "-", "1"}]}], 
          "}"}]}], "]"}], ",", "1"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SCDataset", "=", 
    RowBox[{"SCDatasetIn", "[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"\"\<Indices\>\"", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"#x", ",", "#y"}], "}"}]}]}], "]"}], "&"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SCDatasetGrouped", "=", 
    RowBox[{"SCDataset", "[", 
     RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SCforJoin", "=", 
   RowBox[{
    RowBox[{"Dataset", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"times", "=", 
         RowBox[{"Normal", "[", 
          RowBox[{"SCDatasetGrouped", "[", 
           RowBox[{"i", ",", "All", ",", "\"\<concentration_uM\>\""}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"intensities", "=", 
         RowBox[{"Normal", "[", 
          RowBox[{"SCDatasetGrouped", "[", 
           RowBox[{"i", ",", "All", ",", "\"\<median_chamber\>\""}], "]"}], 
          "]"}]}], ";", 
        RowBox[{"Normal", "[", 
         RowBox[{
          RowBox[{"SCDatasetGrouped", "[", "i", "]"}], "[", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<SC_Concentrations\>\"", "\[Rule]", "times"}], 
                ",", 
                RowBox[{
                "\"\<SC_Median_Chamber\>\"", "\[Rule]", "intensities"}]}], 
               "}"}]}], "]"}], "&"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "1568"}], "}"}]}], "]"}], "]"}], "[", 
    RowBox[{"All", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Indices\>\"", ",", "\"\<SC_Concentrations\>\"", ",", 
       "\"\<SC_Median_Chamber\>\""}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.751997624544739*^9, 3.751997650903941*^9}, {
  3.751998896515469*^9, 3.751998933193356*^9}},
 CellLabel->
  "In[352]:=",ExpressionUUID->"7e8481bb-15f0-4486-a19a-e722fb59fc29"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
1c. Flatten and add standard curve data and substrate/inhibitor \
concentrations (join standard curve data on indices):\
\>", "Subsubsection",
 CellChangeTimes->{{3.742910162092506*^9, 3.742910169049345*^9}, {
  3.751997562215514*^9, 3.751997593034008*^9}, {3.751997652485227*^9, 
  3.7519976575365667`*^9}},ExpressionUUID->"c4c98381-81fe-4369-bd52-\
9a9146c924cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"datasetIn", "=", 
   RowBox[{"Dataset", "[", 
    RowBox[{"JoinAcross", "[", 
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Catenate", "[", "assayDataSet", "]"}], "]"}], ",", 
      RowBox[{"Normal", "[", "SCforJoin", "]"}], ",", "\"\<Indices\>\"", ",", 
      "\"\<Left\>\""}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.742910172084834*^9, 3.742910196153974*^9}, {
   3.7429205312269278`*^9, 3.7429205319510317`*^9}, {3.751997677191684*^9, 
   3.7519976811011267`*^9}, {3.751998784649107*^9, 3.751998847811233*^9}, 
   3.7519989375885057`*^9, {3.751998972802503*^9, 3.751998981299361*^9}, {
   3.751999323884654*^9, 3.751999326222804*^9}, {3.751999482667572*^9, 
   3.751999482940933*^9}},
 CellLabel->
  "In[357]:=",ExpressionUUID->"779d71bb-0097-4ba2-81f8-47dd1ec7cba4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "2. Fit standard curve data, then generate and add standard curve plots (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", "eval"], "=", "48"}], TraditionalForm]],ExpressionUUID->
  "a1d3eecd-c316-40ec-bb44-4f93b9decf13"],
 "s):"
}], "Subsubsection",
 CellChangeTimes->{{3.732982122369422*^9, 3.73298212984267*^9}, {
  3.7335198368618307`*^9, 3.733519840007523*^9}, {3.733520332191161*^9, 
  3.7335203379182167`*^9}, {3.7335221789957314`*^9, 3.733522179567046*^9}, {
  3.733523573728622*^9, 3.733523582310413*^9}, {3.737921877350267*^9, 
  3.737921881848196*^9}, {3.739148980554291*^9, 3.7391489854936113`*^9}, {
  3.739204195466918*^9, 
  3.7392041958405457`*^9}},ExpressionUUID->"fdcbc86f-9ea8-4ab0-aac9-\
25db2a59b58d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dynamic", "[", "n", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"withStdCurvePlot", "=", 
     RowBox[{"assayDataSet", "[", 
      RowBox[{"All", ",", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<StandardCurvePlot\>\"", "\[Rule]", 
            RowBox[{"Quiet", "[", 
             RowBox[{"makePBPcurvePlot", "[", 
              RowBox[{"#StdCurveSlope", ",", "#StdCurveData"}], "]"}], 
             "]"}]}], "}"}]}], "]"}], "&"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataset", "=", 
    RowBox[{"datasetIn", "[", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#ExpIndex", "\[Equal]", "1"}], "&&", 
        RowBox[{"#AssayType", "\[Equal]", "1"}]}], "&"}], "]"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "[", "dataset", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Fitting standard curves...\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProgressIndicator", "[", 
   RowBox[{
    RowBox[{"Dynamic", "[", "count", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1568"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addStandardCurveFits", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Association", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Indices\>\"", "->", 
          RowBox[{"Normal", "[", 
           RowBox[{"dataset", "[", 
            RowBox[{"count", ",", "\"\<Indices\>\""}], "]"}], "]"}]}], ",", 
         RowBox[{"\"\<StdCurveSlope\>\"", "\[Rule]", 
          RowBox[{
           RowBox[{"Quiet", "[", 
            RowBox[{"fitStdCurveNew", "[", 
             RowBox[{
              RowBox[{"Normal", "[", 
               RowBox[{"dataset", "[", 
                RowBox[{"count", ",", "\"\<SC_Concentrations\>\""}], "]"}], 
               "]"}], ",", 
              RowBox[{"Normal", "[", 
               RowBox[{"dataset", "[", 
                RowBox[{"count", ",", "\"\<SC_Median_Chamber\>\""}], "]"}], 
               "]"}]}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<StdCurveIntercept\>\"", "\[Rule]", 
          RowBox[{
           RowBox[{"Quiet", "[", 
            RowBox[{"fitStdCurveNew", "[", 
             RowBox[{
              RowBox[{"Normal", "[", 
               RowBox[{"dataset", "[", 
                RowBox[{"count", ",", "\"\<SC_Concentrations\>\""}], "]"}], 
               "]"}], ",", 
              RowBox[{"Normal", "[", 
               RowBox[{"dataset", "[", 
                RowBox[{"count", ",", "\"\<SC_Median_Chamber\>\""}], "]"}], 
               "]"}]}], "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<StdCurveFitObject\>\"", "->", 
          RowBox[{
           RowBox[{"Quiet", "[", 
            RowBox[{"fitStdCurveNew", "[", 
             RowBox[{
              RowBox[{"Normal", "[", 
               RowBox[{"dataset", "[", 
                RowBox[{"count", ",", "\"\<SC_Concentrations\>\""}], "]"}], 
               "]"}], ",", 
              RowBox[{"Normal", "[", 
               RowBox[{"dataset", "[", 
                RowBox[{"count", ",", "\"\<SC_Median_Chamber\>\""}], "]"}], 
               "]"}]}], "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<StdCurveRSquared\>\"", "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Quiet", "[", 
              RowBox[{"fitStdCurveNew", "[", 
               RowBox[{
                RowBox[{"Normal", "[", 
                 RowBox[{"dataset", "[", 
                  RowBox[{"count", ",", "\"\<SC_Concentrations\>\""}], "]"}], 
                 "]"}], ",", 
                RowBox[{"Normal", "[", 
                 RowBox[{"dataset", "[", 
                  RowBox[{"count", ",", "\"\<SC_Median_Chamber\>\""}], "]"}], 
                 "]"}]}], "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ")"}], "[", "\"\<RSquared\>\"", 
           "]"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"count", ",", "1", ",", "1568"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"withStdCurveFits", "=", 
    RowBox[{"Dataset", "[", 
     RowBox[{"JoinAcross", "[", 
      RowBox[{
       RowBox[{"Normal", "[", "datasetIn", "]"}], ",", "addStandardCurveFits",
        ",", 
       RowBox[{"{", "\"\<Indices\>\"", "}"}], ",", "\"\<Left\>\""}], "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Adding standard curve plots...\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProgressIndicator", "[", 
   RowBox[{
    RowBox[{"Dynamic", "[", "count2", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1568"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addStandardCurvePlots", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Association", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Indices\>\"", "->", 
          RowBox[{"Normal", "[", 
           RowBox[{"dataset", "[", 
            RowBox[{"count2", ",", "\"\<Indices\>\""}], "]"}], "]"}]}], ",", 
         RowBox[{"\"\<StandardCurvePlot\>\"", "->", 
          RowBox[{"Quiet", "[", 
           RowBox[{"makeStdCurvePlotNew", "[", 
            RowBox[{
             RowBox[{"withStdCurveFits", "[", 
              RowBox[{"count2", ",", "\"\<StdCurveSlope\>\""}], "]"}], ",", 
             RowBox[{"withStdCurveFits", "[", 
              RowBox[{"count2", ",", "\"\<StdCurveIntercept\>\""}], "]"}], 
             ",", 
             RowBox[{"withStdCurveFits", "[", 
              RowBox[{"count2", ",", "\"\<SC_Concentrations\>\""}], "]"}], 
             ",", 
             RowBox[{"withStdCurveFits", "[", 
              RowBox[{"count2", ",", "\"\<SC_Median_Chamber\>\""}], "]"}]}], 
            "]"}], "]"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"count2", ",", "1", ",", "1568"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"withStdCurvePlot", "=", 
    RowBox[{"Dataset", "[", 
     RowBox[{"JoinAcross", "[", 
      RowBox[{
       RowBox[{"Normal", "[", "withStdCurveFits", "]"}], ",", 
       "addStandardCurvePlots", ",", 
       RowBox[{"{", "\"\<Indices\>\"", "}"}], ",", "\"\<Left\>\""}], "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}]}], "Input",
 CellChangeTimes->{{3.733523597976165*^9, 3.7335236150715837`*^9}, {
   3.733523648389865*^9, 3.733523734840747*^9}, {3.733535894563966*^9, 
   3.733535895351377*^9}, {3.734102877683872*^9, 3.734102889967964*^9}, {
   3.734103080475646*^9, 3.734103080797895*^9}, {3.734274751749447*^9, 
   3.7342747533398943`*^9}, {3.7342752728395576`*^9, 3.73427528819278*^9}, 
   3.734275476991047*^9, {3.734283094546897*^9, 3.734283100094578*^9}, {
   3.7342883494889393`*^9, 3.734288355678158*^9}, {3.7345301689225607`*^9, 
   3.7345301739354563`*^9}, {3.73523842968882*^9, 3.735238455546618*^9}, {
   3.736182447615982*^9, 3.73618245522029*^9}, {3.7369893404243193`*^9, 
   3.736989344887883*^9}, {3.73730785299961*^9, 3.7373078569747763`*^9}, {
   3.737919485484497*^9, 3.737919798122252*^9}, 3.737919836495226*^9, 
   3.737920021009149*^9, 3.739149136481941*^9, {3.7391496793942223`*^9, 
   3.73914984419083*^9}, {3.739149879634164*^9, 3.739149892767622*^9}, {
   3.73915013863456*^9, 3.7391501412033167`*^9}, {3.7391516277430573`*^9, 
   3.739151633803513*^9}, {3.742910184888803*^9, 3.742910185443789*^9}, {
   3.742910215906801*^9, 3.742910255093643*^9}, {3.7429103747792253`*^9, 
   3.7429103794196053`*^9}, {3.742910497140226*^9, 3.742910525728919*^9}, {
   3.742911486283687*^9, 3.7429115039860573`*^9}, {3.7519993307020683`*^9, 
   3.751999332153208*^9}, {3.751999512348351*^9, 3.7519995140687237`*^9}, {
   3.756421929603118*^9, 3.7564219422966948`*^9}, {3.756421982471552*^9, 
   3.7564219975284863`*^9}, {3.756422083228126*^9, 3.756422141483158*^9}, {
   3.7575592358862667`*^9, 3.7575592477047358`*^9}, {3.759349316617275*^9, 
   3.759349355066469*^9}},
 CellLabel->
  "In[417]:=",ExpressionUUID->"24a33a3f-3bbb-47aa-835d-506a68ef003a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["2b. Append uM progress curve data:", "Subsubsection",
 CellChangeTimes->{{3.7429121262282867`*^9, 
  3.742912136848997*^9}},ExpressionUUID->"e9ca8873-0e95-4c07-bbca-\
50b622337c0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"withProgressCurves", "=", 
   RowBox[{"withStdCurvePlot", "[", 
    RowBox[{"All", ",", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\"\<TurnoverTimepoints(uM)\>\"", "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#MedianIntensities", "-", "#StdCurveIntercept"}], ")"}], 
          "/", 
          RowBox[{"Normal", "[", "#StdCurveSlope", "]"}]}]}]}], "]"}], 
      "&"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7429121395029087`*^9, 3.742912163202223*^9}, {
   3.7429121938757563`*^9, 3.7429122206387577`*^9}, 3.75199960726586*^9, {
   3.757111299970009*^9, 3.7571113015902357`*^9}},
 CellLabel->
  "In[431]:=",ExpressionUUID->"f757ca3f-804f-4e62-a5bc-4d2a1190b413"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "3. Do optimized fit (<30% || default to 2-point) on progress curves (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", "eval"], "=", "30"}], TraditionalForm]],ExpressionUUID->
  "97664100-1bc8-4a86-8946-5ee23e88ca67"],
 "s):"
}], "Subsubsection",
 CellChangeTimes->{{3.733841886251356*^9, 3.7338419278901157`*^9}, {
  3.7379218864016533`*^9, 3.737921888842204*^9}, {3.739204199468233*^9, 
  3.7392041997993298`*^9}},ExpressionUUID->"83393b69-ef95-427b-bfe9-\
34cc7352c217"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"optDataPoints", "=", 
     RowBox[{"assayDataSetNew2", "[", 
      RowBox[{"All", ",", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"\"\<DataPointsOptLinFit\>\"", "\[Rule]", 
           RowBox[{"optimizeLinFitPBP", "[", 
            RowBox[{"#Times", ",", 
             RowBox[{"#", "[", "\"\<TurnoverData (uM)\>\"", "]"}], ",", 
             "#SubstrateConc", ",", "30.0", ",", "0.30"}], "]"}]}]}], "]"}], 
        "&"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"optDataPoints", "=", 
    RowBox[{"withProgressCurves", "[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"\"\<DataPointsOptLinFit\>\"", "\[Rule]", 
          RowBox[{"optimizeLinFit", "[", 
           RowBox[{"#Times", ",", 
            RowBox[{"#", "[", "\"\<TurnoverTimepoints(uM)\>\"", "]"}], ",", 
            "#SubstrateConc", ",", 
            RowBox[{"Normal", "[", "#StdCurveSlope", "]"}], ",", 
            "#StdCurveIntercept", ",", "0.30"}], "]"}]}]}], "]"}], "&"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"optDataPoints2", "=", 
    RowBox[{"optDataPoints", "[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"Quiet", "[", 
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"fitOptimized", "[", "#DataPointsOptLinFit", "]"}]}], "]"}],
         "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}]}], "Input",
 CellChangeTimes->{{3.733841968135112*^9, 3.7338419930870333`*^9}, {
   3.733842033581826*^9, 3.733842088548485*^9}, {3.733842126506892*^9, 
   3.733842126795927*^9}, {3.73384217722064*^9, 3.7338422032433777`*^9}, {
   3.733842439552656*^9, 3.733842448762781*^9}, {3.7338430560800056`*^9, 
   3.733843070734223*^9}, {3.734030709962677*^9, 3.734030710970731*^9}, {
   3.734102015812273*^9, 3.734102073329945*^9}, {3.734102128345435*^9, 
   3.7341021291108837`*^9}, 3.734103100229019*^9, {3.734104186016677*^9, 
   3.7341041927509747`*^9}, {3.734140198097604*^9, 3.734140198531053*^9}, {
   3.7341891639313793`*^9, 3.7341892130582113`*^9}, {3.734189371875873*^9, 
   3.734189375915504*^9}, {3.734212005423595*^9, 3.734212005841793*^9}, {
   3.734212239193623*^9, 3.7342122451551113`*^9}, {3.7342122814627333`*^9, 
   3.7342122857772293`*^9}, {3.734212400175596*^9, 3.7342124005880833`*^9}, 
   3.734276031860869*^9, 3.734276065858754*^9, {3.734283180126869*^9, 
   3.7342831924214287`*^9}, 3.734288009980249*^9, {3.734288390453318*^9, 
   3.734288396013752*^9}, {3.734289034267872*^9, 3.734289034715716*^9}, 
   3.734292490568884*^9, {3.734530207641334*^9, 3.734530212563863*^9}, {
   3.7345642647577477`*^9, 3.734564266926696*^9}, {3.735063828522564*^9, 
   3.735063846247608*^9}, 3.73525375765287*^9, 3.735579770194434*^9, {
   3.736183302701256*^9, 3.736183309563961*^9}, {3.7369893538904457`*^9, 
   3.736989359498473*^9}, {3.736989859775029*^9, 3.736989863758395*^9}, {
   3.737307913781377*^9, 3.7373079185814953`*^9}, {3.7375706084455547`*^9, 
   3.737570609194273*^9}, {3.7376501896259937`*^9, 3.73765019199419*^9}, {
   3.737944144566246*^9, 3.737944148877248*^9}, {3.742148119231689*^9, 
   3.7421481218068666`*^9}, {3.7429106229698668`*^9, 3.7429106396218853`*^9}, 
   3.742913271019752*^9, 3.742913332989966*^9, 3.751999612194275*^9, {
   3.757111340573019*^9, 3.757111342623251*^9}},
 CellLabel->
  "In[432]:=",ExpressionUUID->"a8b62022-0b11-421c-8c76-1a28082b915a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "4. Exponential fits (cMUP) (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", "eval"], "=", "1046"}], TraditionalForm]],
  ExpressionUUID->"d5970f07-aee2-4bc0-9a4e-22a4c1206f60"],
 "s, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["t", "eval", "parallel"], "=", "277"}], 
   TraditionalForm]],ExpressionUUID->"87896780-7f9d-466d-b3cb-823975949023"],
 "s):"
}], "Section",
 CellChangeTimes->{{3.737932998707411*^9, 3.737933006233433*^9}, 
   3.737942174984274*^9, {3.737944841895262*^9, 3.737944865710137*^9}, {
   3.73920420841586*^9, 
   3.739204208723688*^9}},ExpressionUUID->"be703cf4-fc0f-4eba-8933-\
17df0a827e23"],

Cell[CellGroupData[{

Cell["4a. Implement parallelization", "Subsubsection",
 CellChangeTimes->{{3.732982122369422*^9, 3.73298212984267*^9}, {
  3.7335198368618307`*^9, 3.733519840007523*^9}, {3.733520332191161*^9, 
  3.7335203379182167`*^9}, {3.7335221789957314`*^9, 3.733522179567046*^9}, {
  3.733523573728622*^9, 3.733523582310413*^9}, {3.733524831539154*^9, 
  3.733524841053845*^9}, {3.737935306448166*^9, 3.737935313432274*^9}, {
  3.73794218472141*^9, 3.7379421901772833`*^9}, {3.73920420291214*^9, 
  3.7392042050988007`*^9}, {3.739204249549457*^9, 
  3.7392042497774553`*^9}},ExpressionUUID->"3fd01350-f90b-405e-8382-\
cca5f2b27724"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LaunchKernels", "[", "4", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numKernels", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"Kernels", "[", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toCalculate", "=", "optDataPoints2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"len", "=", 
    RowBox[{"Length", "[", "toCalculate", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chunksize", "=", 
   RowBox[{"Round", "[", 
    RowBox[{"len", "/", "numKernels"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"firstChunks", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"chunksize", "*", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}]}], ")"}], "+", "1"}], ",", " ", 
       RowBox[{"n", "*", "chunksize"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", " ", 
       RowBox[{"numKernels", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"intervals", "=", 
  RowBox[{"Append", "[", 
   RowBox[{"firstChunks", ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"chunksize", "*", 
         RowBox[{"(", 
          RowBox[{"numKernels", "-", "1"}], ")"}]}], ")"}], "+", "1"}], ",", 
      " ", 
      RowBox[{"Length", "[", "toCalculate", "]"}]}], "}"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.737942194609973*^9, 3.737942216411154*^9}, {
  3.7379422672437277`*^9, 3.737942267652307*^9}, {3.7390368546362057`*^9, 
  3.739036868968708*^9}, {3.752001799990901*^9, 3.752001800834352*^9}},
 CellLabel->
  "In[847]:=",ExpressionUUID->"49138dbc-91f2-421f-8c89-a57b80456354"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4b. Perform exponential fits", "Subsubsection",
 CellChangeTimes->{{3.732982122369422*^9, 3.73298212984267*^9}, {
  3.7335198368618307`*^9, 3.733519840007523*^9}, {3.733520332191161*^9, 
  3.7335203379182167`*^9}, {3.7335221789957314`*^9, 3.733522179567046*^9}, {
  3.733523573728622*^9, 3.733523582310413*^9}, {3.733524831539154*^9, 
  3.733524841053845*^9}, {3.737935306448166*^9, 3.737935313432274*^9}, {
  3.73794218472141*^9, 3.7379421901772833`*^9}, {3.73920420291214*^9, 
  3.73920425776026*^9}},ExpressionUUID->"7e1b16ad-aa62-4fc0-b266-\
f381d303b2d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chunked", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"toCalculate", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ";;", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "&"}], "/@", 
     "intervals"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exponentialFitWrapper", "[", "df_", "]"}], ":=", 
    RowBox[{"df", "[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<ExponentialFit\>\"", "\[Rule]", 
           RowBox[{"Quiet", "[", 
            RowBox[{"exponentialFit", "[", 
             RowBox[{"#Times", ",", 
              RowBox[{"#", "[", "\"\<TurnoverTimepoints(uM)\>\"", "]"}], ",", 
              "#SubstrateConc", ",", "#StdCurveSlope", ",", 
              "#StdCurveIntercept"}], "]"}], "]"}]}], "}"}]}], "]"}], "&"}]}],
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addExpFits", "=", 
    RowBox[{"Join", "@@", 
     RowBox[{"ParallelMap", "[", 
      RowBox[{"exponentialFitWrapper", ",", " ", "chunked"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allcoreTime", "=", 
   RowBox[{"tf", "-", "t0"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"addExpFits", "=", 
     RowBox[{"optDataPoints2", "[", 
      RowBox[{"All", ",", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<ExponentialFit\>\"", "\[Rule]", 
            RowBox[{"Quiet", "[", 
             RowBox[{"exponentialFitPBP", "[", 
              RowBox[{"#Times", ",", 
               RowBox[{"#", "[", "\"\<TurnoverData (uM)\>\"", "]"}], ",", 
               "#SubstrateConc", ",", "30.0"}], "]"}], "]"}]}], "}"}]}], 
         "]"}], "&"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"addExpFits", "=", 
     RowBox[{"optDataPoints2", "[", 
      RowBox[{"All", ",", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<ExponentialFit\>\"", "\[Rule]", 
            RowBox[{"Quiet", "[", 
             RowBox[{"exponentialFit", "[", 
              RowBox[{"#Times", ",", 
               RowBox[{"#", "[", "\"\<TurnoverTimepoints(uM)\>\"", "]"}], ",",
                "#SubstrateConc", ",", "#StdCurveSlope", ",", 
               "#StdCurveIntercept"}], "]"}], "]"}]}], "}"}]}], "]"}], 
        "&"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CloseKernels", "[", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "exportPath", ",", "outName", ",", "\"\<_working_2\>\"", ",", 
       "\"\<.mx\>\""}], "]"}], ",", "addExpFits"}], "]"}], "*)"}]}]}], "Input",\

 CellChangeTimes->{{3.733524825015667*^9, 3.733524950254587*^9}, 
   3.733525107959381*^9, {3.733525257256226*^9, 3.733525258393737*^9}, {
   3.733536591044949*^9, 3.733536601994522*^9}, {3.733536758149169*^9, 
   3.7335367851824083`*^9}, {3.733539610003603*^9, 3.733539614459094*^9}, {
   3.733539659887191*^9, 3.733539661760502*^9}, {3.7335396974774237`*^9, 
   3.73353969782694*^9}, {3.733539762363942*^9, 3.733539817446825*^9}, {
   3.733540087630085*^9, 3.733540088778327*^9}, {3.733678164022956*^9, 
   3.733678167798142*^9}, 3.73384386503576*^9, {3.734102711065818*^9, 
   3.734102724145734*^9}, {3.73410284059282*^9, 3.734102870783929*^9}, {
   3.734104231858851*^9, 3.734104252088538*^9}, {3.734104305723729*^9, 
   3.734104306071257*^9}, {3.73420264292292*^9, 3.734202648379595*^9}, {
   3.734212070007834*^9, 3.734212071075952*^9}, {3.734212180158289*^9, 
   3.734212219947329*^9}, {3.7342123397240477`*^9, 3.7342123451596518`*^9}, {
   3.734276157500095*^9, 3.7342761598484697`*^9}, {3.734276438094433*^9, 
   3.734276448496091*^9}, {3.734283225339991*^9, 3.734283233963277*^9}, {
   3.7342886958442574`*^9, 3.73428870172959*^9}, {3.734288963434135*^9, 
   3.7342889702029676`*^9}, {3.734289165564324*^9, 3.7342891660826063`*^9}, {
   3.734292759640684*^9, 3.734292761781427*^9}, {3.734292803266699*^9, 
   3.7342928955532293`*^9}, {3.7342931514839687`*^9, 3.734293151756518*^9}, {
   3.73453028772528*^9, 3.734530292525387*^9}, {3.735063862118473*^9, 
   3.735063867986094*^9}, {3.736183321701795*^9, 3.7361833262571907`*^9}, {
   3.7369894160467033`*^9, 3.736989420875956*^9}, {3.7373079243391848`*^9, 
   3.737307928899336*^9}, {3.737942152158564*^9, 3.737942159647745*^9}, {
   3.737942226240837*^9, 3.737942249996271*^9}, {3.7379422829524717`*^9, 
   3.737942286824456*^9}, {3.738025485320282*^9, 3.738025486683508*^9}, {
   3.7389525571026373`*^9, 3.738952564593059*^9}, {3.742911631370875*^9, 
   3.742911635480576*^9}, 3.742913401839665*^9},
 CellLabel->
  "In[854]:=",ExpressionUUID->"8fbc1de9-211a-4c72-a4c2-8e0fda11c9d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "5. Generate progress curve plots based on optimized fitting (intensities) (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", "eval"], "=", "800"}], TraditionalForm]],
  ExpressionUUID->"df523cec-42ac-41bb-8e7a-37441f7e3d3a"],
 "s,",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    RowBox[{
     SubsuperscriptBox["t", "eval", "parallel"], "=", "200"}]}], 
   TraditionalForm]],ExpressionUUID->"7f5d514a-50f3-4ee9-a188-eba0fcba051c"],
 "s):"
}], "Subsubsection",
 CellChangeTimes->{{3.732982122369422*^9, 3.73298212984267*^9}, {
  3.7335198368618307`*^9, 3.733519840007523*^9}, {3.733520332191161*^9, 
  3.7335203379182167`*^9}, {3.7338438233932753`*^9, 3.733843827234573*^9}, {
  3.737935317828081*^9, 3.737935320632677*^9}, {3.7379954388456*^9, 
  3.7379954477140827`*^9}, {3.739204212408636*^9, 3.739204213007395*^9}, {
  3.739204261042014*^9, 
  3.739204262267208*^9}},ExpressionUUID->"b5a10a85-42c8-40e5-a998-\
bbd7c06e8165"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LaunchKernels", "[", "4", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numKernels", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"Kernels", "[", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toCalculate", "=", "addExpFits"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"len", "=", 
    RowBox[{"Length", "[", "toCalculate", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chunksize", "=", 
   RowBox[{"Round", "[", 
    RowBox[{"len", "/", "numKernels"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"firstChunks", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"chunksize", "*", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}]}], ")"}], "+", "1"}], ",", " ", 
       RowBox[{"n", "*", "chunksize"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", " ", 
       RowBox[{"numKernels", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intervals", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"firstChunks", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"chunksize", "*", 
          RowBox[{"(", 
           RowBox[{"numKernels", "-", "1"}], ")"}]}], ")"}], "+", "1"}], ",", 
       " ", 
       RowBox[{"Length", "[", "toCalculate", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"withPCs", "=", 
     RowBox[{"addExpFits", "[", 
      RowBox[{"All", ",", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<ProgressCurveOptFit\>\"", "\[Rule]", 
            RowBox[{"Quiet", "[", 
             RowBox[{"makeProgressCurvePlotPBP", "[", 
              RowBox[{"#Times", ",", 
               RowBox[{"#", "[", "\"\<TurnoverData (uM)\>\"", "]"}], ",", 
               "#OptLinFitSlope", ",", 
               RowBox[{"#", "[", "\"\<OptLinFitIntercept\>\"", "]"}], ",", 
               "#DataPointsOptLinFit", ",", "#SubstrateConc", ",", "30.0", 
               ",", "1", ",", 
               RowBox[{"#ExponentialFit", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
         "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"withPCs", "=", 
     RowBox[{"addExpFits", "[", 
      RowBox[{"All", ",", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<ProgressCurveOptFit\>\"", "\[Rule]", 
            RowBox[{"Quiet", "[", 
             RowBox[{"makeProgressCurvePlot", "[", 
              RowBox[{"#Times", ",", 
               RowBox[{"#", "[", "\"\<TurnoverTimepoints(uM)\>\"", "]"}], ",",
                "#OptLinFitSlope", ",", 
               RowBox[{"#", "[", "\"\<OptLinFitIntercept\>\"", "]"}], ",", 
               "#DataPointsOptLinFit", ",", "#SubstrateConc", ",", 
               RowBox[{"#ExponentialFit", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
         "]"}], "&"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addExpFitsChunked", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"toCalculate", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ";;", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "&"}], "/@", 
     "intervals"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"progressCurvePlots", "=", 
    RowBox[{"Join", "@@", 
     RowBox[{"ParallelMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Association", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<Indices\>\"", "\[Rule]", 
              RowBox[{"Normal", "[", 
               RowBox[{"#", "[", 
                RowBox[{"n", ",", "\"\<Indices\>\""}], "]"}], "]"}]}], ",", 
             RowBox[{"\"\<ExpIndex\>\"", "\[Rule]", 
              RowBox[{"Normal", "[", 
               RowBox[{"#", "[", 
                RowBox[{"n", ",", "\"\<ExpIndex\>\""}], "]"}], "]"}]}], ",", 
             RowBox[{"\"\<ProgressCurveOptFit\>\"", "->", 
              RowBox[{"makeProgressCurvePlot", "[", 
               RowBox[{
                RowBox[{"Normal", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"n", ",", "\"\<Times\>\""}], "]"}], "]"}], ",", 
                RowBox[{"Normal", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"n", ",", "\"\<TurnoverTimepoints(uM)\>\""}], "]"}],
                  "]"}], ",", 
                RowBox[{"Normal", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"n", ",", "\"\<OptLinFitSlope\>\""}], "]"}], "]"}], 
                ",", 
                RowBox[{"Normal", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"n", ",", "\"\<OptLinFitIntercept\>\""}], "]"}], 
                 "]"}], ",", 
                RowBox[{"Normal", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"n", ",", "\"\<DataPointsOptLinFit\>\""}], "]"}], 
                 "]"}], ",", 
                RowBox[{"Normal", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"n", ",", "\"\<SubstrateConc\>\""}], "]"}], "]"}], 
                ",", 
                RowBox[{
                 RowBox[{"Normal", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"n", ",", "\"\<ExponentialFit\>\""}], "]"}], "]"}],
                  "[", 
                 RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}]}], "}"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "#", "]"}]}], "}"}]}], "]"}], "&"}], ",", 
       "addExpFitsChunked"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"progressCurvePlots", "=", 
     RowBox[{"Join", "@@", 
      RowBox[{"ParallelMap", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Association", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<Indices\>\"", "\[Rule]", 
               RowBox[{"Normal", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"n", ",", "\"\<Indices\>\""}], "]"}], "]"}]}], ",", 
              RowBox[{"\"\<ExpIndex\>\"", "\[Rule]", 
               RowBox[{"Normal", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"n", ",", "\"\<ExpIndex\>\""}], "]"}], "]"}]}], ",", 
              
              RowBox[{"\"\<ProgressCurveOptFit\>\"", "->", 
               RowBox[{"makeProgressCurvePlotPBP", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"n", ",", "\"\<Times\>\""}], "]"}], "]"}], ",", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"n", ",", "\"\<TurnoverData (uM)\>\""}], "]"}], 
                  "]"}], ",", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"n", ",", "\"\<OptLinFitSlope\>\""}], "]"}], "]"}],
                  ",", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"n", ",", "\"\<OptLinFitIntercept\>\""}], "]"}], 
                  "]"}], ",", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"n", ",", "\"\<DataPointsOptLinFit\>\""}], "]"}], 
                  "]"}], ",", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"n", ",", "\"\<SubstrateConc\>\""}], "]"}], "]"}], 
                 ",", "30.0", ",", "1", ",", 
                 RowBox[{
                  RowBox[{"Normal", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"n", ",", "\"\<ExponentialFit\>\""}], "]"}], 
                   "]"}], "[", 
                  RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}]}], "}"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"Length", "[", "#", "]"}]}], "}"}]}], "]"}], "&"}], ",", 
        "addExpFitsChunked"}], "]"}]}]}], ";"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"progressCurvePlots", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Association", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<Indices\>\"", "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"addExpFits", "[", 
             RowBox[{"n", ",", "\"\<Indices\>\""}], "]"}], "]"}]}], ",", 
          RowBox[{"\"\<ExpIndex\>\"", "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"addExpFits", "[", 
             RowBox[{"n", ",", "\"\<ExpIndex\>\""}], "]"}], "]"}]}], ",", 
          RowBox[{"\"\<ProgressCurveOptFit\>\"", "->", 
           RowBox[{"makeProgressCurvePlot", "[", 
            RowBox[{
             RowBox[{"Normal", "[", 
              RowBox[{"addExpFits", "[", 
               RowBox[{"n", ",", "\"\<Times\>\""}], "]"}], "]"}], ",", 
             RowBox[{"Normal", "[", 
              RowBox[{"addExpFits", "[", 
               RowBox[{"n", ",", "\"\<TurnoverTimepoints(uM)\>\""}], "]"}], 
              "]"}], ",", 
             RowBox[{"Normal", "[", 
              RowBox[{"addExpFits", "[", 
               RowBox[{"n", ",", "\"\<OptLinFitSlope\>\""}], "]"}], "]"}], 
             ",", 
             RowBox[{"Normal", "[", 
              RowBox[{"addExpFits", "[", 
               RowBox[{"n", ",", "\"\<OptLinFitIntercept\>\""}], "]"}], "]"}],
              ",", 
             RowBox[{"Normal", "[", 
              RowBox[{"addExpFits", "[", 
               RowBox[{"n", ",", "\"\<DataPointsOptLinFit\>\""}], "]"}], 
              "]"}], ",", 
             RowBox[{"Normal", "[", 
              RowBox[{"addExpFits", "[", 
               RowBox[{"n", ",", "\"\<SubstrateConc\>\""}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Normal", "[", 
               RowBox[{"addExpFits", "[", 
                RowBox[{"n", ",", "\"\<ExponentialFit\>\""}], "]"}], "]"}], 
              "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}]}], "}"}], "]"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"Length", "[", "addExpFits", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"withPCs", "=", 
    RowBox[{"Dataset", "[", 
     RowBox[{"JoinAcross", "[", 
      RowBox[{
       RowBox[{"Normal", "[", "addExpFits", "]"}], ",", "progressCurvePlots", 
       ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Indices\>\"", ",", "\"\<ExpIndex\>\""}], "}"}], ",", 
       "\"\<Left\>\""}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CloseKernels", "[", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}]}], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.733541568598658*^9, 3.733541578722908*^9}, {
   3.733579179116023*^9, 3.7335791887902737`*^9}, {3.7336737322524643`*^9, 
   3.733673734302352*^9}, {3.7336788891131077`*^9, 3.733678890793058*^9}, {
   3.7338446494024277`*^9, 3.73384468457856*^9}, 3.733844885891556*^9, {
   3.733844926540389*^9, 3.733844926818028*^9}, {3.733844987807495*^9, 
   3.733844988903393*^9}, {3.7341027584405212`*^9, 3.734102767097084*^9}, {
   3.734202662253459*^9, 3.7342026670200987`*^9}, {3.734277628838805*^9, 
   3.734277641249401*^9}, 3.7342776784205*^9, {3.734277780926309*^9, 
   3.734277800918448*^9}, {3.7342832397961283`*^9, 3.734283248826251*^9}, 
   3.734410047243732*^9, {3.7344102411783247`*^9, 3.734410247044869*^9}, {
   3.734530316718239*^9, 3.734530336548972*^9}, {3.734537528780539*^9, 
   3.7345375290217113`*^9}, {3.7350686519557257`*^9, 
   3.7350686573690853`*^9}, {3.735238736409395*^9, 3.73523873917117*^9}, {
   3.735240053307671*^9, 3.735240058254054*^9}, 3.7352537761896343`*^9, {
   3.736183340066271*^9, 3.736183361974292*^9}, {3.736989429372794*^9, 
   3.736989437144968*^9}, {3.737307934592119*^9, 3.737307940268078*^9}, {
   3.737742668696254*^9, 3.737742670644547*^9}, {3.7379207736352043`*^9, 
   3.737920806602516*^9}, {3.737920860035152*^9, 3.737920876620503*^9}, {
   3.737945002175744*^9, 3.737945004503821*^9}, {3.737994872335554*^9, 
   3.737994898474331*^9}, {3.73799493855445*^9, 3.737994943558105*^9}, {
   3.7389525825779047`*^9, 3.738952589603302*^9}, {3.738952673248068*^9, 
   3.7389526842517548`*^9}, {3.739037097005365*^9, 3.739037120755109*^9}, {
   3.740965577823524*^9, 3.7409655819598103`*^9}, {3.752003276063656*^9, 
   3.752003287472907*^9}, {3.752804316069544*^9, 3.7528043162520103`*^9}},
 CellLabel->
  "In[863]:=",ExpressionUUID->"179ae7d0-b320-4a9e-9721-ee7c827c970b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "6. Calculate local background interpolations, append to the dataset (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", "eval"], "=", "25"}], TraditionalForm]],ExpressionUUID->
  "c17caa62-fef9-4be3-9086-5da5d68e0d04"],
 "s):"
}], "Section",
 CellChangeTimes->{{3.733588097841146*^9, 3.733588102836062*^9}, {
  3.7335978406785727`*^9, 3.7335978498768272`*^9}, {3.737921410496677*^9, 
  3.73792141315346*^9}, {3.737921490072858*^9, 3.737921521317873*^9}, {
  3.739204266407325*^9, 
  3.7392042668780537`*^9}},ExpressionUUID->"0ec943ab-e138-4783-8a7e-\
21fdc19d6b49"],

Cell[BoxData[{
 RowBox[{"Dynamic", "[", "n", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dynamic", "[", "column", "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"datasetIN", "=", "withPCs"}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"datasetIN", "=", "withPCs"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inhibitorconcentrations", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"datasetIN", "[", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"#Indices", "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "&"}], "]"}], ",", 
      "\"\<InhibitorConcentrations\>\""}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"substrateconcentrations", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"datasetIN", "[", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"#Indices", "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "&"}], "]"}], ",", 
      "\"\<SubstrateConc\>\""}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"type", "=", 
    RowBox[{"Normal", "[", 
     RowBox[{"datasetIN", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"#Indices", "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "&"}], "]"}], ",", 
       "\"\<AssayType\>\""}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mutantList", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<T79G\>\"", ",", "\"\<K162A\>\"", ",", "\"\<Skipped\>\""}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataset2", "=", "datasetIN"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interpolations", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Association", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<x\>\"", "\[Rule]", "column"}], ",", 
           RowBox[{"\"\<ExpIndex\>\"", "\[Rule]", "n"}], ",", 
           RowBox[{"\"\<AssayType\>\"", "\[Rule]", 
            RowBox[{"type", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Interpolation\>\"", "->", 
            RowBox[{"interpolateDeadMutantsPerColumn", "[", 
             RowBox[{
             "mutantList", ",", "n", ",", "column", ",", "dataset2", ",", 
              "\"\<OptLinFitSlope\>\""}], "]"}]}], ",", 
           RowBox[{
           "\"\<MutantsUsedForLocalBG\>\"", "\[Rule]", "mutantList"}]}], 
          "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "substrateconcentrations", "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"column", ",", "1", ",", "28"}], "}"}]}], "]"}], ",", "1"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataset3", "=", 
    RowBox[{"Dataset", "[", 
     RowBox[{"JoinAcross", "[", 
      RowBox[{
       RowBox[{"Normal", "[", "dataset2", "]"}], ",", "interpolations", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<x\>\"", ",", "\"\<ExpIndex\>\"", ",", "\"\<AssayType\>\""}], 
        "}"}], ",", "\"\<Left\>\""}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"dataset3", "=", 
    RowBox[{"dataset2", "[", 
     RowBox[{
      RowBox[{"1", ";;", "10"}], ",", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<BackgroundInterpolation\>\"", "\[Rule]", 
           RowBox[{"Quiet", "[", 
            RowBox[{"interpolateDeadMutantsPerColumn", "[", 
             RowBox[{"mutantList", ",", "#SubstrateConc", ",", 
              RowBox[{"#Indices", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "dataset2", ",", 
              "\"\<Rate (uM/s)\>\""}], "]"}], "]"}]}], "}"}]}], "]"}], 
       "&"}]}], "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.73359786857764*^9, 3.733597939612916*^9}, {
   3.733597982541931*^9, 3.733597998571398*^9}, {3.7335980738075743`*^9, 
   3.733598100896803*^9}, {3.7335982346688538`*^9, 3.733598254978917*^9}, {
   3.733598322939097*^9, 3.733598350618823*^9}, {3.733598436187118*^9, 
   3.7335984566036673`*^9}, {3.733598508476384*^9, 3.733598508921424*^9}, {
   3.7335987355375443`*^9, 3.733598739163834*^9}, {3.733598793003971*^9, 
   3.733598863021151*^9}, {3.733598958247972*^9, 3.733598973401754*^9}, {
   3.733599016587936*^9, 3.733599036448422*^9}, {3.733599083195222*^9, 
   3.733599096669313*^9}, {3.733599152285111*^9, 3.733599208211561*^9}, 
   3.733599768772525*^9, 3.7336016078082323`*^9, {3.733601797199623*^9, 
   3.7336017973509912`*^9}, {3.733601921948431*^9, 3.733601924118101*^9}, {
   3.733602372780608*^9, 3.733602480980875*^9}, {3.733607785715536*^9, 
   3.733607899216687*^9}, {3.733608475166788*^9, 3.73360848047974*^9}, 
   3.733608835875473*^9, 3.733686803813751*^9, {3.7338436941583843`*^9, 
   3.733843696888975*^9}, {3.733845104293194*^9, 3.7338451388784122`*^9}, {
   3.7341086011762953`*^9, 3.734108608440586*^9}, {3.7341086826614122`*^9, 
   3.734108705532113*^9}, {3.7341088584811287`*^9, 3.73410888337792*^9}, {
   3.734139787733283*^9, 3.7341397947318*^9}, {3.73414021986346*^9, 
   3.7341402500782337`*^9}, {3.734140333980262*^9, 3.734140342532544*^9}, 
   3.734140579875409*^9, {3.734140646293427*^9, 3.7341406539811077`*^9}, {
   3.7341407385820007`*^9, 3.734140739941018*^9}, {3.734203893113785*^9, 
   3.7342039035954*^9}, {3.73421261216719*^9, 3.734212615892418*^9}, 
   3.734278554409746*^9, {3.7349639442561007`*^9, 3.73496395688518*^9}, {
   3.73523957673558*^9, 3.735239585668314*^9}, {3.737577696854107*^9, 
   3.737577701355109*^9}, 3.73758026895331*^9, 3.737652630590711*^9, 
   3.737921407348794*^9, {3.7379214476305923`*^9, 3.737921454524596*^9}, 
   3.737998174639431*^9, {3.7383555389500713`*^9, 3.7383555391238623`*^9}, {
   3.738952961073773*^9, 3.738952963946784*^9}, {3.742919830974094*^9, 
   3.742919858311451*^9}, {3.742919922135025*^9, 3.742919923140024*^9}, {
   3.742919971961835*^9, 3.742919978989252*^9}, {3.752003616404582*^9, 
   3.75200362725287*^9}, {3.75200366459974*^9, 3.752003666065516*^9}, {
   3.7520038437353907`*^9, 3.752003855495647*^9}, {3.752023343963698*^9, 
   3.752023345578506*^9}, 3.7527098190349092`*^9, 3.752799786708481*^9},
 CellLabel->
  "In[876]:=",ExpressionUUID->"3efefcf1-c2a7-4658-bcf5-b564a8826099"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "7. Append local background ratio (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", "eval"], "=", "12"}], TraditionalForm]],ExpressionUUID->
  "aba898a2-6019-4bdf-b3a9-562a00757469"],
 "s):"
}], "Section",
 CellChangeTimes->{{3.734969801636773*^9, 3.734969848836969*^9}, {
  3.735241101524466*^9, 3.735241106098493*^9}, {3.737922201431005*^9, 
  3.737922205881567*^9}, {3.739204269129055*^9, 
  3.739204269436789*^9}},ExpressionUUID->"13b5a6ab-d4dd-47e5-82c5-\
fe8d59cc8447"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"dataset4", "=", 
     RowBox[{"dataset3", "[", 
      RowBox[{"All", ",", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<LocalBackgroundRatio\>\"", "\[Rule]", 
            RowBox[{"Quiet", "[", 
             RowBox[{"calculateLocalBGRatio", "[", 
              RowBox[{
              "#Indices", ",", "#ExpIndex", ",", "#Interpolation", ",", 
               "dataset3", ",", "\"\<OptLinFitSlope\>\""}], "]"}], "]"}]}], 
           "}"}]}], "]"}], "&"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataset", "=", "dataset3"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp", "=", 
    RowBox[{"Values", "[", 
     RowBox[{"Normal", "[", 
      RowBox[{"dataset", "[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Indices\>\"", ",", "\"\<ExpIndex\>\"", ",", 
          "\"\<OptLinFitSlope\>\"", ",", "\"\<MutantID\>\"", ",", 
          "\"\<Interpolation\>\""}], "}"}]}], "]"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"localBGs", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Association", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Indices\>\"", "\[Rule]", 
          RowBox[{"temp", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"\"\<ExpIndex\>\"", "\[Rule]", 
          RowBox[{"temp", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "2"}], "]"}], "]"}]}], ",", 
         RowBox[{"\"\<LocalBackgroundRatio\>\"", "->", 
          RowBox[{
           RowBox[{"temp", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "3"}], "]"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"temp", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "5", ",", 
               RowBox[{"temp", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
             "]"}], ")"}]}]}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", 
        RowBox[{"Length", "[", "temp", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"withlocalBG", "=", 
    RowBox[{"Dataset", "[", 
     RowBox[{"JoinAcross", "[", 
      RowBox[{
       RowBox[{"Normal", "[", "dataset", "]"}], ",", "localBGs", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Indices\>\"", ",", "\"\<ExpIndex\>\""}], "}"}], ",", 
       "\"\<Left\>\""}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}]}], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.733609022044655*^9, 3.733609129361319*^9}, 
   3.733609216589387*^9, {3.733609890275778*^9, 3.733609904486434*^9}, {
   3.733609994976199*^9, 3.733609995396483*^9}, {3.7336103614633913`*^9, 
   3.733610362014822*^9}, {3.7336104136690063`*^9, 3.733610414042047*^9}, {
   3.733610489026368*^9, 3.7336104893209457`*^9}, 3.7336872344942503`*^9, {
   3.7338451755070753`*^9, 3.733845177691243*^9}, {3.7338484666165752`*^9, 
   3.733848478627953*^9}, {3.733848595453981*^9, 3.733848595609212*^9}, {
   3.733848778192461*^9, 3.7338487785952578`*^9}, {3.734140822332056*^9, 
   3.7341408688425713`*^9}, {3.734140919612362*^9, 3.734140920219751*^9}, {
   3.7341410093735657`*^9, 3.7341410098957043`*^9}, {3.734203950418494*^9, 
   3.734203963277145*^9}, {3.737922112818245*^9, 3.7379221762863407`*^9}},
 CellLabel->
  "In[888]:=",ExpressionUUID->"db82f1c4-85cc-4ba4-b030-7c0b55e0d71b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "8. Append plots of local background at the chosen substrate concentration \
(should be highest [S]) (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", "eval"], "=", "229"}], TraditionalForm]],
  ExpressionUUID->"0e56115c-76c4-4cda-a666-858152ff473a"],
 "s,",
 Cell[BoxData[
  FormBox[
   RowBox[{"  ", 
    RowBox[{
     SubsuperscriptBox["t", "eval", "parallel"], "=", "34"}]}], 
   TraditionalForm]],ExpressionUUID->"ab5cbf27-acbf-4922-98f0-fe4f3332f853"],
 "s):"
}], "Section",
 CellChangeTimes->{{3.733621201347958*^9, 3.733621206447814*^9}, {
  3.737936327501598*^9, 3.73793635445048*^9}, {3.73799984414053*^9, 
  3.737999849316189*^9}, {3.73808473279243*^9, 3.738084740127939*^9}, {
  3.739204272782138*^9, 
  3.73920427325891*^9}},ExpressionUUID->"e86bae5e-30a3-4231-a170-\
c58a9d7babd1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "4", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numKernels", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"Kernels", "[", "]"}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"dataset2", "=", 
     RowBox[{"withlocalBG", "[", 
      RowBox[{"All", ",", 
       RowBox[{"KeyMap", "[", 
        RowBox[{
         RowBox[{"StringReplace", "[", 
          RowBox[{"#", ",", 
           RowBox[{
           "\"\<eGFPSummedI\>\"", "\[Rule]", "\"\<eGFPSummedI_x\>\""}]}], 
          "]"}], "&"}], "]"}]}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataset2", "=", "withlocalBG"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boundingMutants", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<WT\>\"", ",", "\"\<T79S\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rateKey", "=", "\"\<OptLinFitSlope\>\""}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "set", " ", "which", " ", "experiment", " ", "if", " ", "not", " ", "set", 
    " ", "at", " ", "the", " ", "top"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"whichExpt", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp", "=", 
    RowBox[{"dataset2", "[", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"#ExpIndex", "\[Equal]", "whichExpt"}], "&"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Indices\>\"", ",", "\"\<ExpIndex\>\"", ",", 
        "\"\<OptLinFitSlope\>\"", ",", "\"\<MutantID\>\"", ",", 
        "\"\<Interpolation\>\""}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"len", "=", 
    RowBox[{"Length", "[", "temp", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chunksize", "=", 
   RowBox[{"Round", "[", 
    RowBox[{"len", "/", "numKernels"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"firstChunks", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"chunksize", "*", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}]}], ")"}], "+", "1"}], ",", " ", 
       RowBox[{"n", "*", "chunksize"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", " ", 
       RowBox[{"numKernels", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"newIntervals", "=", 
    RowBox[{"Append", "[", 
     RowBox[{"firstChunks", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"chunksize", "*", 
           RowBox[{"(", 
            RowBox[{"numKernels", "-", "1"}], ")"}]}], ")"}], "+", "1"}], ",",
         " ", "len"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tempChunked", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"temp", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ";;", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "&"}], "/@", 
     "newIntervals"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"upperBound", "=", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"Values", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"dataset2", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#MutantID", "\[Equal]", 
              RowBox[{"boundingMutants", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
             RowBox[{"#ExpIndex", "\[Equal]", "whichExpt"}], "&&", 
             RowBox[{"#eGFPSummedI", ">", 
              RowBox[{"0.5", "*", "eGFPslope"}]}]}], "&"}], "]"}], ",", 
          RowBox[{"{", "rateKey", "}"}]}], "]"}], "]"}], "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lowerBound", "=", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"Values", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"dataset2", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#MutantID", "\[Equal]", 
              RowBox[{"boundingMutants", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
             RowBox[{"#ExpIndex", "\[Equal]", "whichExpt"}], "&&", 
             RowBox[{"#eGFPSummedI", ">", 
              RowBox[{"0.5", "*", "eGFPslope"}]}]}], "&"}], "]"}], ",", 
          RowBox[{"{", "rateKey", "}"}]}], "]"}], "]"}], "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"allinColumn", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"Values", "[", 
         RowBox[{"Normal", "[", 
          RowBox[{"dataset2", "[", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#Indices", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "column"}], "&&", 
               RowBox[{"#ExpIndex", "\[Equal]", "whichExpt"}]}], "&"}], "]"}],
             ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Indices\>\"", ",", "rateKey", ",", "\"\<MutantID\>\""}], 
             "}"}]}], "]"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "<", 
          RowBox[{"#2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "&"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"column", ",", "1", ",", "28"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp2", "=", 
    RowBox[{"Join", "@@", 
     RowBox[{"ParallelMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Association", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<Indices\>\"", "\[Rule]", 
              RowBox[{"Normal", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"\"\<MaxLocalBackgroundPlot\>\"", "\[Rule]", 
              RowBox[{"generateLocalBGPlot", "[", 
               RowBox[{
                RowBox[{"Normal", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"n", ",", "\"\<Indices\>\""}], "]"}], "]"}], ",", 
                RowBox[{"Normal", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"n", ",", "\"\<ExpIndex\>\""}], "]"}], "]"}], ",", 
                RowBox[{"Normal", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"n", ",", "\"\<Interpolation\>\""}], "]"}], "]"}]}],
                "]"}]}]}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "#", "]"}]}], "}"}]}], "]"}], "&"}], ",", 
       "tempChunked"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"withlocalBGPlots", "=", 
    RowBox[{"Dataset", "[", 
     RowBox[{"JoinAcross", "[", 
      RowBox[{
       RowBox[{"Normal", "[", "dataset2", "]"}], ",", "temp2", ",", 
       RowBox[{"{", "\"\<Indices\>\"", "}"}], ",", "\"\<Left\>\""}], "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"dataset6", "=", 
     RowBox[{"dataset4", "[", 
      RowBox[{"All", ",", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<LocalBackgroundPlot\>\"", "\[Rule]", 
            RowBox[{"Quiet", "[", 
             RowBox[{"generateLocalBGPlot", "[", 
              RowBox[{
              "#Indices", ",", "#ExpIndex", ",", "#Interpolation", ",", 
               RowBox[{"{", 
                RowBox[{"\"\<WT\>\"", ",", "\"\<T79S\>\""}], "}"}], ",", 
               "dataset4", ",", "\"\<OptLinFitSlope\>\""}], "]"}], "]"}]}], 
           "}"}]}], "]"}], "&"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}]}], "Input",
 CellChangeTimes->{{3.73361624319683*^9, 3.733616246583975*^9}, {
   3.7336167207957582`*^9, 3.733616722480953*^9}, {3.73361683671169*^9, 
   3.7336168409706078`*^9}, {3.733620634815119*^9, 3.733620694691793*^9}, {
   3.7336207304675817`*^9, 3.7336207336315317`*^9}, {3.7336210662332287`*^9, 
   3.733621082204974*^9}, {3.7336211518541327`*^9, 3.733621157520652*^9}, {
   3.73362119690448*^9, 3.733621197668681*^9}, 3.733687244703673*^9, 
   3.733845214089003*^9, {3.733848683523692*^9, 3.733848722668034*^9}, {
   3.734141782894987*^9, 3.734141791496971*^9}, 3.734147411328787*^9, {
   3.734147470361533*^9, 3.734147474672205*^9}, {3.734147552810513*^9, 
   3.734147586529479*^9}, {3.7342039644550257`*^9, 3.734203971739805*^9}, {
   3.734204422282423*^9, 3.734204422505872*^9}, {3.7349671213150463`*^9, 
   3.734967121560965*^9}, {3.7352401094607573`*^9, 3.735240110721985*^9}, {
   3.7352401673127947`*^9, 3.735240171264042*^9}, {3.7377646836909447`*^9, 
   3.7377646873338823`*^9}, {3.7378316490837803`*^9, 
   3.7378316658877087`*^9}, {3.737922417498172*^9, 3.737922436589609*^9}, {
   3.73792251391254*^9, 3.737922516835883*^9}, {3.7379354046574802`*^9, 
   3.737935447156444*^9}, {3.7379355114286003`*^9, 3.7379356030124197`*^9}, {
   3.737935641506192*^9, 3.737935676717342*^9}, {3.737935707007238*^9, 
   3.737935841004964*^9}, {3.737935940987874*^9, 3.7379360201696978`*^9}, {
   3.737936078787651*^9, 3.73793614841568*^9}, {3.737936180319833*^9, 
   3.737936182177354*^9}, {3.737936225834771*^9, 3.7379363212046556`*^9}, {
   3.737998427825356*^9, 3.737998450816229*^9}, 3.737998520887046*^9, 
   3.73799862224146*^9, {3.73799868150412*^9, 3.737998708327834*^9}, {
   3.737998755858378*^9, 3.737998769987905*^9}, {3.7379991770079203`*^9, 
   3.7379991827673693`*^9}, 3.73799943928903*^9, {3.737999510926559*^9, 
   3.7379995131904907`*^9}, {3.737999559203096*^9, 3.737999593180778*^9}, {
   3.73799983331536*^9, 3.7379998334646397`*^9}, {3.738024430522559*^9, 
   3.738024475098681*^9}, {3.738024683658922*^9, 3.738024696139647*^9}, {
   3.738026244473164*^9, 3.7380262496310577`*^9}, {3.738026317269556*^9, 
   3.7380263333094788`*^9}, {3.7380307978640623`*^9, 
   3.7380307981256847`*^9}, {3.73808430626709*^9, 3.738084329130643*^9}, {
   3.738084363279448*^9, 3.738084473621875*^9}, {3.738084533712823*^9, 
   3.7380845357539873`*^9}, {3.738084646806871*^9, 3.73808464834455*^9}, 
   3.7380849488902473`*^9, 3.7383567094610453`*^9, {3.738953093984069*^9, 
   3.738953134169972*^9}, {3.739038269684863*^9, 3.739038272197061*^9}, 
   3.7409673012347183`*^9, {3.742056816970832*^9, 3.7420568267275467`*^9}, {
   3.742920137502884*^9, 3.742920147226715*^9}, {3.759088471162161*^9, 
   3.75908847128218*^9}, {3.759088537808701*^9, 3.759088557373226*^9}, {
   3.7593434465608187`*^9, 3.759343455474012*^9}},
 CellLabel->
  "In[894]:=",ExpressionUUID->"e31ad947-1d98-4516-b7cc-65c687aa5149"]
}, Open  ]],

Cell[CellGroupData[{

Cell["9. Append post-SDS eGFP images:", "Section",
 CellChangeTimes->{{3.7349674128747053`*^9, 3.7349674191287203`*^9}, {
  3.739204277529202*^9, 
  3.739204278020602*^9}},ExpressionUUID->"337c1a85-9ab8-413b-9101-\
65978ef2e360"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dynamic", "[", "n", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"grouped", "=", 
    RowBox[{"withlocalBGPlots", "[", 
     RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"indicesOut", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Values", "[", "#", "]"}], "&"}], "/@", 
     RowBox[{"Values", "[", 
      RowBox[{"Normal", "[", 
       RowBox[{"grouped", "[", 
        RowBox[{"All", ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<MutantID\>\"", ",", "\"\<Indices\>\""}], "}"}]}], 
        "]"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adjustedImage", "=", 
    RowBox[{"ImageAdjust", "[", 
     RowBox[{"rawImageIn", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "150"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addedImages", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Association", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<MutantID\>\"", "\[Rule]", 
          RowBox[{"indicesOut", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"\"\<Indices\>\"", "\[Rule]", 
          RowBox[{"indicesOut", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "2"}], "]"}], "]"}]}], ",", 
         RowBox[{"\"\<eGFPPostSDSImage\>\"", "\[Rule]", 
          RowBox[{"ImageTake", "[", 
           RowBox[{"adjustedImage", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"indicesOut", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "2", ",", "2"}], "]"}], "]"}], "-", 
                 "1"}], ")"}], "*", "102"}], ",", 
              RowBox[{
               RowBox[{"indicesOut", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "2", ",", "2"}], "]"}], "]"}], "*", 
               "102"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"indicesOut", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "2", ",", "1"}], "]"}], "]"}], "-", 
                 "1"}], ")"}], "*", "102"}], ",", 
              RowBox[{
               RowBox[{"indicesOut", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "2", ",", "1"}], "]"}], "]"}], "*", 
               "102"}]}], "}"}]}], "]"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", "1568"}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addedImagesDataset", "=", 
    RowBox[{
     RowBox[{"Dataset", "[", 
      RowBox[{"JoinAcross", "[", 
       RowBox[{
        RowBox[{"Normal", "[", "withlocalBGPlots", "]"}], ",", "addedImages", 
        ",", "\"\<Indices\>\"", ",", "\"\<Left\>\""}], "]"}], "]"}], "//", 
     "Quiet"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}]}], "Input",
 CellChangeTimes->{{3.73496745461769*^9, 3.734967528383065*^9}, {
   3.734967950187125*^9, 3.734967957854609*^9}, {3.734968086903789*^9, 
   3.7349680877266283`*^9}, {3.735242742308928*^9, 3.7352427509907217`*^9}, {
   3.735245164153387*^9, 3.7352451711081867`*^9}, {3.736192318331418*^9, 
   3.736192346132526*^9}, 3.737325845874213*^9, {3.737760681506144*^9, 
   3.7377606834051657`*^9}, {3.737831676301692*^9, 3.737831697480495*^9}, {
   3.738084787578978*^9, 3.738084791239214*^9}, {3.7380850451041718`*^9, 
   3.738085047527832*^9}, {3.738085180333333*^9, 3.7380851825208893`*^9}, {
   3.739052668767407*^9, 3.739052783619039*^9}, {3.739052847104241*^9, 
   3.7390528569524384`*^9}, {3.7390528886485043`*^9, 3.739052901500825*^9}, {
   3.7390529538140993`*^9, 3.739052960321878*^9}, {3.73920435286624*^9, 
   3.7392043535769663`*^9}, {3.7404291916242437`*^9, 3.740429192603011*^9}, {
   3.740429255710836*^9, 3.740429257102681*^9}, {3.7411041283097258`*^9, 
   3.7411041288287497`*^9}, {3.7411041890985518`*^9, 
   3.7411041893498793`*^9}, {3.7413133886625433`*^9, 
   3.7413133900727177`*^9}, {3.741313505425859*^9, 3.741313505934067*^9}, {
   3.7413135856565332`*^9, 3.741313586011772*^9}, {3.742152044490572*^9, 
   3.7421520463338842`*^9}, {3.74216179213186*^9, 3.7421617927411757`*^9}, {
   3.742162705222425*^9, 3.7421627056842737`*^9}, {3.742322669344986*^9, 
   3.742322670304879*^9}, {3.7423982455569143`*^9, 3.74239824643255*^9}, {
   3.742920283732155*^9, 3.742920298611327*^9}, {3.742920522488365*^9, 
   3.7429205236921587`*^9}, {3.7429224027521687`*^9, 3.742922410962484*^9}, {
   3.7429235042650547`*^9, 3.742923509857777*^9}},
 CellLabel->
  "In[530]:=",ExpressionUUID->"be21ad37-c587-491d-b59f-48d36e20a5f3"],

Cell[CellGroupData[{

Cell["\<\
10. Identify bad eGFP finds:

10a. Manually flag chambers for which button finding failed.\
\>", "Subsubsection",
 CellChangeTimes->{{3.7349674128747053`*^9, 3.7349674191287203`*^9}, {
  3.739125746881961*^9, 3.7391257672629757`*^9}, {3.739128916193761*^9, 
  3.739128943780056*^9}, {3.739204280212883*^9, 
  3.739204288896399*^9}},ExpressionUUID->"c4fe18e6-ba2d-4fba-8b9b-\
53f0286afc96"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"eGFPslope", "=", 
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{"datasetIN", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#Indices", "\[Equal]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "&&", 
           RowBox[{"#ExpIndex", "\[Equal]", "1"}]}], "&"}], "]"}], ",", 
        "\"\<eGFPSlope\>\""}], "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testAll", "=", 
   RowBox[{"Values", "[", 
    RowBox[{"Normal", "[", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"addedImagesDataset", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"#ExpIndex", "\[Equal]", "1"}], "&"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Indices\>\"", ",", "\"\<eGFPPostSDSImage\>\"", ",", 
          "\"\<eGFPSummedI\>\""}], "}"}]}], "]"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "/", "eGFPslope"}]}], "}"}], "&"}], "/@", 
    RowBox[{"Sort", "[", 
     RowBox[{"testAll", ",", 
      RowBox[{
       RowBox[{"Order", "[", 
        RowBox[{
         RowBox[{"#1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test3", "=", 
    RowBox[{"Sort", "[", 
     RowBox[{"test2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ">", 
        RowBox[{"#2", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"manualCullingList", "=", 
    RowBox[{"{", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dynamic", "[", 
   RowBox[{"manualCullingList", ",", 
    RowBox[{"UpdateInterval", "\[Rule]", "1"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"DynamicModule", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", "=", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"n", "=", "n"}], "}"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{
            RowBox[{"TableForm", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ImageResize", "[", 
                RowBox[{
                 RowBox[{"test3", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "50"}], "]"}], 
               ",", 
               RowBox[{"test3", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"manualCullingList", ",", 
                  RowBox[{"Evaluate", "[", 
                   RowBox[{"test3", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
                "\[Equal]", "True"}], ",", 
               RowBox[{
                RowBox[{"manualCullingListNew", "=", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"manualCullingList", ",", 
                   RowBox[{"Evaluate", "[", 
                    RowBox[{"test3", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], 
                ";", 
                RowBox[{"manualCullingList", "=", "manualCullingListNew"}]}], 
               ",", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"manualCullingList", ",", 
                 RowBox[{"Evaluate", "[", 
                  RowBox[{"test3", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], 
              "]"}], ";", 
             RowBox[{"xnew", "=", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"x", "\[Equal]", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"x", "\[Equal]", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"x", "=", "xnew"}], ";"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"Background", "\[Rule]", 
             RowBox[{"Dynamic", "[", 
              RowBox[{"RGBColor", "[", "x", "]"}], "]"}]}]}], "]"}]}], 
         "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", "1568"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", "14", "}"}]}], "]"}], "]"}]}], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.739125866911808*^9, 3.739125875422948*^9}, {
   3.742922486793069*^9, 3.742922492329403*^9}, 3.742923962585208*^9},
 CellLabel->
  "In[191]:=",ExpressionUUID->"b3daf789-4835-494c-9166-b6b4c6148df0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Export manualCullingList, so that it can be used for other assays acquired \
using the same device (make sure path is correct):\
\>", "Subsubsection",
 CellChangeTimes->{{3.741105041582449*^9, 3.741105056726954*^9}, {
  3.756424186474568*^9, 
  3.7564241919313583`*^9}},ExpressionUUID->"1c2ed1e4-ea0b-4371-994c-\
4d2ae4318bae"],

Cell[BoxData[
 RowBox[{"safeExport", "[", 
  RowBox[{
   RowBox[{
   "\"\</Users/craig/atlas/media/dmokhtari/Atlas-HDD/eMITOMI_Processed/PafA_\
GlyScan/perChip_ManualGFPFlagging/\>\"", "<>", 
    "\"\<190123_S2d1_PafA_GlyScan_ManualGFPFlag.csv\>\""}], ",", 
   "manualCullingList"}], "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ/eZGdMn0+68dzxyWLQfRJs9l60C02LaIRhD98SlP
7UEgzZUuBKY/rdCq+wuk/1k/AtOiTw7uynj42vGvXe8eED1nTqfOKyB9x30W
mJ4necwQRN/LeGcEotXiLk3mf/Ta8XrMjqkguiE5MEAMSJdNjwTT7muNth8E
0jsv6u0C0azOXX53gHT23I1g+oH7EkmBx68dU/bLSIFoecXXDYlfXjueE7/W
CKK/ns578+zra8cbxW0fQPS5J7/qzv957bhixrtGEG1SkLWA//9rx103JBeC
6Aj1reclgTTT1R1gepNolKYikP6z2UwLRKsqcTKoAOmlt54wgeiK1Q7HsoD0
o9Bjx0H0MRctv1wgfe2rgD+Ilr6+sa4KpO4vcwOILtu04sQ/1jeOEasvg2kA
AcrXkA==
  "],
 CellLabel->
  "In[980]:=",ExpressionUUID->"fafe4e52-78d7-4e37-b25f-41612042142f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
10b. Append manual flag to the dataset, if satisfied that all bad chambers \
have been selected (clicked):\
\>", "Subsubsection",
 CellChangeTimes->{{3.7349674128747053`*^9, 3.7349674191287203`*^9}, {
  3.739125785441639*^9, 3.7391257912461433`*^9}, {3.739126616656376*^9, 
  3.739126635428307*^9}, {3.7391289546367826`*^9, 3.7391289556745653`*^9}, {
  3.7392043016163177`*^9, 
  3.739204303582053*^9}},ExpressionUUID->"2af24838-cd92-46da-9d14-\
c91424f31a41"],

Cell["\<\
If the eGFP spots have been manually culled as part of this session, comment \
out the first line below as the 'manualCullingList' is already loaded in the \
kernel. If this is a different experiment and the manual culling has already \
been performed for this chip, then uncomment the first line to read in the \
pertinent '*_ManualGFPFlag.csv' file from disk.\
\>", "Text",
 CellChangeTimes->{{3.756438289024006*^9, 
  3.756438400865363*^9}},ExpressionUUID->"5c153538-adb9-4144-8b7b-\
a287b832adc1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"manualCullingList", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
      "\"\</Users/craig/atlas/media/dmokhtari/Atlas-HDD/eMITOMI_Processed/\
PafA_ValScan/perChip_ManualGFPFlagging/\>\"", "<>", 
       "\"\<180528_S3d1_PafA_ValScan_ManualGFPFlag.csv\>\""}], ",", 
      "\"\<Data\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eGFPslope", "=", 
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{"datasetIN", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#Indices", "\[Equal]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "&&", 
           RowBox[{"#ExpIndex", "\[Equal]", "1"}]}], "&"}], "]"}], ",", 
        "\"\<eGFPSlope\>\""}], "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testAll", "=", 
   RowBox[{"Values", "[", 
    RowBox[{"Normal", "[", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"addedImagesDataset", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"#ExpIndex", "\[Equal]", "1"}], "&"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Indices\>\"", ",", "\"\<eGFPPostSDSImage\>\"", ",", 
          "\"\<eGFPSummedI\>\""}], "}"}]}], "]"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "/", "eGFPslope"}]}], "}"}], "&"}], "/@", 
    RowBox[{"Sort", "[", 
     RowBox[{"testAll", ",", 
      RowBox[{
       RowBox[{"Order", "[", 
        RowBox[{
         RowBox[{"#1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test3", "=", 
    RowBox[{"Sort", "[", 
     RowBox[{"test2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ">", 
        RowBox[{"#2", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"allIndices", "=", 
    RowBox[{"test3", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eGFPflagList", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"manualCullingList", ",", 
           RowBox[{"allIndices", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "\[Equal]", "True"}], 
        ",", 
        RowBox[{"Association", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Indices\>\"", "\[Rule]", 
            RowBox[{"allIndices", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<ManualGFPFlag\>\"", "\[Rule]", "1"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{"Association", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Indices\>\"", "\[Rule]", 
            RowBox[{"allIndices", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<ManualGFPFlag\>\"", "\[Rule]", "0"}]}], "}"}], 
         "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", 
        RowBox[{"Length", "[", "allIndices", "]"}]}], "}"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"addedGFPflag", "=", 
   RowBox[{
    RowBox[{"Dataset", "[", 
     RowBox[{"JoinAcross", "[", 
      RowBox[{
       RowBox[{"Normal", "[", "addedImagesDataset", "]"}], ",", 
       "eGFPflagList", ",", "\"\<Indices\>\"", ",", "\"\<Left\>\""}], "]"}], 
     "]"}], "//", "Quiet"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.741316701135051*^9, 3.741316710071166*^9}, {
   3.7413176736186857`*^9, 3.74131767481497*^9}, {3.74131770672163*^9, 
   3.741317707021722*^9}, {3.742058003823749*^9, 3.7420580057055798`*^9}, {
   3.742151910629657*^9, 3.7421519121822853`*^9}, {3.742173421655723*^9, 
   3.7421734250097322`*^9}, {3.7423231031485662`*^9, 3.742323104643668*^9}, {
   3.742403352569786*^9, 3.742403365125313*^9}, {3.7424134487455273`*^9, 
   3.742413450364382*^9}, {3.742415049667294*^9, 3.7424150710833*^9}, {
   3.742486798163204*^9, 3.742486801239053*^9}, {3.74250348333947*^9, 
   3.742503495061562*^9}, {3.742506125868726*^9, 3.742506127308145*^9}, {
   3.742509960295144*^9, 3.7425099605852537`*^9}, {3.742512393789469*^9, 
   3.742512429914247*^9}, {3.7425166638523617`*^9, 3.742516663988296*^9}, {
   3.742740446105796*^9, 3.742740450189618*^9}, {3.74275529597964*^9, 
   3.742755296773655*^9}, {3.742758780481597*^9, 3.742758781147788*^9}, {
   3.742929925616393*^9, 3.7429299418324957`*^9}, 3.743037160001658*^9, {
   3.7520046465857067`*^9, 3.75200464906236*^9}, {3.752015881004429*^9, 
   3.752015890651126*^9}, {3.752802200417954*^9, 3.752802203460451*^9}, {
   3.752806901738576*^9, 3.752806905171937*^9}, {3.756424227209277*^9, 
   3.756424229028268*^9}, {3.756425152314749*^9, 3.756425153834696*^9}, {
   3.756426066048777*^9, 3.756426073347802*^9}, 3.757604117481529*^9, 
   3.7576249646405153`*^9, {3.757640008637155*^9, 3.757640015594295*^9}, {
   3.757645827562128*^9, 3.757645827680513*^9}, {3.757691556925994*^9, 
   3.757691557184723*^9}, 3.757790790338215*^9, {3.7577959652229977`*^9, 
   3.7577959685985394`*^9}, 3.757822983859672*^9, {3.7593449727073107`*^9, 
   3.759344984556527*^9}},
 CellLabel->
  "In[538]:=",ExpressionUUID->"af5f712e-c564-409d-8171-8ce4dfb556a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["11. Generate plot of eGFP intensity per assay:", "Subsubsection",
 CellChangeTimes->{{3.7349685220676613`*^9, 3.734968531104865*^9}, {
  3.73920431382374*^9, 
  3.7392043142969112`*^9}},ExpressionUUID->"0b6dd568-4c0b-48a3-aebe-\
858b663ead9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dataset", "=", "addedGFPflag"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"grouped", "=", 
    RowBox[{"dataset", "[", 
     RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"indicesOut", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Values", "[", "#", "]"}], "&"}], "/@", 
     RowBox[{"Values", "[", 
      RowBox[{"Normal", "[", 
       RowBox[{"grouped", "[", 
        RowBox[{"All", ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<MutantID\>\"", ",", "\"\<Indices\>\""}], "}"}]}], 
        "]"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addedeGFPIntensityPlot", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Association", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<MutantID\>\"", "\[Rule]", 
          RowBox[{"indicesOut", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"\"\<Indices\>\"", "\[Rule]", 
          RowBox[{"indicesOut", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "2"}], "]"}], "]"}]}], ",", 
         RowBox[{"\"\<eGFPIntensityPlot\>\"", "\[Rule]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", 
              RowBox[{"grouped", "[", 
               RowBox[{"n", ",", "All", ",", "\"\<eGFPSummedI\>\""}], "]"}], 
              "]"}], "/", 
             RowBox[{"10", "^", "6"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", 
                   RowBox[{"grouped", "[", 
                    RowBox[{"n", ",", "All", ",", "\"\<eGFPSummedI\>\""}], 
                    "]"}], "]"}], "/", 
                  RowBox[{"10", "^", "6"}]}], "]"}], "*", "1.5"}]}], "}"}]}], 
            ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"Axes", "\[Rule]", "False"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"Darker", "[", "Green", "]"}], ",", 
               RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}], ",", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Black", ",", "12"}], "]"}]}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Assay Number\>\"", ",", 
               "\"\<eGFP Intensity (\[Times]\!\(\*SuperscriptBox[\(10\), \
\(6\)]\))\>\""}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
            RowBox[{"ImagePadding", "\[Rule]", "50"}]}], "]"}]}]}], "}"}], 
       "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", "1568"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addedeGFPIntensityPlotDataset", "=", 
    RowBox[{
     RowBox[{"Dataset", "[", 
      RowBox[{"JoinAcross", "[", 
       RowBox[{
        RowBox[{"Normal", "[", "dataset", "]"}], ",", 
        "addedeGFPIntensityPlot", ",", "\"\<Indices\>\"", ",", 
        "\"\<Left\>\""}], "]"}], "]"}], "//", "Quiet"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}]}], "Input",
 CellChangeTimes->{{3.734968552318139*^9, 3.734968703004868*^9}, {
   3.734969003601969*^9, 3.734969006326923*^9}, {3.7377590866403637`*^9, 
   3.737759096263397*^9}, {3.737831717616984*^9, 3.737831722648225*^9}, {
   3.738085052994009*^9, 3.738085053267797*^9}, {3.7391271949253283`*^9, 
   3.739127196980823*^9}, {3.7527101054277477`*^9, 3.752710110140943*^9}, {
   3.7527108653362923`*^9, 3.752710865978093*^9}, {3.757625008280345*^9, 
   3.7576250380147963`*^9}, 3.757625532683441*^9},
 CellLabel->
  "In[546]:=",ExpressionUUID->"7008d5d4-13f2-41c9-8f09-33c38b078bc1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perform Michaelis-Menten fitting or inhibition fitting:", "Section",
 CellChangeTimes->{{3.756424312444107*^9, 
  3.756424326349634*^9}},ExpressionUUID->"889ada2f-a31e-4ed1-bd97-\
a20ff6338627"],

Cell[CellGroupData[{

Cell["(12. Do Michaelis-Menten fitting on optimized initial rates)", \
"Subsubsection",
 CellChangeTimes->{{3.7329815105504503`*^9, 3.732981515226286*^9}, {
  3.732981619070964*^9, 3.732981628015257*^9}, {3.733845223994356*^9, 
  3.7338452243517427`*^9}, {3.733849127408181*^9, 3.7338491298183203`*^9}, {
  3.733862064706407*^9, 3.7338620683357077`*^9}, {3.734212743459549*^9, 
  3.734212746012377*^9}, {3.7392043174660473`*^9, 3.739204317996668*^9}, {
  3.756424274477895*^9, 
  3.756424297631983*^9}},ExpressionUUID->"a4595276-b22a-482d-aa39-\
8339f61f8871"],

Cell["Use this cell if doing Michaelis-Menten fits.", "Text",
 CellChangeTimes->{{3.756438412284738*^9, 
  3.756438424457325*^9}},ExpressionUUID->"76881c6f-353a-463d-b4c3-\
548b1d356739"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dynamic", "[", "n", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataset", "=", "addedeGFPIntensityPlotDataset"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "4", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"len", "=", "1568"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numKernels", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"Kernels", "[", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chunksize", "=", 
   RowBox[{"Round", "[", 
    RowBox[{"len", "/", "numKernels"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"firstChunks", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"chunksize", "*", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}]}], ")"}], "+", "1"}], ",", " ", 
       RowBox[{"n", "*", "chunksize"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", " ", 
       RowBox[{"numKernels", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intervals", "=", 
    RowBox[{"Append", "[", 
     RowBox[{"firstChunks", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"chunksize", "*", 
           RowBox[{"(", 
            RowBox[{"numKernels", "-", "1"}], ")"}]}], ")"}], "+", "1"}], ",",
         " ", "len"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toCalculate", "=", 
    RowBox[{"dataset", "[", 
     RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chunked", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"toCalculate", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ";;", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "&"}], "/@", 
     "intervals"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"flattened", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"chunked", "[", 
        RowBox[{"[", "n", "]"}], "]"}], "[", "Catenate", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", 
        RowBox[{"Length", "[", "chunked", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addedMMcalc", "=", 
    RowBox[{"Join", "@@", 
     RowBox[{"ParallelMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"fitMichaelisMenten", "[", 
          RowBox[{
          "#", ",", "\"\<OptLinFitSlope\>\"", ",", "\"\<optlin\>\"", ",", 
           "1"}], "]"}], "]"}], "&"}], ",", "flattened"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"addedMMcalc", "=", 
    RowBox[{
     RowBox[{"fitMichaelisMenten", "[", 
      RowBox[{
      "addedeGFPIntensityPlotDataset", ",", "\"\<OptLinFitSlope\>\"", ",", 
       "\"\<Opt.\>\"", ",", "1"}], "]"}], "//", "Quiet"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"addedMMcalc", "=", 
    RowBox[{
     RowBox[{"fitInhibition", "[", 
      RowBox[{
      "dataset4", ",", "\"\<OptLinFitSlope\>\"", ",", "\"\<Opt.\>\"", ",", 
       "1"}], "]"}], "//", "Quiet"}]}], "*)"}]}]}], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.732828191302328*^9, 3.73282820710557*^9}, {
   3.7328284364936028`*^9, 3.732828443780792*^9}, {3.732831722315823*^9, 
   3.732831725378559*^9}, {3.732900269498952*^9, 3.732900284227059*^9}, 
   3.733627842458099*^9, {3.7336704770869513`*^9, 3.73367048142168*^9}, {
   3.733671111320716*^9, 3.733671115252977*^9}, {3.7337060190730667`*^9, 
   3.733706029288616*^9}, {3.733845227725439*^9, 3.733845238979539*^9}, {
   3.733862108776919*^9, 3.733862109808236*^9}, {3.733877026099456*^9, 
   3.7338770286980953`*^9}, {3.7340307316828737`*^9, 3.734030734614211*^9}, {
   3.734031051841358*^9, 3.734031052552471*^9}, {3.7340311685197153`*^9, 
   3.734031171251842*^9}, {3.734031202466367*^9, 3.7340312057294893`*^9}, {
   3.73403123892367*^9, 3.734031241868017*^9}, {3.734031311927002*^9, 
   3.7340313150240593`*^9}, {3.734031375414686*^9, 3.734031375531245*^9}, {
   3.7340316328876457`*^9, 3.734031632951627*^9}, {3.7340317948643007`*^9, 
   3.734031798620933*^9}, 3.7340319098772097`*^9, {3.7341899152854147`*^9, 
   3.7341899176423683`*^9}, {3.734190292020667*^9, 3.7341902934386883`*^9}, 
   3.734204328792881*^9, {3.7342111933645277`*^9, 3.734211195998844*^9}, 
   3.734212718065373*^9, {3.734214476969673*^9, 3.734214477961131*^9}, 
   3.7342161503453712`*^9, {3.734280476472961*^9, 3.734280480608233*^9}, {
   3.734282068346632*^9, 3.734282072801738*^9}, {3.734284446225918*^9, 
   3.734284447452318*^9}, {3.734289449929234*^9, 3.734289455413281*^9}, {
   3.734293937976171*^9, 3.734293939353435*^9}, {3.734408618480233*^9, 
   3.7344086200634623`*^9}, {3.734428148192651*^9, 3.73442814842953*^9}, {
   3.7345375760242147`*^9, 3.734537578938105*^9}, {3.734625945116146*^9, 
   3.734625958278081*^9}, {3.734701607148691*^9, 3.7347016080603237`*^9}, {
   3.735069144627019*^9, 3.735069151191079*^9}, {3.7350693272740803`*^9, 
   3.7350693278059998`*^9}, 3.7352452570344667`*^9, {3.7352455282449703`*^9, 
   3.735245532713469*^9}, {3.7352474475063753`*^9, 3.7352474505937243`*^9}, 
   3.735580027016666*^9, 3.736183453681279*^9, 3.736192415468719*^9, {
   3.73698954441826*^9, 3.736989548224608*^9}, {3.737308016619378*^9, 
   3.737308029547731*^9}, {3.73731505019048*^9, 3.737315052332711*^9}, 
   3.737325867226054*^9, 3.737570629915134*^9, 3.7375802526265707`*^9, {
   3.73765420626726*^9, 3.737654213334313*^9}, {3.7376542558919163`*^9, 
   3.737654265317093*^9}, 3.737831732264817*^9, {3.738087862423747*^9, 
   3.7380878668380613`*^9}, {3.738087969225464*^9, 3.738087976191448*^9}, {
   3.7380880337653093`*^9, 3.738088056796715*^9}, 3.7380881176834993`*^9, {
   3.738089011431477*^9, 3.738089013063336*^9}, 3.73808915662745*^9, {
   3.739038290456361*^9, 3.739038307466996*^9}, 3.739213147234008*^9, {
   3.739225776520256*^9, 3.739225777126886*^9}, {3.739225945608326*^9, 
   3.739225949641206*^9}, {3.7392269180729*^9, 3.739226920129723*^9}, {
   3.742058144360136*^9, 3.742058145422101*^9}, {3.7430371838932323`*^9, 
   3.743037189583784*^9}, {3.7520194827155123`*^9, 3.75201948354381*^9}},
 CellLabel->
  "In[552]:=",ExpressionUUID->"beff489b-d264-4303-896c-44ee63611e2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["(12b. Append kcat/Km values:)", "Subsubsection",
 CellChangeTimes->{{3.7329815105504503`*^9, 3.732981515226286*^9}, {
  3.732981619070964*^9, 3.732981628015257*^9}, {3.733845223994356*^9, 
  3.7338452243517427`*^9}, {3.733849127408181*^9, 3.7338491298183203`*^9}, {
  3.733862064706407*^9, 3.7338620683357077`*^9}, {3.734212743459549*^9, 
  3.734212746012377*^9}, {3.7392043174660473`*^9, 3.739204317996668*^9}, {
  3.740193933374983*^9, 3.740193944653103*^9}, {3.740858913101356*^9, 
  3.7408589483852043`*^9}, {3.756424660887486*^9, 
  3.75642466185814*^9}},ExpressionUUID->"c84d61f3-0336-4f4a-aead-\
1284c9de0b8a"],

Cell["Skip if fitting inhibition data.", "Text",
 CellChangeTimes->{{3.7564246639383307`*^9, 
  3.7564246720661783`*^9}},ExpressionUUID->"8c160e95-a6c9-47bc-8d37-\
bcec4147f0c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dynamic", "[", "n", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"grouped", "=", 
    RowBox[{"addedMMcalc", "[", 
     RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"indicesOut", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Values", "[", "#", "]"}], "&"}], "/@", 
     RowBox[{"Values", "[", 
      RowBox[{"Normal", "[", 
       RowBox[{"grouped", "[", 
        RowBox[{"All", ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<MutantID\>\"", ",", "\"\<Indices\>\"", ",", 
           "\"\<fit_mmscaled-optlin_kcatMMfit\>\"", ",", 
           "\"\<fit_mmscaled-optlin_KM\>\""}], "}"}]}], "]"}], "]"}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addkcatoverkm", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Association", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<MutantID\>\"", "\[Rule]", 
          RowBox[{"indicesOut", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"\"\<Indices\>\"", "\[Rule]", 
          RowBox[{"indicesOut", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "2"}], "]"}], "]"}]}], ",", 
         RowBox[{"\"\<fit_mmscaled-optlin_kcatoverKM_MMfit\>\"", "\[Rule]", 
          RowBox[{
           RowBox[{"indicesOut", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "3"}], "]"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"indicesOut", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "4"}], "]"}], "]"}], "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "6"}]}]}], ")"}]}]}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", "1568"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addedkcatoverkm", "=", 
    RowBox[{
     RowBox[{"Dataset", "[", 
      RowBox[{"JoinAcross", "[", 
       RowBox[{
        RowBox[{"Normal", "[", "addedMMcalc", "]"}], ",", "addkcatoverkm", 
        ",", "\"\<Indices\>\"", ",", "\"\<Left\>\""}], "]"}], "]"}], "//", 
     "Quiet"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}]}], "Input",
 CellChangeTimes->{{3.7401939923969297`*^9, 3.7401940584781218`*^9}, {
  3.7401940891121492`*^9, 3.740194140149293*^9}, {3.752005679767922*^9, 
  3.752005680596567*^9}},
 CellLabel->
  "In[567]:=",ExpressionUUID->"46be4d26-7c89-4948-8785-d7f29a248411"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
(12. Do inhibition fitting on optimized initial rates using simplified syntax)\
\>", "Subsubsection",
 CellChangeTimes->{{3.7329815105504503`*^9, 3.732981515226286*^9}, {
   3.732981619070964*^9, 3.732981628015257*^9}, {3.733845223994356*^9, 
   3.7338452243517427`*^9}, {3.733849127408181*^9, 3.7338491298183203`*^9}, {
   3.733862064706407*^9, 3.7338620683357077`*^9}, {3.734212743459549*^9, 
   3.734212746012377*^9}, {3.7392043174660473`*^9, 3.739204317996668*^9}, {
   3.7422254084006853`*^9, 3.742225426680113*^9}, {3.7422254711887913`*^9, 
   3.742225474086425*^9}, {3.742225523539302*^9, 3.742225527279195*^9}, {
   3.752764731568069*^9, 3.7527647525831423`*^9}, {3.75276526866521*^9, 
   3.752765272846221*^9}, 
   3.756424300491139*^9},ExpressionUUID->"89861cb1-5eb4-456a-99bb-\
0e26c6c58734"],

Cell["\<\
Use this cell if doing inhibition assay fits.

The 'scaleByGFP' flag below determines whether to scale each fitted initial \
rate by the PreAssay_ButtonQuant acquired before each assay or not. Usually \
this should be set =1, as we want to correct for any button loss during the \
substrate or titration series; however, in some cases (when button \
intensities are very low, for example), it may be preferable to set =0, \
otherwise the eGFP measurement error can dominate and result in a worse fit.

The preferred approach is to use per-assay scaling if available; however, one \
should always manually examine the fits and if they are bad (noisy, with lots \
of scatter) it may be the case that scaling by the first point gives a better \
fit.

In some cases, individual assays will not have corresponding \
PreAssay_ButtonQuant images associated with them, after a MeP assay using the \
Phosphate Sensor, for example. In these cases, 'scaleByGFP'=0=1, as each \
assay will have the eGFP intensity determined from the Post_SDS_Wash image, \
so the value of the flag doesn't matter.\
\>", "Text",
 CellChangeTimes->{{3.756424348446785*^9, 3.756424564028529*^9}, {
  3.756437897867675*^9, 3.756437960294424*^9}, {3.7564384302222023`*^9, 
  3.756438439563858*^9}},ExpressionUUID->"6f9c01d6-7ecf-4845-8290-\
a710ab23af89"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"scaleByGFP", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataset", "=", "addedGFPflag"}], ";"}]}], "Input",
 CellChangeTimes->{{3.752764862146399*^9, 3.752764895618696*^9}, {
   3.752764931001326*^9, 3.752765093117528*^9}, {3.7527651525712*^9, 
   3.752765256708088*^9}, {3.7527653061130953`*^9, 3.75276535833521*^9}, {
   3.7527653922315063`*^9, 3.752765486539187*^9}, {3.752765589569687*^9, 
   3.752765697597582*^9}, {3.752765795499424*^9, 3.7527658272725058`*^9}, {
   3.752766085367844*^9, 3.752766299590188*^9}, {3.752766350641169*^9, 
   3.752766354726727*^9}, {3.752766418123837*^9, 3.7527664348251467`*^9}, {
   3.752766487301627*^9, 3.752766618189658*^9}, {3.75276665766086*^9, 
   3.752766687541404*^9}, {3.752766774232821*^9, 3.752766884375699*^9}, {
   3.752766935277644*^9, 3.752766985014432*^9}, {3.7527670244645357`*^9, 
   3.7527670264870653`*^9}, {3.7527676833752317`*^9, 3.752767684313713*^9}, {
   3.752767765267874*^9, 3.752767766844686*^9}, {3.752767809371105*^9, 
   3.7527679190662537`*^9}, {3.752768030070775*^9, 3.7527680993059053`*^9}, {
   3.75276816433633*^9, 3.752768174623701*^9}, {3.752769176713789*^9, 
   3.7527692209282703`*^9}, {3.752769932705413*^9, 3.752769949708015*^9}, {
   3.7527701716458387`*^9, 3.752770173196662*^9}, {3.752770835391953*^9, 
   3.7527708384525337`*^9}, {3.752771383954454*^9, 3.752771429845763*^9}, {
   3.752771718587597*^9, 3.752771718802383*^9}, {3.7527991325727043`*^9, 
   3.75279930359674*^9}, 3.756424346201676*^9, {3.756424589179777*^9, 
   3.7564246366595917`*^9}, {3.756425759593746*^9, 3.756425777287418*^9}, {
   3.756669508499531*^9, 
   3.756669510382609*^9}},ExpressionUUID->"416ec0c7-d37a-4858-aebe-\
1b3ae7d050a2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<ScaleByGFP is set to \>\"", "<>", 
     RowBox[{"ToString", "[", "scaleByGFP", "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eGFPscaleUnits", "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
      "\"\<Scaled initial rate (\!\(\*SuperscriptBox[\(s\), \(-1\)]\))\>\"", 
      ",", "\"\<Initial rate (uM/s)\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"removeControl", "=", 
    RowBox[{"dataset", "[", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"#AssayType", "\[Equal]", "1"}], "&"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"grouped", "=", 
    RowBox[{"removeControl", "[", 
     RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Fitting inhibition curves...\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProgressIndicator", "[", 
   RowBox[{
    RowBox[{"Dynamic", "[", "n", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"Length", "[", "grouped", "]"}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"onlyControl", "=", 
    RowBox[{"dataset", "[", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"#AssayType", "\[Equal]", "0"}], "&"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"groupedControl", "=", 
    RowBox[{"onlyControl", "[", 
     RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eGFPscaleAppend", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", "\"\< PerPointScaled\>\"", 
     ",", "\"\< Unscaled\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"keyAppend", "=", "\"\<optlin\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normalizeDataForFitting", "[", 
    RowBox[{"chamberData_", ",", 
     RowBox[{"scaleByGFP_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "inhibitorConcentrations", ",", "eGFPscalingList", ",", "rates", ",", 
       "data", ",", "data2a", ",", "data2b", ",", "dataMax", ",", "data2", 
       ",", "dataNorm"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"inhibitorConcentrations", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"chamberData", "[", 
         RowBox[{"All", ",", "\"\<InhibitorConcentrations\>\""}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"eGFPscalingList", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Normal", "[", 
            RowBox[{"chamberData", "[", 
             RowBox[{"All", ",", "\"\<eGFPSummedI\>\""}], "]"}], "]"}], "/", 
           "eGFPslope"}], "/", "1000."}], ",", 
         RowBox[{"scaleByGFP", "\[Equal]", "0"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Mean", "[", 
              RowBox[{"Normal", "[", 
               RowBox[{"chamberData", "[", 
                RowBox[{"All", ",", "\"\<eGFPSummedI\>\""}], "]"}], "]"}], 
              "]"}], "/", "eGFPslope"}], "/", "1000."}], ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "inhibitorConcentrations", "]"}], "}"}]}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rates", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"chamberData", "[", 
         RowBox[{"All", ",", "rateKey"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"inhibitorConcentrations", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", 
           RowBox[{"rates", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", 
           RowBox[{"eGFPscalingList", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"Length", "[", "inhibitorConcentrations", "]"}]}], "}"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"data2a", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"data", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", "\"\<NaN\>\""}],
              "&&", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], "&&", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ">", "0"}]}], "&"}]}], "]"}]}],
         ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"data2a", "=", "data"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"data2b", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"data2a", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"data2a", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "2"}], "]"}], "]"}], "/", 
            RowBox[{"data2a", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"Length", "[", "data2a", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dataMax", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"data2b", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"data2", "=", "data2b"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"data2", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"data2", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "2"}], "]"}], "]"}], "/", "dataMax"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "data2", "]"}]}], "}"}]}], "]"}], ",", 
        "dataMax"}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"controlData", "[", 
    RowBox[{"chamber_", ",", 
     RowBox[{"scaleByGFP_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "controlData", ",", "chamberData", ",", 
       "inhibitorConcentrationsControl", ",", "eGFPscalingListControl", ",", 
       "controlPlotTEMP", ",", "controlPlot", ",", "controlPlotReplace0"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"control", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"controlData", "=", 
        RowBox[{"groupedControl", "[", "n", "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"controlData", "=", 
       RowBox[{"groupedControl", "[", "chamber", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"chamberData", "=", 
       RowBox[{"grouped", "[", "chamber", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"inhibitorConcentrationsControl", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"controlData", "[", 
         RowBox[{"All", ",", "\"\<InhibitorConcentrations\>\""}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"eGFPscalingListControl", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Normal", "[", 
            RowBox[{"chamberData", "[", 
             RowBox[{"All", ",", "\"\<eGFPSummedI\>\""}], "]"}], "]"}], "/", 
           "eGFPslope"}], "/", "1000."}], ",", 
         RowBox[{"scaleByGFP", "\[Equal]", "0"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Mean", "[", 
              RowBox[{"Normal", "[", 
               RowBox[{"chamberData", "[", 
                RowBox[{"All", ",", "\"\<eGFPSummedI\>\""}], "]"}], "]"}], 
              "]"}], "/", "eGFPslope"}], "/", "1000."}], ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "chamberData", "]"}], "}"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"controlPlotTEMP", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"controlData", "[", 
            RowBox[{"run", ",", "\"\<InhibitorConcentrations\>\""}], "]"}], 
           ",", 
           RowBox[{"controlData", "[", 
            RowBox[{"run", ",", "rateKey"}], "]"}], ",", 
           RowBox[{"eGFPscalingListControl", "[", 
            RowBox[{"[", "run", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"run", ",", "1", ",", 
           RowBox[{"Length", "[", "controlData", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"controlPlot", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"controlPlotTEMP", "[", 
            RowBox[{"[", 
             RowBox[{"run", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"controlPlotTEMP", "[", 
             RowBox[{"[", 
              RowBox[{"run", ",", "2"}], "]"}], "]"}], "/", 
            RowBox[{"controlPlotTEMP", "[", 
             RowBox[{"[", 
              RowBox[{"run", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"run", ",", "1", ",", 
           RowBox[{"Length", "[", "controlPlotTEMP", "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"controlPlotReplace0", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"controlPlotTEMP", "[", 
               RowBox[{"[", 
                RowBox[{"run", ",", "1"}], "]"}], "]"}], "\[Equal]", "0.0"}], 
             ",", "0.1", ",", 
             RowBox[{"controlPlotTEMP", "[", 
              RowBox[{"[", 
               RowBox[{"run", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"controlPlotTEMP", "[", 
             RowBox[{"[", 
              RowBox[{"run", ",", "2"}], "]"}], "]"}], "/", 
            RowBox[{"controlPlotTEMP", "[", 
             RowBox[{"[", 
              RowBox[{"run", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"run", ",", "1", ",", 
           RowBox[{"Length", "[", "controlPlotTEMP", "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "controlPlotReplace0"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]",
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"aggWithInhibition", "=", 
     RowBox[{"grouped", "[", 
      RowBox[{"1", ",", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"i", "+=", "1"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"fitOut", "=", 
            RowBox[{"Quiet", "[", 
             RowBox[{"NonlinearModelFit", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"normalizeDataForFitting", "[", 
                 RowBox[{"#", ",", "1.0"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Vmax", "/", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"inhibitor", "/", "Ki"}]}], ")"}]}], ",", 
                 RowBox[{
                  RowBox[{"Ki", ">", "0.0"}], "&&", 
                  RowBox[{"Vmax", ">", "0.75"}], "&&", 
                  RowBox[{"Vmax", "<", "1.5"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Ki", ",", "Vmax"}], "}"}], ",", "inhibitor"}], "]"}],
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"dataMax", "=", 
            RowBox[{"Quiet", "[", 
             RowBox[{
              RowBox[{"normalizeDataForFitting", "[", 
               RowBox[{"#", ",", "1.0"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<KiInhibition\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"Ki", "/.", 
                RowBox[{"fitOut", "[", "\"\<BestFitParameters\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"\"\<VmaxSubstrateInhibition\>\"", "\[Rule]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Vmax", "/.", 
                 RowBox[{"fitOut", "[", "\"\<BestFitParameters\>\"", "]"}]}], 
                ")"}], "*", "dataMax"}]}]}], "}"}]}]}], "]"}], "&"}]}], 
      "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
   "aggWithInhibition", "=", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Quiet", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"normData", "=", 
          RowBox[{
           RowBox[{"normalizeDataForFitting", "[", 
            RowBox[{
             RowBox[{"grouped", "[", "n", "]"}], ",", "scaleByGFP"}], "]"}], 
           "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"fitOut", "=", 
          RowBox[{"Quiet", "[", 
           RowBox[{"NonlinearModelFit", "[", 
            RowBox[{"normData", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Vmax", "/", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"inhibitor", "/", "Ki"}]}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"Ki", ">", "0.0"}], "&&", 
                RowBox[{"Vmax", ">", "0.75"}], "&&", 
                RowBox[{"Vmax", "<", "1.5"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Ki", ",", "Vmax"}], "}"}], ",", "inhibitor"}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"KiOut", "=", 
          RowBox[{"(", 
           RowBox[{"Ki", "/.", 
            RowBox[{"fitOut", "[", "\"\<BestFitParameters\>\"", "]"}]}], 
           ")"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"VmaxOut", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Vmax", "/.", 
             RowBox[{"fitOut", "[", "\"\<BestFitParameters\>\"", "]"}]}], 
            ")"}], "*", "dataMax"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"dataMax", "=", 
          RowBox[{"Quiet", "[", 
           RowBox[{
            RowBox[{"normalizeDataForFitting", "[", 
             RowBox[{
              RowBox[{"grouped", "[", "n", "]"}], ",", "1.0"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"control", " ", "points"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"control", "=", 
          RowBox[{"controlData", "[", 
           RowBox[{"n", ",", "scaleByGFP"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"brokenAxisPlot", "=", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ListLogLinearPlot", "[", 
             RowBox[{
              RowBox[{"ReplacePart", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "dataMax"}]}], "}"}],
                    "&"}], "/@", "normData"}], ")"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", "0.1"}]}], "]"}],
               ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"PointSize", "[", "0.02", "]"}]}], ",", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"Axes", "\[Rule]", "False"}], ",", 
              RowBox[{"FrameTicks", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0.1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"10", ",", "10"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "100"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"500", ",", "500"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1000", ",", "1000"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5000", ",", "5000"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"10000", ",", "10000"}], "}"}]}], "}"}], ",", 
                   "None"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
              RowBox[{"FrameStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"Black", ",", "18", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                "]"}]}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<[I] (\[Mu]M)\>\"", ",", "eGFPscaleUnits"}], 
                "}"}]}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", 
                   RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"Values", "[", "inhibitors", "]"}], "]"}], "*", 
                    "1.2"}]}], "}"}], ",", "All"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"LogLinearPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"fitOut", "[", "x", "]"}], "*", "dataMax"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0.01", ",", "5000"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"ListLogLinearPlot", "[", 
             RowBox[{"control", ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"Black", ",", 
                 RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], "]"}], 
            ",", 
            RowBox[{"ListLogLinearPlot", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"control", "[", 
                 RowBox[{"[", "run", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"run", ",", "1", ",", 
                  RowBox[{"Length", "[", "control", "]"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"White", ",", 
                 RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
             "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Association", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<Indices\>\"", "\[Rule]", 
             RowBox[{"Normal", "[", 
              RowBox[{"grouped", "[", 
               RowBox[{"n", ",", "1", ",", "\"\<Indices\>\""}], "]"}], 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{"StringJoin", "[", 
              RowBox[{
              "\"\<KiInhibitionFit\>\"", ",", "\"\< \>\"", ",", "keyAppend", 
               ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", "KiOut"}], ",", 
            RowBox[{
             RowBox[{"StringJoin", "[", 
              RowBox[{
              "\"\<VmaxMMfit\>\"", ",", "\"\< \>\"", ",", "keyAppend", ",", 
               "eGFPscaleAppend"}], "]"}], "\[Rule]", "VmaxOut"}], ",", 
            RowBox[{
             RowBox[{"StringJoin", "[", 
              RowBox[{
              "\"\<InhibitionFitObj\>\"", ",", "\"\< \>\"", ",", "keyAppend", 
               ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", "fitOut"}], ",", 
            RowBox[{"\"\<InhibitionFitPlot\>\"", "->", "brokenAxisPlot"}], 
            ",", 
            RowBox[{"\"\<eGFPScaling\>\"", "\[Rule]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               "\"\<ScaledPerPoint\>\"", ",", "\"\<MeanScaled\>\""}], 
              "]"}]}]}], "}"}], "]"}]}], ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"Length", "[", "grouped", "]"}]}], "}"}]}], "]"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "fix", " ", "bad", " ", "fits", " ", "with", " ", "Indeterminate"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"replaced", "=", 
    RowBox[{"Quiet", "[", 
     RowBox[{"Fold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{"#1", ",", "#2", ",", "Infinity"}], "]"}], "&"}], ",", 
       "aggWithInhibition", ",", 
       RowBox[{"{", 
        RowBox[{"_ReplaceAll", "\[Rule]", "Indeterminate"}], "}"}]}], "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aggWithInhibitionOut", "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{"Dataset", "[", 
     RowBox[{"JoinAcross", "[", 
      RowBox[{
       RowBox[{"Normal", "[", "dataset", "]"}], ",", "replaced", ",", 
       "\"\<Indices\>\"", ",", "\"\<Left\>\""}], "]"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.752764862146399*^9, 3.752764895618696*^9}, {
   3.752764931001326*^9, 3.752765093117528*^9}, {3.7527651525712*^9, 
   3.752765256708088*^9}, {3.7527653061130953`*^9, 3.75276535833521*^9}, {
   3.7527653922315063`*^9, 3.752765486539187*^9}, {3.752765589569687*^9, 
   3.752765697597582*^9}, {3.752765795499424*^9, 3.7527658272725058`*^9}, {
   3.752766085367844*^9, 3.752766299590188*^9}, {3.752766350641169*^9, 
   3.752766354726727*^9}, {3.752766418123837*^9, 3.7527664348251467`*^9}, {
   3.752766487301627*^9, 3.752766618189658*^9}, {3.75276665766086*^9, 
   3.752766687541404*^9}, {3.752766774232821*^9, 3.752766884375699*^9}, {
   3.752766935277644*^9, 3.752766985014432*^9}, {3.7527670244645357`*^9, 
   3.7527670264870653`*^9}, {3.7527676833752317`*^9, 3.752767684313713*^9}, {
   3.752767765267874*^9, 3.752767766844686*^9}, {3.752767809371105*^9, 
   3.7527679190662537`*^9}, {3.752768030070775*^9, 3.7527680993059053`*^9}, {
   3.75276816433633*^9, 3.752768174623701*^9}, {3.752769176713789*^9, 
   3.7527692209282703`*^9}, {3.752769932705413*^9, 3.752769949708015*^9}, {
   3.7527701716458387`*^9, 3.752770173196662*^9}, {3.752770835391953*^9, 
   3.7527708384525337`*^9}, {3.752771383954454*^9, 3.752771429845763*^9}, {
   3.752771718587597*^9, 3.752771718802383*^9}, {3.7527991325727043`*^9, 
   3.75279930359674*^9}, 3.756424346201676*^9, {3.756424589179777*^9, 
   3.7564246366595917`*^9}, {3.756425759593746*^9, 3.756425804187272*^9}, {
   3.756425893740981*^9, 3.7564258950366573`*^9}, {3.756669514120418*^9, 
   3.7566695143159513`*^9}},ExpressionUUID->"77ca38db-4e59-4048-8152-\
967ddbf3cac4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["12c. Append enzyme concentration (EnzymeConc):", "Subsubsection",
 CellChangeTimes->{{3.7329815105504503`*^9, 3.732981515226286*^9}, {
  3.732981619070964*^9, 3.732981628015257*^9}, {3.733845223994356*^9, 
  3.7338452243517427`*^9}, {3.733849127408181*^9, 3.7338491298183203`*^9}, {
  3.733862064706407*^9, 3.7338620683357077`*^9}, {3.734212743459549*^9, 
  3.734212746012377*^9}, {3.7392043174660473`*^9, 3.739204317996668*^9}, {
  3.740193933374983*^9, 3.740193944653103*^9}, {3.740858913101356*^9, 
  3.740858968972477*^9}, {3.7408590199220343`*^9, 
  3.740859061568828*^9}},ExpressionUUID->"f3dd74ae-1d86-4f6e-b897-\
0b98b2389804"],

Cell["\<\
Even if fitting inhibition data, it is useful to append the calculated \
per-chamber effective enzyme concentration, as this is useful for downstream \
analyses and, if necessary, data culling.\
\>", "Text",
 CellChangeTimes->{{3.7564246761648407`*^9, 3.7564246973374977`*^9}, {
  3.756437968659975*^9, 
  3.756437980147559*^9}},ExpressionUUID->"36ace7c6-6f3a-4dea-8215-\
2ecbe1c0f777"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"addedkcatoverkm", "=", 
     RowBox[{
     "Import", "[", 
      "\"\</Users/craig/Desktop/cMUP_temp/180225_S2d2_PafA_ValScan_cMUP.wxf\>\
\"", "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"addedEnzymeConc", "=", 
    RowBox[{"addedkcatoverkm", "[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"\"\<EnzymeConc\>\"", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"#eGFPSummedI", "/", "#eGFPSlope"}], ")"}]}]}], "]"}], 
       "&"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7408550509957037`*^9, 3.7408550921834908`*^9}, {
   3.740859086967441*^9, 3.740859109956623*^9}, {3.740859162081334*^9, 
   3.740859214711899*^9}, 3.7408605039982567`*^9, 3.74086155736966*^9, 
   3.740862135385745*^9, {3.740953639152095*^9, 3.7409536418161716`*^9}, 
   3.742060868175837*^9, {3.752005692588107*^9, 3.7520056948148947`*^9}, 
   3.752806473339551*^9, 3.756425038569317*^9, {3.757604206145835*^9, 
   3.757604225981556*^9}, {3.757606752776832*^9, 3.757606754916089*^9}, 
   3.757625110552622*^9, {3.75782362503762*^9, 3.757823628517149*^9}, 
   3.759345645964991*^9},
 CellLabel->
  "In[573]:=",ExpressionUUID->"695bd059-6501-45bc-acce-a8abc684e075"]
}, Open  ]],

Cell[CellGroupData[{

Cell["13. Scale by lagoon intensities:", "Subsubsection",
 CellChangeTimes->{{3.7329815105504503`*^9, 3.732981515226286*^9}, {
  3.732981619070964*^9, 3.732981628015257*^9}, {3.733845223994356*^9, 
  3.7338452243517427`*^9}, {3.733849127408181*^9, 3.7338491298183203`*^9}, {
  3.733862064706407*^9, 3.7338620683357077`*^9}, {3.734212743459549*^9, 
  3.734212746012377*^9}, {3.7392043174660473`*^9, 3.739204317996668*^9}, {
  3.740854720261119*^9, 3.7408547204127483`*^9}, {3.7411923976134357`*^9, 
  3.741192401210382*^9}},ExpressionUUID->"c03953ce-7560-466a-9128-\
a43051f24d26"],

Cell[TextData[{
 "These cells perform higher-level ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "cat"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "b7695756-d938-43b9-bcf1-77a1c2599c33"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["k", "cat"], "/", 
    SubscriptBox["K", 
     StyleBox["M",
      FontSlant->"Plain"]]}], TraditionalForm]],ExpressionUUID->
  "5a43e0d7-fb8c-4b7a-8a02-257f8fbc5927"],
 " corrections to improve reproducibility of these parameters across the \
device. They do not apply to inhibition assays."
}], "Text",
 CellChangeTimes->{{3.7564247010462427`*^9, 
  3.756424786312842*^9}},ExpressionUUID->"fa4bf0ad-6194-436b-9772-\
e9a9ee6d54ca"],

Cell["(1) Import lagoon intensities:", "Text",
 CellChangeTimes->{{3.7408547774018383`*^9, 3.7408547854797783`*^9}, {
  3.740854885279869*^9, 
  3.7408548859649067`*^9}},ExpressionUUID->"268b2c1e-e6e1-473b-81cf-\
19c12849879b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lagoonIntensities", "=", 
   RowBox[{
   "Import", "[", 
    "\"\</Users/craig/atlas/media/dmokhtari/Atlas-HDD/eMITOMI_Workup/Setup3/\
180528/Lagoon_Quant/s3d1_lagoonSummary.csv\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.740854799992547*^9, 3.7408548074974117`*^9}, 
   3.740860528943128*^9, 3.740861572428508*^9, 3.7408621502350693`*^9, {
   3.741106512030292*^9, 3.741106513300272*^9}, {3.741192354308166*^9, 
   3.741192355974238*^9}, {3.741192386550968*^9, 3.741192386838072*^9}, {
   3.741315076127102*^9, 3.741315088836591*^9}, {3.743038000486719*^9, 
   3.743038005014349*^9}, {3.752005721121646*^9, 3.752005730908647*^9}, {
   3.757823678175625*^9, 3.757823683575687*^9}, {3.7593456729707613`*^9, 
   3.759345675562077*^9}},
 CellLabel->
  "In[575]:=",ExpressionUUID->"2fd65a1d-6da7-4786-af2f-b4702e9cecc8"],

Cell["(2) Append lagoon intensities.", "Text",
 CellChangeTimes->{{3.740854934225046*^9, 
  3.740854984643366*^9}},ExpressionUUID->"c68cf9c7-6ad5-46e1-b763-\
be5b1b60d07f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getLagoonIntensity", "[", 
    RowBox[{"dataset_", ",", "indices_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"dataset", ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
         RowBox[{"indices", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
         RowBox[{"indices", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "&"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"addedLagoonIntensities", "=", 
   RowBox[{"addedEnzymeConc", "[", 
    RowBox[{"All", ",", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\"\<LagoonMedianIntensity\>\"", "\[Rule]", 
         RowBox[{"getLagoonIntensity", "[", 
          RowBox[{"lagoonIntensities", ",", "#Indices"}], "]"}]}]}], "]"}], 
      "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7408549939645653`*^9, 3.74085504537386*^9}, 
   3.740855283025476*^9, 3.7408593712262907`*^9},
 CellLabel->
  "In[576]:=",ExpressionUUID->"8219b9df-5e5c-4c8f-8f0c-bc61937a2bb3"],

Cell["\<\
(3) Pull out wild-type meeting selection criteria, calculate correction, and \
append this to the dataset.\
\>", "Text",
 CellChangeTimes->{{3.740856508280694*^9, 
  3.740856545271833*^9}},ExpressionUUID->"e0289cf3-d12c-404f-a25b-\
63ab4a3276f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"wtForCalc", "=", 
    RowBox[{"addedLagoonIntensities", "[", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#ExpIndex", "==", "1"}], "&&", 
        RowBox[{"#MutantID", "\[Equal]", "\"\<WT\>\""}], "&&", 
        RowBox[{"#EnzymeConc", ">", "0.5"}], "&&", 
        RowBox[{"#ManualGFPFlag", "\[Equal]", "0"}]}], "&"}], "]"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parameter", "=", "\"\<fit_mmscaled-optlin_kcatMMfit\>\""}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"forCorr", "=", 
    RowBox[{"Values", "[", 
     RowBox[{"Normal", "[", 
      RowBox[{"wtForCalc", "[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<LagoonMedianIntensity\>\"", ",", "parameter"}], "}"}]}],
        "]"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"medianWT", "=", 
    RowBox[{"Median", "[", 
     RowBox[{"forCorr", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"forCorrNorm", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "/", 
       RowBox[{"{", 
        RowBox[{"1.0", ",", "medianWT"}], "}"}]}], "&"}], "/@", "forCorr"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fitLine", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{"forCorrNorm", ",", "x", ",", "x"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{"forCorrNorm", ",", 
      RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"75", ",", "75"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"75", ",", "0"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", "16"}], "]"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<Median eGFP Signal (Lagoon)\>\"", ",", 
         RowBox[{"parameter", "<>", "\"\<_Norm\>\""}]}], "}"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"fitLine", "[", "x", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", 
        RowBox[{"1", " ", 
         RowBox[{"10", "^", "5"}]}]}], "}"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Gray", ",", "Dashed"}], "]"}]}]}], "]"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"addedRescaledkcat", "=", 
   RowBox[{"addedLagoonIntensities", "[", 
    RowBox[{"All", ",", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\"\<kcat_lagoon_rescaled\>\"", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "[", "\"\<fit_mmscaled-optlin_kcatMMfit\>\"", "]"}], 
           "/", 
           RowBox[{"(", 
            RowBox[{"fitLine", "[", "#LagoonMedianIntensity", "]"}], ")"}]}], 
          ")"}]}]}], "]"}], "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.740855657144987*^9, 3.740855675895996*^9}, {
  3.740855836634472*^9, 3.740855844096463*^9}, {3.740856100001845*^9, 
  3.7408562345124826`*^9}, {3.74085668312674*^9, 3.740856711742484*^9}, {
  3.7408567438164682`*^9, 3.740856772105359*^9}, {3.740856821911731*^9, 
  3.740856870929246*^9}, {3.740858903866404*^9, 3.740858907547833*^9}},
 CellLabel->
  "In[578]:=",ExpressionUUID->"345b0d9e-5741-491e-94fc-00da57615509"]
}, Open  ]],

Cell[CellGroupData[{

Cell["14. Correct kcat for row/column dependence:", "Subsubsection",
 CellChangeTimes->{{3.734189486408122*^9, 3.7341895106160927`*^9}, {
  3.739204323001759*^9, 3.73920432371455*^9}, {3.740854723329686*^9, 
  3.740854723447792*^9}, {3.752007759366089*^9, 3.752007781325574*^9}, {
  3.7520078539790993`*^9, 
  3.752007854184617*^9}},ExpressionUUID->"4d4e5510-1ff6-4c08-aa68-\
f45e84d772e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fixLogPlots", "[", "gr_", "]"}], ":=", 
   RowBox[{"gr", "/.", 
    RowBox[{
     RowBox[{"f", ":", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Charting`ScaledTicks", "|", "Charting`ScaledFrameTicks"}], 
        ")"}], "[", 
       RowBox[{"{", 
        RowBox[{"Log", ",", "Exp"}], "}"}], "]"}]}], "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"#", ",", ";;", ",", " ", 
          RowBox[{";;", "3"}]}], "]"}], "&"}], "@*", "f"}], ")"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chipCorrection", "[", "datasetForCorrection_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "dataset", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dataset", "=", "datasetForCorrection"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"cmup1", "=", 
      RowBox[{"dataset", "[", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#ExpIndex", "\[Equal]", "1"}], "&&", 
          RowBox[{"#EnzymeConc", ">", "0.3"}], "&&", 
          RowBox[{"#ManualGFPFlag", "\[Equal]", "0"}], "&&", 
          RowBox[{"#LocalBackgroundRatio", ">", "5.0"}]}], "&"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"groupedByMutant", "=", 
      RowBox[{"cmup1", "[", 
       RowBox[{"GroupBy", "[", "\"\<MutantID\>\"", "]"}], "]"}]}], ";", "\n", 
     "\n", 
     RowBox[{"pairs", "=", 
      RowBox[{"groupedByMutant", "[", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "#", "]"}], "\[GreaterEqual]", "2"}], "&"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\n", 
     RowBox[{"test1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Values", "[", 
         RowBox[{"Normal", "[", 
          RowBox[{
           RowBox[{"pairs", "[", "n", "]"}], "[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<MutantID\>\"", ",", "\"\<Indices\>\"", ",", 
              "\"\<fit_mmscaled-optlin_kcatMMfit\>\"", ",", 
              "\"\<kcat_lagoon_rescaled\>\""}], "}"}]}], "]"}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "pairs", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"RMSE", " ", "across", " ", "replicates"}], ",", " ", 
       RowBox[{"kcat_lagoon", "_rescaled"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rmse", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"test1", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "i", ",", "4"}], "]"}], "]"}], "-", 
               RowBox[{"Mean", "[", 
                RowBox[{
                 RowBox[{"test1", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], ")"}], 
             "^", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"test1", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "test1", "]"}]}], "}"}]}], "]"}], "/", 
        RowBox[{"Length", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"test1", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"plot", " ", "wt", " ", "pairs"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"wtTest", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"test1", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", 
             "\"\<WT\>\""}], "&"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"wtPairs", "=", 
      RowBox[{"ListLogLogPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Callout", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"wtTest", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "1", ",", "4"}], "]"}], "]"}], ",", 
              RowBox[{"wtTest", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "2", ",", "4"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{
             RowBox[{"wtTest", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "1", ",", "1"}], "]"}], "]"}], "<>", 
             "\"\<_\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"wtTest", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], 
              "]"}], "<>", "\"\<_\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"wtTest", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "2", ",", "2", ",", "1"}], "]"}], "]"}], 
              "]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "wtTest", "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.1", ",", "1000.0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.1", ",", "1000.0"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "0.0025", "]"}], ",", "18", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(k\), \(cat, rep1\)]\) (/s)\>\"", ",", 
           "\"\<\!\(\*SubscriptBox[\(k\), \(cat, rep2\)]\) (/s)\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"corrplot1", "=", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"fixLogPlots", "@", 
         RowBox[{"ListLogLogPlot", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Callout", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"test1", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1", ",", "4"}], "]"}], "]"}], ",", 
                 RowBox[{"test1", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "2", ",", "4"}], "]"}], "]"}]}], "}"}], 
               ",", 
               RowBox[{
                RowBox[{"test1", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "1", ",", "1"}], "]"}], "]"}], "<>", 
                "\"\<_\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"test1", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], 
                 "]"}], "<>", "\"\<_\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"test1", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "2", ",", "2", ",", "1"}], "]"}], "]"}], 
                 "]"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1", ",", 
               RowBox[{"Length", "[", "test1", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.1", ",", "1000.0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.1", ",", "1000.0"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"FrameStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", 
              RowBox[{"Thickness", "[", "0.0025", "]"}], ",", "18", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}], 
           ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(k\), \(cat, rep1\)]\) (/s)\>\"", ",", 
              "\"\<\!\(\*SubscriptBox[\(k\), \(cat, rep2\)]\) (/s)\>\""}], 
             "}"}]}], ",", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Inset", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"\"\<RMSE = \>\"", "<>", 
                   RowBox[{"ToString", "[", "rmse", "]"}]}], ",", "18", ",", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}],
                 ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.8", ",", "0.2"}], "}"}], "]"}]}], "]"}], ",", 
              RowBox[{"Inset", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{
                  "\"\<\!\(\*StyleBox[\\\"n\\\",FontSlant->\\\"Italic\\\"]\) \
= \>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"Length", "[", "test1", "]"}], "]"}]}], ",", "18",
                   ",", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}],
                 ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.8", ",", "0.12"}], "}"}], "]"}]}], "]"}]}], 
             "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "wtPairs", ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"LogLogPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"x", "/", "2"}], ",", 
            RowBox[{"x", "*", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0.01", ",", "10000.0"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.75", "]"}], ",", "Dashed"}], 
            "]"}]}]}], "]"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "700"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"test2Lagoon", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"test1", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "i"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"test1", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "i", ",", "4"}], "]"}], "]"}], "/", 
           RowBox[{"Mean", "[", 
            RowBox[{
             RowBox[{"test1", "[", 
              RowBox[{"[", "n", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}]}], "]"}], ",", 
        
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "test1", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"test1", "[", 
            RowBox[{"[", "n", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"flattened", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"test2Lagoon", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"forHM", "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"flattened", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "2", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"flattened", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "2", ",", "1"}], "]"}], "]"}]}], "}"}], 
          "\[Rule]", 
          RowBox[{"Log", "[", 
           RowBox[{"flattened", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "5"}], "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"Length", "[", "flattened", "]"}]}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"hm1", "=", 
      RowBox[{"MatrixPlot", "[", 
       RowBox[{"forHM", ",", 
        RowBox[{"ImageSize", "\[Rule]", "380"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"BarLegend", "[", 
          RowBox[{"Automatic", ",", 
           RowBox[{
           "LegendLabel", "\[Rule]", 
            "\"\<Ln(\!\(\*FractionBox[RowBox[{SubscriptBox[\\\"k\\\", \
RowBox[{\\\"cat\\\", \\\",\\\", RowBox[{\\\"mutant\\\", \\\" \\\", \
StyleBox[\\\"i\\\",FontSlant->\\\"Italic\\\"]}]}]], \\\" \\\"}], \
RowBox[{\\\"<\\\", SubscriptBox[\\\"k\\\", RowBox[{\\\"cat\\\", \\\",\\\", \
RowBox[{\\\"mutant\\\", \\\" \\\", StyleBox[\\\"i\\\",FontSlant->\\\"Italic\\\
\"]}]}]], \\\">\\\"}]]\))\>\""}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"FontSize", "\[Rule]", "18"}], ",", "Black", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}]}],
           "]"}]}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Scientific\>\""}], ",", 
        RowBox[{"Mesh", "->", "All"}], ",", 
        RowBox[{"MeshStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Gray", ",", "Dashed"}], "]"}]}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "0.005", "]"}], ",", "18", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Row\>\"", ",", "\"\<Column\>\""}], "}"}]}]}], "]"}]}], 
     ";", "\n", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"GraphicsRow", "[", 
       RowBox[{"{", 
        RowBox[{"corrplot1", ",", "hm1"}], "}"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"lagoonDataIn", "=", 
      RowBox[{"cmup1", "[", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"#MutantID", "\[Equal]", "\"\<WT\>\""}], "&"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"lagoonData", "=", 
      RowBox[{"Values", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"lagoonDataIn", "[", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Indices\>\"", ",", "\"\<LagoonMedianIntensity\>\"", ",", 
            "\"\<fit_mmscaled-optlin_kcatMMfit\>\"", ",", 
            "\"\<kcat_lagoon_rescaled\>\""}], "}"}]}], "]"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Callout", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lagoonData", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"lagoonData", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"lagoonData", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"Length", "[", "lagoonData", "]"}]}], "}"}]}], "]"}], 
       "]"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"gatheredbyColumnLagoon", "=", 
      RowBox[{"Gather", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"test2Lagoon", ",", "1"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "\[Equal]", 
          RowBox[{"#2", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"gatheredbyRowLagoon", "=", 
      RowBox[{"Gather", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"test2Lagoon", ",", "1"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], "\[Equal]", 
          RowBox[{"#2", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\n", "\[IndentingNewLine]", 
     RowBox[{"columnSortPostLagoon", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"gatheredbyColumnLagoon", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], ",", 
            
            RowBox[{"gatheredbyColumnLagoon", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "All", ",", "5"}], "]"}], "]"}], ",", 
            RowBox[{"Mean", "[", 
             RowBox[{"gatheredbyColumnLagoon", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "All", ",", "5"}], "]"}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "gatheredbyColumnLagoon", "]"}]}], "}"}]}],
          "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ">", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"columnSortPlot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{"columnSortPostLagoon", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "2", ",", "i"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"Length", "[", "columnSortPostLagoon", "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"columnSortPostLagoon", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], ",", "1"}], "]"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Darker", "[", "Red", "]"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "0.0025", "]"}], ",", "18"}], "]"}]}], 
        ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Post-Sort Index (Column)\>\"", ",", 
           "\"\<\!\(\*FractionBox[RowBox[{SubscriptBox[\\\"k\\\", \
RowBox[{\\\"cat\\\", \\\",\\\", RowBox[{\\\"mutant\\\", \\\" \\\", \
StyleBox[\\\"i\\\",FontSlant->\\\"Italic\\\"]}]}]], \\\" \\\"}], \
RowBox[{\\\"<\\\", SubscriptBox[\\\"k\\\", RowBox[{\\\"cat\\\", \\\",\\\", \
RowBox[{\\\"mutant\\\", \\\" \\\", StyleBox[\\\"i\\\",FontSlant->\\\"Italic\\\
\"]}]}]], \\\">\\\"}]]\)\>\""}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"columnSortPlotMeans", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Callout", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{"columnSortPostLagoon", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"columnSortPostLagoon", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "columnSortPostLagoon", "]"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Darker", "[", "Red", "]"}], ",", 
           RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "0.0025", "]"}], ",", "18"}], "]"}]}], 
        ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Post-Sort Index (Column)\>\"", ",", 
           "\"\<\!\(\*FractionBox[RowBox[{SubscriptBox[\\\"k\\\", \
RowBox[{\\\"cat\\\", \\\",\\\", RowBox[{\\\"mutant\\\", \\\" \\\", \
StyleBox[\\\"i\\\",FontSlant->\\\"Italic\\\"]}]}]], \\\" \\\"}], \
RowBox[{\\\"<\\\", SubscriptBox[\\\"k\\\", RowBox[{\\\"cat\\\", \\\",\\\", \
RowBox[{\\\"mutant\\\", \\\" \\\", StyleBox[\\\"i\\\",FontSlant->\\\"Italic\\\
\"]}]}]], \\\">\\\"}]]\)\>\""}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rowSortPostLagoon", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"gatheredbyRowLagoon", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}], ",", 
            
            RowBox[{"gatheredbyRowLagoon", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "All", ",", "5"}], "]"}], "]"}], ",", 
            RowBox[{"Mean", "[", 
             RowBox[{"gatheredbyRowLagoon", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "All", ",", "5"}], "]"}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "gatheredbyRowLagoon", "]"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ">", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rowSortPlot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{"rowSortPostLagoon", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "2", ",", "i"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"Length", "[", "rowSortPostLagoon", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"rowSortPostLagoon", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], ",", "1"}], "]"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Darker", "[", "Red", "]"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "0.0025", "]"}], ",", "18"}], "]"}]}], 
        ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Post-Sort Index (Row)\>\"", ",", 
           "\"\<\!\(\*FractionBox[RowBox[{SubscriptBox[\\\"k\\\", \
RowBox[{\\\"cat\\\", \\\",\\\", RowBox[{\\\"mutant\\\", \\\" \\\", \
StyleBox[\\\"i\\\",FontSlant->\\\"Italic\\\"]}]}]], \\\" \\\"}], \
RowBox[{\\\"<\\\", SubscriptBox[\\\"k\\\", RowBox[{\\\"cat\\\", \\\",\\\", \
RowBox[{\\\"mutant\\\", \\\" \\\", StyleBox[\\\"i\\\",FontSlant->\\\"Italic\\\
\"]}]}]], \\\">\\\"}]]\)\>\""}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rowSortPlotMeans", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Callout", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{"rowSortPostLagoon", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"rowSortPostLagoon", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "rowSortPostLagoon", "]"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Darker", "[", "Red", "]"}], ",", 
           RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "0.0025", "]"}], ",", "18"}], "]"}]}], 
        ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Post-Sort Index (Row)\>\"", ",", 
           "\"\<\!\(\*FractionBox[RowBox[{SubscriptBox[\\\"k\\\", \
RowBox[{\\\"cat\\\", \\\",\\\", RowBox[{\\\"mutant\\\", \\\" \\\", \
StyleBox[\\\"i\\\",FontSlant->\\\"Italic\\\"]}]}]], \\\" \\\"}], \
RowBox[{\\\"<\\\", SubscriptBox[\\\"k\\\", RowBox[{\\\"cat\\\", \\\",\\\", \
RowBox[{\\\"mutant\\\", \\\" \\\", StyleBox[\\\"i\\\",FontSlant->\\\"Italic\\\
\"]}]}]], \\\">\\\"}]]\)\>\""}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"GraphicsGrid", "[", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"columnSortPlot", ",", "columnSortPlotMeans", ",", 
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"PointLegend", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Darker", "[", "Red", "]"}], "}"}], ",", 
                 RowBox[{"{", "\"\<Column Mean\>\"", "}"}], ",", 
                 RowBox[{"LegendMarkers", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"Graphics", "[", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", "100"}], 
                    "]"}], "]"}], "}"}]}], ",", 
                 RowBox[{"LegendMarkerSize", "\[Rule]", "15"}], ",", 
                 RowBox[{"LabelStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"18", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                   "]"}]}]}], "]"}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.8", ",", "0.9"}], "}"}], "]"}]}], "]"}]}]}], 
           "]"}], ",", 
          RowBox[{"Show", "[", 
           RowBox[{"rowSortPlot", ",", "rowSortPlotMeans", ",", 
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"PointLegend", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Darker", "[", "Red", "]"}], "}"}], ",", 
                 RowBox[{"{", "\"\<Row Mean\>\"", "}"}], ",", 
                 RowBox[{"LegendMarkers", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"Graphics", "[", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", "100"}], 
                    "]"}], "]"}], "}"}]}], ",", 
                 RowBox[{"LegendMarkerSize", "\[Rule]", "15"}], ",", 
                 RowBox[{"LabelStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"18", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                   "]"}]}]}], "]"}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.8", ",", "0.9"}], "}"}], "]"}]}], "]"}]}]}], 
           "]"}]}], "}"}], "}"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"associations", " ", "of", " ", "correction", " ", "factors"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"corrMapColumn", "=", 
      RowBox[{"AssociationThread", "[", 
       RowBox[{
        RowBox[{"columnSortPostLagoon", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"columnSortPostLagoon", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"corrMapRow", "=", 
      RowBox[{"AssociationThread", "[", 
       RowBox[{
        RowBox[{"rowSortPostLagoon", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"rowSortPostLagoon", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"columnCorrectedWT", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lagoonData", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"lagoonData", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "4"}], "]"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"corrMapColumn", "[", 
              RowBox[{"lagoonData", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "1", ",", "1"}], "]"}], "]"}], "]"}]}], 
            ")"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "lagoonData", "]"}]}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", "\n", 
     RowBox[{"forColumnCorrection", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"test2Lagoon", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"reGathered", "=", 
      RowBox[{"Gather", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"forColumnCorrection", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"forColumnCorrection", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "4"}], "]"}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"corrMapColumn", "[", 
                RowBox[{"forColumnCorrection", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "2", ",", "1"}], "]"}], "]"}], "]"}]}], 
              ")"}]}], ",", 
            RowBox[{"forColumnCorrection", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "forColumnCorrection", "]"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"plot", " ", "wt", " ", "pairs"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"wtColumnCorrected", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"reGathered", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", 
             "\"\<WT\>\""}], "&"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"RMSE", " ", "across", " ", "replicates"}], ",", " ", 
       RowBox[{"kcat_column", "_corrected"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rmse2", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"reGathered", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "i", ",", "2"}], "]"}], "]"}], "-", 
               RowBox[{"Mean", "[", 
                RowBox[{
                 RowBox[{"reGathered", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ")"}], 
             "^", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"reGathered", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "reGathered", "]"}]}], "}"}]}], "]"}], "/", 
        RowBox[{"Length", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"reGathered", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"wtPairsColumnCorrected", "=", 
      RowBox[{"ListLogLogPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Callout", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"wtColumnCorrected", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"wtColumnCorrected", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "2", ",", "2"}], "]"}], "]"}]}], "}"}], 
            ",", "\"\<WT\>\""}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "wtTest", "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Darker", "[", "Red", "]"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.1", ",", "1000.0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.1", ",", "1000.0"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "0.0025", "]"}], ",", "18", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(k\), \(cat, rep1\)]\) (/s)\>\"", ",", 
           "\"\<\!\(\*SubscriptBox[\(k\), \(cat, rep2\)]\) (/s)\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"rowCorrectedWT", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lagoonData", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"columnCorrectedWT", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "2"}], "]"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"corrMapRow", "[", 
              RowBox[{"columnCorrectedWT", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "1", ",", "2"}], "]"}], "]"}], "]"}]}], 
            ")"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "lagoonData", "]"}]}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", "\n", 
     RowBox[{"Print", "[", 
      RowBox[{"GraphicsRow", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Histogram", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lagoonData", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "4"}], "]"}], "]"}], ",", 
             RowBox[{"columnCorrectedWT", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", "10", "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "All"}], "}"}], ",", "All"}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"Frame", "->", "True"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{"Style", "[", 
             RowBox[{
             "\"\<Wild-type Dist. After Column Correction\>\"", ",", "Black", 
              ",", "18", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}], 
           ",", 
           RowBox[{"FrameStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", 
              RowBox[{"Thickness", "[", "0.0025", "]"}], ",", "18"}], "]"}]}],
            ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(k\), \(cat\)]\) (/s)\>\"", ",", 
              "\"\<Counts\>\""}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Histogram", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lagoonData", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "4"}], "]"}], "]"}], ",", 
             RowBox[{"rowCorrectedWT", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", "10", "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "All"}], "}"}], ",", "All"}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "All"}], "}"}], ",", "All"}], "}"}]}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{"Style", "[", 
             RowBox[{
             "\"\<Wild-type Dist. After Column & Row Correction\>\"", ",", 
              "Black", ",", "18", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}], 
           ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"Frame", "->", "True"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"FrameStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", 
              RowBox[{"Thickness", "[", "0.0025", "]"}], ",", "18"}], "]"}]}],
            ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(k\), \(cat\)]\) (/s)\>\"", ",", 
              "\"\<Counts\>\""}], "}"}]}]}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"forRowCorrection", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"reGathered", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"reGatheredRow", "=", 
      RowBox[{"Gather", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"forRowCorrection", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"forRowCorrection", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "2"}], "]"}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"corrMapRow", "[", 
                RowBox[{"forRowCorrection", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "3", ",", "2"}], "]"}], "]"}], "]"}]}], 
              ")"}]}], ",", 
            RowBox[{"forRowCorrection", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "forRowCorrection", "]"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"plot", " ", "wt", " ", "pairs"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"wtRowCorrected", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"reGatheredRow", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", 
             "\"\<WT\>\""}], "&"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"wtPairsRowCorrected", "=", 
      RowBox[{"ListLogLogPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Callout", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"wtRowCorrected", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"wtRowCorrected", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "2", ",", "2"}], "]"}], "]"}]}], "}"}], 
            ",", "\"\<WT\>\""}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "wtRowCorrected", "]"}]}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Darker", "[", "Red", "]"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.1", ",", "1000.0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.1", ",", "1000.0"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "0.0025", "]"}], ",", "18", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(k\), \(cat, rep1\)]\) (/s)\>\"", ",", 
           "\"\<\!\(\*SubscriptBox[\(k\), \(cat, rep2\)]\) (/s)\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"RMSE", " ", "across", " ", "replicates"}], ",", " ", 
       RowBox[{"kcat_row", "_corrected"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rmse3", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"reGatheredRow", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "i", ",", "2"}], "]"}], "]"}], "-", 
               RowBox[{"Mean", "[", 
                RowBox[{
                 RowBox[{"reGatheredRow", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ")"}], 
             "^", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"reGatheredRow", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "reGatheredRow", "]"}]}], "}"}]}], "]"}], 
        "/", 
        RowBox[{"Length", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"reGatheredRow", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"legend", "=", 
      RowBox[{"SwatchLegend", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorData", "[", "97", "]"}], "[", "1", "]"}], ",", 
            RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}], ",", 
          RowBox[{"Darker", "[", "Red", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Uncorrected\>\"", ",", "\"\<Corrected\>\""}], "}"}], 
        ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"18", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}], ",", 
        RowBox[{"LegendMarkerSize", "\[Rule]", "20"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"GraphicsRow", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"fixLogPlots", "@", 
            RowBox[{"ListLogLogPlot", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Callout", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"reGathered", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"reGathered", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2", ",", "2"}], "]"}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"reGathered", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1", ",", "1"}], "]"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", "1", ",", 
                  RowBox[{"Length", "[", "reGathered", "]"}]}], "}"}]}], 
               "]"}], ",", 
              RowBox[{"PlotLabel", "\[Rule]", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<After Column Correction\>\"", ",", "Black", ",", "18", 
                 ",", 
                 RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                "]"}]}], ",", 
              RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0.1", ",", "10000.0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0.1", ",", "10000.0"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"Darker", "[", "Red", "]"}]}], ",", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"Axes", "\[Rule]", "False"}], ",", 
              RowBox[{"FrameStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"Black", ",", 
                 RowBox[{"Thickness", "[", "0.0025", "]"}], ",", "18", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                "]"}]}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(k\), \(cat, rep1\)]\) (/s)\>\"", 
                 ",", "\"\<\!\(\*SubscriptBox[\(k\), \(cat, rep2\)]\) \
(/s)\>\""}], "}"}]}], ",", 
              RowBox[{"Epilog", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Inset", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<RMSE = \>\"", "<>", 
                    RowBox[{"ToString", "[", "rmse2", "]"}]}], ",", "18", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                    "]"}], ",", 
                   RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.8", ",", "0.2"}], "}"}], "]"}]}], "]"}], ",", 
                 RowBox[{"Inset", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    "\"\<\!\(\*StyleBox[\\\"n\\\",FontSlant->\\\"Italic\\\"]\)\
 = \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"Length", "[", "test1", "]"}], "]"}]}], ",", "18",
                     ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                    "]"}], ",", 
                   RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.8", ",", "0.12"}], "}"}], "]"}]}], "]"}], ",", 
                 
                 RowBox[{"Inset", "[", 
                  RowBox[{"legend", ",", 
                   RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.2", ",", "0.8"}], "}"}], "]"}]}], "]"}]}], 
                "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "wtPairsColumnCorrected", ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"ListLogLogPlot", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"test1", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1", ",", "4"}], "]"}], "]"}], ",", 
                 RowBox[{"test1", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "2", ",", "4"}], "]"}], "]"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "test1", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Opacity", "[", "0.3", "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.1", ",", "10000.0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.1", ",", "10000.0"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"Axes", "\[Rule]", "False"}], ",", 
             RowBox[{"FrameStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Black", ",", 
                RowBox[{"Thickness", "[", "0.0025", "]"}], ",", "18", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}],
              ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\!\(\*SubscriptBox[\(k\), \(cat, rep1\)]\) (/s)\>\"", 
                ",", "\"\<\!\(\*SubscriptBox[\(k\), \(cat, rep2\)]\) \
(/s)\>\""}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"LogLogPlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"x", "/", "2"}], ",", 
               RowBox[{"x", "*", "2"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0.01", ",", "10000.0"}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Gray", ",", 
                RowBox[{"Opacity", "[", "0.75", "]"}], ",", "Dashed"}], 
               "]"}]}]}], "]"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "700"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"fixLogPlots", "@", 
            RowBox[{"ListLogLogPlot", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Callout", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"reGatheredRow", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"reGatheredRow", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2", ",", "2"}], "]"}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"reGatheredRow", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1", ",", "1"}], "]"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", "1", ",", 
                  RowBox[{"Length", "[", "reGatheredRow", "]"}]}], "}"}]}], 
               "]"}], ",", 
              RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
              RowBox[{"PlotLabel", "\[Rule]", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<After Column & Row Correction\>\"", ",", "Black", ",", 
                 "18", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                "]"}]}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0.1", ",", "10000.0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0.1", ",", "10000.0"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"Darker", "[", "Red", "]"}]}], ",", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"Axes", "\[Rule]", "False"}], ",", 
              RowBox[{"FrameStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"Black", ",", 
                 RowBox[{"Thickness", "[", "0.0025", "]"}], ",", "18", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                "]"}]}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(k\), \(cat, rep1\)]\) (/s)\>\"", 
                 ",", "\"\<\!\(\*SubscriptBox[\(k\), \(cat, rep2\)]\) \
(/s)\>\""}], "}"}]}], ",", 
              RowBox[{"Epilog", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Inset", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<RMSE = \>\"", "<>", 
                    RowBox[{"ToString", "[", "rmse3", "]"}]}], ",", "18", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                    "]"}], ",", 
                   RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.8", ",", "0.2"}], "}"}], "]"}]}], "]"}], ",", 
                 RowBox[{"Inset", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    "\"\<\!\(\*StyleBox[\\\"n\\\",FontSlant->\\\"Italic\\\"]\)\
 = \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"Length", "[", "test1", "]"}], "]"}]}], ",", "18",
                     ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                    "]"}], ",", 
                   RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.8", ",", "0.12"}], "}"}], "]"}]}], "]"}], ",", 
                 
                 RowBox[{"Inset", "[", 
                  RowBox[{"legend", ",", 
                   RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.2", ",", "0.8"}], "}"}], "]"}]}], "]"}]}], 
                "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "wtPairsRowCorrected", ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"ListLogLogPlot", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"test1", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1", ",", "4"}], "]"}], "]"}], ",", 
                 RowBox[{"test1", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "2", ",", "4"}], "]"}], "]"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "test1", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Opacity", "[", "0.3", "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.1", ",", "10000.0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.1", ",", "10000.0"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"Axes", "\[Rule]", "False"}], ",", 
             RowBox[{"FrameStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Black", ",", 
                RowBox[{"Thickness", "[", "0.0025", "]"}], ",", "18", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}],
              ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\!\(\*SubscriptBox[\(k\), \(cat, rep1\)]\) (/s)\>\"", 
                ",", "\"\<\!\(\*SubscriptBox[\(k\), \(cat, rep2\)]\) \
(/s)\>\""}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"LogLogPlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"x", "/", "2"}], ",", 
               RowBox[{"x", "*", "2"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0.01", ",", "10000.0"}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Gray", ",", 
                RowBox[{"Opacity", "[", "0.75", "]"}], ",", "Dashed"}], 
               "]"}]}]}], "]"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "700"}]}], "]"}]}], "}"}]}], "]"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"correct", " ", "all", " ", "mutants", " ", 
       RowBox[{"(", 
        RowBox[{
        "including", " ", "those", " ", "without", " ", "replicates"}], 
        " "}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"allMutants", "=", 
      RowBox[{"Values", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"cmup1", "[", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<MutantID\>\"", ",", "\"\<Indices\>\"", ",", 
            "\"\<fit_mmscaled-optlin_kcatMMfit\>\"", ",", 
            "\"\<kcat_lagoon_rescaled\>\""}], "}"}]}], "]"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"allColumnCorrected", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"allMutants", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"allMutants", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "4"}], "]"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"corrMapColumn", "[", 
              RowBox[{"allMutants", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "2", ",", "1"}], "]"}], "]"}], "]"}]}], 
            ")"}]}], ",", 
          RowBox[{"allMutants", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "allMutants", "]"}]}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"allRowCorrected", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"allColumnCorrected", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"allColumnCorrected", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "2"}], "]"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"corrMapRow", "[", 
              RowBox[{"allColumnCorrected", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "3", ",", "2"}], "]"}], "]"}], "]"}]}], 
            ")"}]}], ",", 
          RowBox[{"allColumnCorrected", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "allColumnCorrected", "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"out1", "=", "allRowCorrected"}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Association", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Indices\>\"", "->", 
            RowBox[{"out1", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "3"}], "]"}], "]"}]}], ",", 
           RowBox[{"\"\<kcat_chip_corrected\>\"", "\[Rule]", 
            RowBox[{"out1", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "2"}], "]"}], "]"}]}]}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "out1", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"appended", "=", 
      RowBox[{"Dataset", "[", 
       RowBox[{"JoinAcross", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "dataset", "]"}], ",", "out2", ",", 
         "\"\<Indices\>\"", ",", "\"\<Left\>\""}], "]"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellOpen->False,
 CellChangeTimes->{
  3.74675229744523*^9, {3.746752334093453*^9, 3.7467523558239193`*^9}, {
   3.746832163243703*^9, 3.746832166652651*^9}, 3.746832275930723*^9, {
   3.746832660075675*^9, 3.7468326618300343`*^9}, {3.746832692184739*^9, 
   3.746832704696476*^9}, {3.746833084935772*^9, 3.7468331255003138`*^9}, {
   3.746833451526888*^9, 3.746833458980784*^9}, {3.746833513546666*^9, 
   3.74683354443454*^9}, {3.746833668730372*^9, 3.746833803153961*^9}, {
   3.746834489567627*^9, 3.7468344897464542`*^9}, {3.7468345596795073`*^9, 
   3.746834571236965*^9}, {3.746834773996976*^9, 3.7468347744427958`*^9}, {
   3.746837570993325*^9, 3.746837585517165*^9}, {3.746838614803377*^9, 
   3.746838621060834*^9}, {3.746838820903076*^9, 3.746838880226556*^9}, {
   3.7468890877132187`*^9, 3.746889142569558*^9}, {3.7520071899770184`*^9, 
   3.75200719181182*^9}, 3.752007807599628*^9, 3.75200789093885*^9, {
   3.752007929499342*^9, 3.7520079315865383`*^9}, {3.752007972232458*^9, 
   3.7520080167789183`*^9}, {3.7578625692530107`*^9, 3.7578625702824*^9}, {
   3.757862642963337*^9, 3.757862653906605*^9}, {3.7578627582917747`*^9, 
   3.75786276206854*^9}},
 CellLabel->
  "In[586]:=",ExpressionUUID->"e31f638d-2a49-44f9-afae-6e2bde60e047"],

Cell[BoxData[
 RowBox[{
  RowBox[{"outCorrected", "=", 
   RowBox[{"chipCorrection", "[", "addedRescaledkcat", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.752007825265195*^9, 3.752007832732798*^9}, {
  3.752008025956683*^9, 3.752008029469771*^9}},
 CellLabel->
  "In[588]:=",ExpressionUUID->"60c5e0c1-214d-4743-a13b-10a03680bb53"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export data:", "Section",
 CellChangeTimes->{{3.756424802506361*^9, 
  3.756424826033737*^9}},ExpressionUUID->"0c65e13c-68a7-4769-a07a-\
2ece372d26bb"],

Cell["\<\
These cells export data to wxf format (dataset format which includes all \
data, plots, and symbolic output) and csv format (text format of data and \
fitted parameters). In practice, both formats are useful and both should be \
exported. The dataset format allows for subsequent calculations without \
having to re-read in and process data, while the csv files are much smaller \
and contain the key fitted parameters for making interpretive plots, etc.\
\>", "Text",
 CellChangeTimes->{{3.756424829022661*^9, 
  3.7564250085428457`*^9}},ExpressionUUID->"2f01dfa5-6d3f-475f-8592-\
e308c2447f7d"],

Cell[CellGroupData[{

Cell["15. Export aggregate dataset:", "Subsubsection",
 CellChangeTimes->{{3.734212756608108*^9, 3.734212760958433*^9}, {
  3.739204320881682*^9, 3.7392043215975113`*^9}, {3.740854722214658*^9, 
  3.740854722339797*^9}, {3.752007856435577*^9, 
  3.7520078565115757`*^9}},ExpressionUUID->"9a77bf06-7afb-476f-adeb-\
341a0fd5b4b5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"outName", "=", "\"\<180528_S2d1_PafA_ValScan_cMUP\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"safeExport", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{
    "\"\</Users/craig/Desktop/\>\"", ",", "outName", ",", "\"\<.wxf\>\""}], 
    "]"}], ",", "outCorrected", ",", 
   RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Size\>\""}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.740855328621418*^9, 3.740855330401301*^9}, 
   3.740857527397503*^9, {3.740858167767723*^9, 3.740858198796156*^9}, 
   3.740860558190298*^9, 3.740861590355184*^9, 3.740862378279825*^9, {
   3.740953393713274*^9, 3.740953405956295*^9}, {3.741106628654375*^9, 
   3.7411066318372593`*^9}, {3.74119278530158*^9, 3.7411927853914633`*^9}, {
   3.7413157071074047`*^9, 3.741315719489604*^9}, {3.741318786693131*^9, 
   3.7413187869977703`*^9}, {3.7413196404696302`*^9, 3.741319641249415*^9}, {
   3.7420608905215187`*^9, 3.7420609232218237`*^9}, {3.7421743514317513`*^9, 
   3.7421743614362*^9}, {3.742323671497549*^9, 3.742323683904477*^9}, {
   3.742338462790601*^9, 3.7423384630460377`*^9}, {3.742400733647044*^9, 
   3.742400752640842*^9}, {3.742414542609723*^9, 3.742414542745048*^9}, {
   3.742416073125043*^9, 3.742416083627261*^9}, {3.742493518798389*^9, 
   3.7424935456245623`*^9}, {3.742505231248094*^9, 3.742505257057098*^9}, {
   3.742508131812928*^9, 3.7425081355851097`*^9}, {3.742511707598372*^9, 
   3.742511707801855*^9}, {3.742515581630163*^9, 3.74251558476191*^9}, {
   3.7425156248990517`*^9, 3.7425156492993803`*^9}, {3.742518619232768*^9, 
   3.742518620395651*^9}, {3.74275170016763*^9, 3.7427517108549767`*^9}, {
   3.7427535107276897`*^9, 3.742753510938796*^9}, {3.7427575288599854`*^9, 
   3.742757529108864*^9}, {3.742758846511003*^9, 3.742758849224998*^9}, {
   3.742764518685611*^9, 3.742764529433968*^9}, {3.742819519685075*^9, 
   3.742819519981883*^9}, {3.7429297744105043`*^9, 3.74292978200701*^9}, {
   3.743038040634779*^9, 3.743038050807624*^9}, {3.743038087579008*^9, 
   3.7430380956938457`*^9}, {3.752005976699782*^9, 3.7520059863692408`*^9}, {
   3.752006323572122*^9, 3.7520063304580383`*^9}, {3.7520079220796747`*^9, 
   3.752007923113442*^9}, {3.752806484606042*^9, 3.752806502701551*^9}, {
   3.756428462945911*^9, 3.75642847524402*^9}, {3.757604241316819*^9, 
   3.757604248561451*^9}, {3.7576067623890343`*^9, 3.757606764400153*^9}, {
   3.7576251219169703`*^9, 3.757625122073832*^9}, {3.757640094793989*^9, 
   3.7576400971904087`*^9}, {3.757646385048089*^9, 3.75764638524249*^9}, {
   3.757691735746819*^9, 3.757691741926832*^9}, {3.757790899096478*^9, 
   3.757790902432929*^9}, {3.757797475159335*^9, 3.757797479739352*^9}, {
   3.757823713220702*^9, 3.757823743331646*^9}, {3.75785972405628*^9, 
   3.7578597256448603`*^9}, {3.7593471768927402`*^9, 3.759347183382901*^9}, {
   3.761239645185063*^9, 
   3.761239645883256*^9}},ExpressionUUID->"a0ae8d6c-7c18-4868-8df4-\
5db4ea265501"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
15a. Export CSV of all compatible data types (string, integer, list, real):\
\>", "Subsubsection",
 CellChangeTimes->{{3.734189486408122*^9, 3.7341895106160927`*^9}, {
  3.739204323001759*^9, 3.73920432371455*^9}, {3.740854723329686*^9, 
  3.740854723447792*^9}, {3.7520077625529623`*^9, 3.752007763397131*^9}, {
  3.75200784336369*^9, 
  3.7520078576405907`*^9}},ExpressionUUID->"2a7e32a4-2445-4f03-b154-\
5dba791a4164"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"normalizedDataset", "=", 
    RowBox[{"Normal", "[", "outCorrected", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"replaced", "=", 
    RowBox[{"Fold", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{"#1", ",", "#2", ",", "Infinity"}], "]"}], "&"}], ",", 
      "normalizedDataset", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_FittedModel", "\[Rule]", "\"\<NaN\>\""}], ",", 
        RowBox[{"_Graphics", "\[Rule]", "\"\<NaN\>\""}], ",", 
        RowBox[{"_Image", "\[Rule]", "\"\<NaN\>\""}], ",", 
        RowBox[{"_NonlinearModelFit", "\[Rule]", "\"\<NaN\>\""}], ",", 
        RowBox[{"_Times", "\[Rule]", "\"\<NaN\>\""}], ",", 
        RowBox[{"_Overlay", "\[Rule]", "\"\<NaN\>\""}], ",", 
        RowBox[{"_ReplaceAll", "\[Rule]", "\"\<NaN\>\""}]}], "}"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"headers", "=", 
    RowBox[{"Keys", "[", 
     RowBox[{"replaced", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"values", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"replaceBracketsBack", ",", 
       RowBox[{"Values", "[", "replaced", "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"values", "=", 
    RowBox[{"Values", "[", "replaced", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"datasetForExport", "=", 
    RowBox[{"Prepend", "[", 
     RowBox[{"values", ",", "headers"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"safeExport", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{
    "\"\</Users/craig/Desktop/\>\"", ",", "outName", ",", 
     "\"\<.csv.bz2\>\""}], "]"}], ",", "datasetForExport", ",", 
   "\"\<Data\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.737657601018197*^9, 3.737657624028406*^9}, {
   3.7376672725791616`*^9, 3.737667283977404*^9}, {3.737668118738617*^9, 
   3.7376681325440617`*^9}, {3.737668544038116*^9, 3.73766854447711*^9}, {
   3.73774269030485*^9, 3.737742692368063*^9}, {3.738427975083262*^9, 
   3.7384280152709627`*^9}, {3.738954419374605*^9, 3.738954420792205*^9}, 
   3.740344782787072*^9, {3.740953571026223*^9, 3.7409536068963747`*^9}, {
   3.752006046305841*^9, 3.7520060496657476`*^9}, {3.756428679323844*^9, 
   3.756428690000704*^9}, {3.759347195734453*^9, 3.75934719742522*^9}, {
   3.761239650823976*^9, 
   3.761239651647806*^9}},ExpressionUUID->"95f5c769-bfb5-41da-a148-\
b26e45c33ee2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["PDF export:", "Section",
 CellChangeTimes->{{3.756425019731593*^9, 
  3.7564250221395187`*^9}},ExpressionUUID->"778d5468-10d4-4354-b464-\
07b05a0b3704"],

Cell[CellGroupData[{

Cell["15b. Generate summary PDF pages:", "Subsubsection",
 CellChangeTimes->{{3.7349637995225077`*^9, 3.734963809455359*^9}, {
  3.739204325161806*^9, 3.73920432617941*^9}, {3.740854725068006*^9, 
  3.740854726589653*^9}, {3.752007764605932*^9, 3.752007765012834*^9}, {
  3.752007845637863*^9, 
  3.752007859397828*^9}},ExpressionUUID->"19749ecf-f6e0-42cc-8b75-\
d68f97e3f392"],

Cell["\<\
Individual PDF pages are output to a working directory. Stitching of PDFs is \
done using an external python session running PyPDF2.\
\>", "Text",
 CellChangeTimes->{{3.734963811562787*^9, 
  3.7349638470087233`*^9}},ExpressionUUID->"b9b7db25-3143-4281-8a95-\
103b684baa21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"addedMMcalc", "=", 
   RowBox[{
   "Import", "[", "\"\<~/Desktop/180614_S3d1_PafA_GlyScan_cMUP.wxf\>\"", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.738955676594651*^9, 3.738955692418371*^9}, {
  3.740102228247582*^9, 3.740102251521089*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"b19cd32a-6f67-49e1-8238-29b6db470645"],

Cell[BoxData["addedMMcalc"], "Input",
 CellChangeTimes->{{3.740102310649349*^9, 3.740102311363324*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"575d9352-d2be-4e33-9d33-65f914f3ab37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dataset", "=", "outCorrected"}], ";"}]], "Input",
 CellChangeTimes->{{3.7379094173245068`*^9, 3.7379094187433023`*^9}, {
  3.738089073605175*^9, 3.7380890785375423`*^9}, {3.757873468474896*^9, 
  3.757873470618771*^9}},
 CellLabel->
  "In[597]:=",ExpressionUUID->"486c88de-a59a-47b7-bd13-d072a268d5be"],

Cell[BoxData[
 RowBox[{"makeGrid", "[", 
  RowBox[{"dataset", ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "10"}], "}"}], ",", "\"\<cMUP\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.759347313530065*^9, 3.759347343560161*^9}, {
  3.759347495073153*^9, 3.759347495457491*^9}},
 CellLabel->
  "In[598]:=",ExpressionUUID->"453e7401-bdf9-4e09-bcf5-3ab61b3bc824"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"indices", "=", 
    RowBox[{"Sort", "[", 
     RowBox[{"Normal", "[", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"dataset", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "\"\<Indices\>\""}], "]"}], "]"}], "]"}], "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dynamic", "[", "n", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "change", " ", "3", "rd", " ", "argument", " ", "to", " ", "correspond", 
     " ", "to", " ", "type", " ", "of", " ", 
     RowBox[{"assay", ":", " ", "cMUP"}]}], ",", " ", "MeP", ",", " ", 
    "MecMUP", ",", " ", "Inhibition"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"out", "=", 
     RowBox[{"makeGrid", "[", 
      RowBox[{"dataset", ",", 
       RowBox[{"indices", "[", 
        RowBox[{"[", "n", "]"}], "]"}], ",", "\"\<cMUP\>\""}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{
       "\"\</Users/craig/Documents/Biochemistry/AP_enzymology/MITOMI/tempPDF/\
temporary_PDF_\>\"", ",", 
        RowBox[{"StringPadLeft", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "n", "]"}], ",", "4", ",", "\"\<0\>\""}], 
         "]"}], ",", "\"\<.pdf\>\""}], "]"}], ",", "out", ",", 
      RowBox[{"\"\<AllowRasterization\>\"", "\[Rule]", "False"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "1568"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.734968802754878*^9, 3.73496884924994*^9}, {
   3.734975973828043*^9, 3.7349759785186768`*^9}, {3.7349761556127987`*^9, 
   3.734976157836526*^9}, {3.734976630964161*^9, 3.7349767728034477`*^9}, {
   3.7352407445428658`*^9, 3.735240807389244*^9}, 3.735253388922279*^9, {
   3.73525347071425*^9, 3.735253473917111*^9}, {3.7352708205551977`*^9, 
   3.73527082126511*^9}, {3.73776383354399*^9, 3.737763841963129*^9}, {
   3.737763918798028*^9, 3.737763921961684*^9}, {3.737766464413*^9, 
   3.737766493896508*^9}, {3.7377701825753736`*^9, 3.7377702686829767`*^9}, {
   3.7378308515007343`*^9, 3.7378308523168716`*^9}, {3.737830886025773*^9, 
   3.737830888096822*^9}, {3.73783315219055*^9, 3.7378331552216*^9}, {
   3.7378366288578033`*^9, 3.7378366309612017`*^9}, {3.737837182030987*^9, 
   3.737837190498939*^9}, {3.737837284061532*^9, 3.7378373009006987`*^9}, {
   3.737837342171262*^9, 3.737837371587351*^9}, {3.737852311669195*^9, 
   3.737852335950115*^9}, {3.737852370825861*^9, 3.737852370971496*^9}, {
   3.737908884775505*^9, 3.7379088892306843`*^9}, 3.737909437487208*^9, {
   3.737909512861318*^9, 3.737909513572735*^9}, {3.737918251085771*^9, 
   3.737918251799322*^9}, {3.737918287574067*^9, 3.7379182911760683`*^9}, {
   3.737935260042219*^9, 3.73793527402769*^9}, {3.738360657898507*^9, 
   3.7383606580859013`*^9}, 3.738360839090804*^9, 3.738361205529189*^9, {
   3.738361389458673*^9, 3.7383613904823103`*^9}, {3.738371124847797*^9, 
   3.738371135226638*^9}, {3.738371172346424*^9, 3.73837118429666*^9}, {
   3.738371223510995*^9, 3.73837127043606*^9}, {3.738371313438038*^9, 
   3.7383713613243713`*^9}, {3.7383714025020933`*^9, 
   3.7383714118772707`*^9}, {3.73837144356236*^9, 3.738371444806272*^9}, {
   3.738371492725086*^9, 3.738371633297844*^9}, {3.738371707585731*^9, 
   3.738371710112852*^9}, {3.738371897831038*^9, 3.7383719155648527`*^9}, {
   3.738372074454234*^9, 3.738372081541424*^9}, {3.7383721270251007`*^9, 
   3.738372166431676*^9}, {3.7383722075908117`*^9, 3.738372240330531*^9}, {
   3.738372663764278*^9, 3.738372684757061*^9}, {3.738372720735841*^9, 
   3.738372726268684*^9}, {3.738372799243244*^9, 3.738372801139413*^9}, {
   3.738373593519457*^9, 3.7383736057036324`*^9}, {3.738373912715453*^9, 
   3.7383739966198606`*^9}, {3.7383740405776*^9, 3.7383740465142593`*^9}, {
   3.738374112832901*^9, 3.738374130944804*^9}, {3.738374248602914*^9, 
   3.7383742512738256`*^9}, {3.738374506775222*^9, 3.738374515037346*^9}, {
   3.738511808101075*^9, 3.738511830940919*^9}, {3.73851318456809*^9, 
   3.738513185841002*^9}, {3.7389546697455072`*^9, 3.7389547096302977`*^9}, {
   3.7389557124581223`*^9, 3.738955712979723*^9}, 3.7401020556412992`*^9},
 CellLabel->
  "In[599]:=",ExpressionUUID->"c8ecf4c5-6b4e-4de7-b108-5db31abaa2d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["15c. Join PDFs:", "Subsubsection",
 CellChangeTimes->{{3.735240822666081*^9, 3.735240825410522*^9}, {
  3.737911154190567*^9, 3.737911155699547*^9}, {3.739204329129388*^9, 
  3.739204330555312*^9}, {3.740854729530922*^9, 3.7408547301322813`*^9}, {
  3.7520077670397263`*^9, 3.752007767344133*^9}, {3.7520078480118628`*^9, 
  3.752007862233399*^9}},ExpressionUUID->"d3a4e2aa-ed1a-4548-b455-\
2383a6a468f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"session", " ", "=", " ", 
   RowBox[{"StartExternalSession", "[", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<System\>\"", "\[Rule]", "\"\<Python\>\""}], ",", 
      RowBox[{"\"\<Version\>\"", "\[Rule]", "\"\<3.6\>\""}], ",", " ", 
      RowBox[{"\"\<SessionProlog\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<import os\>\"", ",", " ", 
         "\"\<from PyPDF2 import PdfFileMerger, PdfFileReader\>\""}], 
        "}"}]}]}], "|>"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "defineRoot", " ", "=", " ", 
   "\"\<root='/Users/craig/Documents/Biochemistry/AP_enzymology/MITOMI/\
tempPDF/'\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "getNames", " ", "=", " ", 
   "\"\<pdfs1=[os.path.join(root, dir) for dir in os.listdir(root) if '.pdf' \
in dir]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getNames2", "=", "\"\<pdfs=sorted(pdfs1)\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"createMerger", " ", "=", " ", "\"\<merger = PdfFileMerger()\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "executeMerge", " ", "=", " ", 
   "\"\<for pdf in pdfs: merger.append(PdfFileReader(pdf,'rb'))\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"executeExport", " ", "=", " ", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<merger.write('/Users/craig/Desktop/\>\"", ",", 
     RowBox[{
      RowBox[{"Values", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"dataset", "[", 
         RowBox[{"1", ",", 
          RowBox[{"{", "\"\<GlobalExperimentIndex\>\"", "}"}]}], "]"}], "]"}],
        "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<.pdf')\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "completionNotice", " ", "=", " ", 
   "\"\<print('PDF Concatenation Complete')\>\""}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQvfd4pUDGldeOPFqbRED0tUPqxeVA2qxkB5jeMqdh
UeTN146LxCaC6SJziyMg+tH+cDDdYfOIOwZIHz3BJQyi9Vh+nALRbT9iT4Po
69lvFiUC6bjnixaDaIFP5zVSgfSn+z06IFpk4a7rdUC6psDjJoiesnWmSj2Q
fhrYpgqiYzw4Ni6+9doxp6cWTKu+stsKome0v9sPopuKS86CaL4S+8sg2qH7
+Q0QnfbqM5h+ZlemtxRIX4jpAtNnTtz1A9GT3rgFgmij036JIFpOLT8dRB95
JZ0Loqd9+Z8Posuyb68A0XX5nStBNAAbX7Kv
  "],
 CellLabel->
  "In[602]:=",ExpressionUUID->"786c8a03-79c9-4f4e-8b98-d072bd810fcc"],

Cell[BoxData[
 RowBox[{"ExternalEvaluate", "[", 
  RowBox[{"session", ",", 
   RowBox[{"{", 
    RowBox[{
    "defineRoot", ",", " ", "getNames", ",", "getNames2", ",", " ", 
     "createMerger", ",", " ", "executeMerge", ",", " ", "executeExport", ",",
      " ", "completionNotice"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738508761367715*^9, 3.738508762051643*^9}, {
   3.7385089616031313`*^9, 3.738508963113728*^9}, {3.738512181215766*^9, 
   3.738512181394802*^9}, 3.7385122373978977`*^9},
 CellLabel->
  "In[610]:=",ExpressionUUID->"d752d9c5-fc3b-4370-abaf-51649e754b63"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
Evaluator->"Spare",
WindowSize->{1368, 1082},
WindowMargins->{{Automatic, 235}, {Automatic, 5}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 367, 6, 98, "Title",ExpressionUUID->"eb34816b-48f3-4f71-97ba-9ae535b70148"],
Cell[950, 30, 307, 6, 75, "Section",ExpressionUUID->"545968aa-b484-429a-86b2-1e1a3eac1cd1"],
Cell[CellGroupData[{
Cell[1282, 40, 177, 3, 53, "Section",ExpressionUUID->"af3b0309-97dd-46b1-9be6-5230c63f43b2"],
Cell[1462, 45, 287, 6, 35, "Text",ExpressionUUID->"cdf60f84-c263-443e-a51e-53a1af7c21a4"],
Cell[1752, 53, 318920, 7022, 19, "Input",ExpressionUUID->"3910e96f-8244-473b-938a-b403469393f0",
 CellOpen->False]
}, Open  ]],
Cell[CellGroupData[{
Cell[320709, 7080, 275, 5, 67, "Section",ExpressionUUID->"ba452b1b-3762-41f2-91e4-7d42bc0a6dd5"],
Cell[CellGroupData[{
Cell[321009, 7089, 194, 3, 45, "Subsubsection",ExpressionUUID->"a1c2ac4d-c70b-4b9a-a35f-542c3fe76cda"],
Cell[321206, 7094, 7133, 117, 367, "Input",ExpressionUUID->"c302fd43-2b8c-4e60-afba-6a3c47888d9d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[328376, 7216, 161, 3, 45, "Subsubsection",ExpressionUUID->"3040847f-1ddf-475b-9487-6211f982bf00"],
Cell[328540, 7221, 12870, 182, 94, "Input",ExpressionUUID->"bc4ea9a4-2bd6-45db-834f-23c53e78f053"]
}, Open  ]],
Cell[CellGroupData[{
Cell[341447, 7408, 196, 3, 45, "Subsubsection",ExpressionUUID->"6f9bfa0d-d327-433f-a9ee-d0c7c9032dcd"],
Cell[341646, 7413, 1261, 21, 94, "Input",ExpressionUUID->"5a1ce303-0331-486d-be4d-2ddcfd247a22"]
}, Open  ]],
Cell[CellGroupData[{
Cell[342944, 7439, 170, 3, 45, "Subsubsection",ExpressionUUID->"9144f08b-142c-4bf3-a463-262ed5147c13"],
Cell[343117, 7444, 3093, 78, 115, "Input",ExpressionUUID->"11515cb3-fd5a-4707-bf76-b0283a52be97"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[346259, 7528, 249, 4, 67, "Section",ExpressionUUID->"46e27fd9-8d24-4613-b1a0-27d6bce139d6"],
Cell[CellGroupData[{
Cell[346533, 7536, 438, 8, 45, "Subsubsection",ExpressionUUID->"eb4fc38c-b472-4b23-b4ea-71356699cde5"],
Cell[346974, 7546, 12187, 276, 892, "Input",ExpressionUUID->"1ba4cf3e-134b-4920-8d7d-da19aaefba58"]
}, Open  ]],
Cell[CellGroupData[{
Cell[359198, 7827, 269, 6, 45, "Subsubsection",ExpressionUUID->"283873b0-06e4-4db6-99c7-a58cb3d5d5aa"],
Cell[359470, 7835, 3538, 97, 283, "Input",ExpressionUUID->"7e8481bb-15f0-4486-a19a-e722fb59fc29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[363045, 7937, 375, 7, 45, "Subsubsection",ExpressionUUID->"c4c98381-81fe-4369-bd52-9a9146c924cc"],
Cell[363423, 7946, 835, 17, 30, "Input",ExpressionUUID->"779d71bb-0097-4ba2-81f8-47dd1ec7cba4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[364295, 7968, 752, 16, 45, "Subsubsection",ExpressionUUID->"fdcbc86f-9ea8-4ab0-aac9-25db2a59b58d"],
Cell[365050, 7986, 8943, 209, 808, "Input",ExpressionUUID->"24a33a3f-3bbb-47aa-835d-506a68ef003a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[374030, 8200, 187, 3, 45, "Subsubsection",ExpressionUUID->"e9ca8873-0e95-4c07-bbca-50b622337c0d"],
Cell[374220, 8205, 782, 19, 30, "Input",ExpressionUUID->"f757ca3f-804f-4e62-a5bc-4d2a1190b413"]
}, Open  ]],
Cell[CellGroupData[{
Cell[375039, 8229, 504, 12, 45, "Subsubsection",ExpressionUUID->"83393b69-ef95-427b-bfe9-34cc7352c217"],
Cell[375546, 8243, 3857, 78, 241, "Input",ExpressionUUID->"a8b62022-0b11-421c-8c76-1a28082b915a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[379452, 8327, 667, 19, 72, "Section",ExpressionUUID->"be703cf4-fc0f-4eba-8933-17df0a827e23"],
Cell[CellGroupData[{
Cell[380144, 8350, 621, 9, 45, "Subsubsection",ExpressionUUID->"3fd01350-f90b-405e-8382-cca5f2b27724"],
Cell[380768, 8361, 1900, 55, 241, "Input",ExpressionUUID->"49138dbc-91f2-421f-8c89-a57b80456354"]
}, Open  ]],
Cell[CellGroupData[{
Cell[382705, 8421, 566, 8, 45, "Subsubsection",ExpressionUUID->"7e1b16ad-aa62-4fc0-b266-f381d303b2d7"],
Cell[383274, 8431, 5813, 136, 535, "Input",ExpressionUUID->"8fbc1de9-211a-4c72-a4c2-8e0fda11c9d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[389124, 8572, 959, 23, 49, "Subsubsection",ExpressionUUID->"b5a10a85-42c8-40e5-a998-bbd7c06e8165"],
Cell[390086, 8597, 13643, 324, 19, "Input",ExpressionUUID->"179ae7d0-b320-4a9e-9721-ee7c827c970b",
 CellOpen->False]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[403778, 8927, 595, 14, 68, "Section",ExpressionUUID->"0ec943ab-e138-4783-8a7e-21fdc19d6b49"],
Cell[404376, 8943, 7047, 162, 640, "Input",ExpressionUUID->"3efefcf1-c2a7-4658-bcf5-b564a8826099"]
}, Open  ]],
Cell[CellGroupData[{
Cell[411460, 9110, 506, 13, 68, "Section",ExpressionUUID->"13b5a6ab-d4dd-47e5-82c5-fe8d59cc8447"],
Cell[411969, 9125, 3969, 99, 19, "Input",ExpressionUUID->"db82f1c4-85cc-4ba4-b030-7c0b55e0d71b",
 CellOpen->False]
}, Open  ]],
Cell[CellGroupData[{
Cell[415975, 9229, 826, 22, 111, "Section",ExpressionUUID->"e86bae5e-30a3-4231-a170-c58a9d7babd1"],
Cell[416804, 9253, 12060, 301, 1039, "Input",ExpressionUUID->"e31ad947-1d98-4516-b7cc-65c687aa5149"]
}, Open  ]],
Cell[CellGroupData[{
Cell[428901, 9559, 229, 4, 67, "Section",ExpressionUUID->"337c1a85-9ab8-413b-9101-65978ef2e360"],
Cell[429133, 9565, 5229, 123, 388, "Input",ExpressionUUID->"be21ad37-c587-491d-b59f-48d36e20a5f3"],
Cell[CellGroupData[{
Cell[434387, 9692, 399, 9, 97, "Subsubsection",ExpressionUUID->"c4fe18e6-ba2d-4fba-8b9b-53f0286afc96"],
Cell[434789, 9703, 6028, 164, 19, "Input",ExpressionUUID->"b3daf789-4835-494c-9166-b6b4c6148df0",
 CellOpen->False]
}, Open  ]],
Cell[CellGroupData[{
Cell[440854, 9872, 337, 7, 45, "Subsubsection",ExpressionUUID->"1c2ed1e4-ea0b-4371-994c-4d2ae4318bae"],
Cell[441194, 9881, 862, 19, 52, "Input",ExpressionUUID->"fafe4e52-78d7-4e37-b25f-41612042142f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[442093, 9905, 470, 9, 45, "Subsubsection",ExpressionUUID->"2af24838-cd92-46da-9d14-c91424f31a41"],
Cell[442566, 9916, 511, 9, 58, "Text",ExpressionUUID->"5c153538-adb9-4144-8b7b-a287b832adc1"],
Cell[443080, 9927, 6049, 153, 325, "Input",ExpressionUUID->"af5f712e-c564-409d-8171-8ce4dfb556a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[449166, 10085, 249, 4, 45, "Subsubsection",ExpressionUUID->"0b6dd568-4c0b-48a3-aebe-858b663ead9c"],
Cell[449418, 10091, 4258, 105, 331, "Input",ExpressionUUID->"7008d5d4-13f2-41c9-8f09-33c38b078bc1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[453725, 10202, 200, 3, 67, "Section",ExpressionUUID->"889ada2f-a31e-4ed1-bd97-a20ff6338627"],
Cell[CellGroupData[{
Cell[453950, 10209, 560, 9, 45, "Subsubsection",ExpressionUUID->"a4595276-b22a-482d-aa39-8339f61f8871"],
Cell[454513, 10220, 187, 3, 35, "Text",ExpressionUUID->"76881c6f-353a-463d-b4c3-548b1d356739"],
Cell[454703, 10225, 7243, 169, 19, "Input",ExpressionUUID->"beff489b-d264-4303-896c-44ee63611e2d",
 CellOpen->False]
}, Open  ]],
Cell[CellGroupData[{
Cell[461983, 10399, 623, 9, 45, "Subsubsection",ExpressionUUID->"c84d61f3-0336-4f4a-aead-1284c9de0b8a"],
Cell[462609, 10410, 178, 3, 35, "Text",ExpressionUUID->"8c160e95-a6c9-47bc-8d37-bcec4147f0c8"],
Cell[462790, 10415, 2741, 73, 283, "Input",ExpressionUUID->"46be4d26-7c89-4948-8785-d7f29a248411"]
}, Open  ]],
Cell[CellGroupData[{
Cell[465568, 10493, 813, 13, 45, "Subsubsection",ExpressionUUID->"89861cb1-5eb4-456a-99bb-0e26c6c58734"],
Cell[466384, 10508, 1331, 24, 265, "Text",ExpressionUUID->"6f9c01d6-7ecf-4845-8290-a710ab23af89"],
Cell[467718, 10534, 1788, 29, 73, "Input",ExpressionUUID->"416ec0c7-d37a-4858-aebe-1b3ae7d050a2"],
Cell[469509, 10565, 25755, 617, 19, "Input",ExpressionUUID->"77ca38db-4e59-4048-8152-967ddbf3cac4",
 CellOpen->False]
}, Open  ]],
Cell[CellGroupData[{
Cell[495301, 11187, 641, 9, 45, "Subsubsection",ExpressionUUID->"f3dd74ae-1d86-4f6e-b897-0b98b2389804"],
Cell[495945, 11198, 396, 8, 35, "Text",ExpressionUUID->"36ace7c6-6f3a-4dea-8215-2ecbe1c0f777"],
Cell[496344, 11208, 1343, 30, 73, "Input",ExpressionUUID->"695bd059-6501-45bc-acce-a8abc684e075"]
}, Open  ]],
Cell[CellGroupData[{
Cell[497724, 11243, 580, 8, 45, "Subsubsection",ExpressionUUID->"c03953ce-7560-466a-9128-a43051f24d26"],
Cell[498307, 11253, 717, 21, 35, "Text",ExpressionUUID->"fa4bf0ad-6194-436b-9772-e9a9ee6d54ca"],
Cell[499027, 11276, 227, 4, 35, "Text",ExpressionUUID->"268b2c1e-e6e1-473b-81cf-19c12849879b"],
Cell[499257, 11282, 861, 16, 30, "Input",ExpressionUUID->"2fd65a1d-6da7-4786-af2f-b4702e9cecc8"],
Cell[500121, 11300, 172, 3, 35, "Text",ExpressionUUID->"c68cf9c7-6ad5-46e1-b763-be5b1b60d07f"],
Cell[500296, 11305, 1343, 37, 73, "Input",ExpressionUUID->"8219b9df-5e5c-4c8f-8f0c-bc61937a2bb3"],
Cell[501642, 11344, 256, 6, 35, "Text",ExpressionUUID->"e0289cf3-d12c-404f-a25b-63ab4a3276f2"],
Cell[501901, 11352, 4014, 106, 346, "Input",ExpressionUUID->"345b0d9e-5741-491e-94fc-00da57615509"]
}, Open  ]],
Cell[CellGroupData[{
Cell[505952, 11463, 390, 6, 45, "Subsubsection",ExpressionUUID->"4d4e5510-1ff6-4c08-aa68-f45e84d772e8"],
Cell[506345, 11471, 67627, 1613, 19, "Input",ExpressionUUID->"e31f638d-2a49-44f9-afae-6e2bde60e047",
 CellOpen->False],
Cell[573975, 13086, 337, 8, 30, "Input",ExpressionUUID->"60c5e0c1-214d-4743-a13b-10a03680bb53"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[574361, 13100, 157, 3, 67, "Section",ExpressionUUID->"0c65e13c-68a7-4769-a07a-2ece372d26bb"],
Cell[574521, 13105, 606, 10, 81, "Text",ExpressionUUID->"2f01dfa5-6d3f-475f-8592-e308c2447f7d"],
Cell[CellGroupData[{
Cell[575152, 13119, 328, 5, 45, "Subsubsection",ExpressionUUID->"9a77bf06-7afb-476f-adeb-341a0fd5b4b5"],
Cell[575483, 13126, 2996, 48, 73, "Input",ExpressionUUID->"a0ae8d6c-7c18-4868-8df4-5db4ea265501"]
}, Open  ]],
Cell[CellGroupData[{
Cell[578516, 13179, 431, 8, 45, "Subsubsection",ExpressionUUID->"2a7e32a4-2445-4f03-b154-5dba791a4164"],
Cell[578950, 13189, 2760, 68, 304, "Input",ExpressionUUID->"95f5c769-bfb5-41da-a148-b26e45c33ee2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[581759, 13263, 158, 3, 67, "Section",ExpressionUUID->"778d5468-10d4-4354-b464-07b05a0b3704"],
Cell[CellGroupData[{
Cell[581942, 13270, 377, 6, 45, "Subsubsection",ExpressionUUID->"19749ecf-f6e0-42cc-8b75-d68f97e3f392"],
Cell[582322, 13278, 284, 6, 35, "Text",ExpressionUUID->"b9b7db25-3143-4281-8a95-103b684baa21"],
Cell[582609, 13286, 363, 8, 30, "Input",ExpressionUUID->"b19cd32a-6f67-49e1-8238-29b6db470645"],
Cell[582975, 13296, 181, 2, 30, "Input",ExpressionUUID->"575d9352-d2be-4e33-9d33-65f914f3ab37"],
Cell[583159, 13300, 337, 7, 30, "Input",ExpressionUUID->"486c88de-a59a-47b7-bd13-d072a268d5be"],
Cell[583499, 13309, 360, 8, 30, "Input",ExpressionUUID->"453e7401-bdf9-4e09-bcf5-3ab61b3bc824"],
Cell[583862, 13319, 4510, 82, 241, "Input",ExpressionUUID->"c8ecf4c5-6b4e-4de7-b108-5db31abaa2d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[588409, 13406, 411, 6, 45, "Subsubsection",ExpressionUUID->"d3a4e2aa-ed1a-4548-b455-2383a6a468f8"],
Cell[588823, 13414, 2375, 62, 199, "Input",ExpressionUUID->"786c8a03-79c9-4f4e-8b98-d072bd810fcc"],
Cell[591201, 13478, 587, 12, 30, "Input",ExpressionUUID->"d752d9c5-fc3b-4370-abaf-51649e754b63"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

