(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    302208,       6756]
NotebookOptionsPosition[    296191,       6649]
NotebookOutlinePosition[    296546,       6665]
CellTagsIndexPosition[    296503,       6662]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["eMITOMI Kinetics Analysis", "Title",
 CellChangeTimes->{{3.733169215591713*^9, 
  3.733169227491737*^9}},ExpressionUUID->"eb34816b-48f3-4f71-97ba-\
9ae535b70148"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"check", " ", "for", " ", "weird", " ", "\"\<e\>\"", " ", "in", " ", 
   RowBox[{
    RowBox[{"input", "!!"}], "!"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7335399977644873`*^9, 3.733540006717429*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"602aa742-052b-42c3-81fa-f44bf04ee6fc"],

Cell[CellGroupData[{

Cell["Analysis and plotting functions:", "Section",
 CellChangeTimes->{{3.732732210052601*^9, 
  3.732732219292498*^9}},ExpressionUUID->"af3b0309-97dd-46b1-9be6-\
5230c63f43b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"importstandardcurve", "[", "path_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dataIN", ",", "parsed", ",", "standardcurvedata"}], "}"}], ",",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataIN", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"path", ",", "\"\<Data\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "iterating", " ", "n", " ", "from", " ", "2", " ", "drops", " ", 
        RowBox[{"the", " ", ".", "csv"}], " ", "header", " ", "text"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"parsed", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dataIN", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"dataIN", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{"dataIN", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "9"}], "]"}], "]"}], ",", 
           RowBox[{"dataIN", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "13"}], "]"}], "]"}], ",", 
           RowBox[{"dataIN", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "8"}], "]"}], "]"}], ",", 
           RowBox[{"dataIN", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "6"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "2", ",", 
           RowBox[{"Length", "[", "dataIN", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"convert", " ", "[", "]"}], " ", "brackets", " ", "to", " ", 
        "curly", " ", "brackets", " ", 
        RowBox[{"{", "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"standardcurvedata", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StringDelete", "[", 
            RowBox[{
             RowBox[{"parsed", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "\"\<\\\"\>\""}], 
            "]"}], ",", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"StringReplace", "[", 
               RowBox[{
                RowBox[{"parsed", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"\"\<(\>\"", "\[Rule]", "\"\<{\>\""}]}], "]"}], ",", 
              RowBox[{"\"\<)\>\"", "\[Rule]", "\"\<}\>\""}]}], "]"}], "]"}], 
           ",", 
           RowBox[{"parsed", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{"parsed", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "4"}], "]"}], "]"}], ",", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"Riffle", "[", 
              RowBox[{
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{"StringReplace", "[", 
                   RowBox[{
                    RowBox[{"parsed", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "5"}], "]"}], "]"}], ",", 
                    RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<{\>\""}]}], "]"}], 
                  ",", 
                  RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<}\>\""}]}], "]"}], 
                "]"}], ",", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{"StringReplace", "[", 
                   RowBox[{
                    RowBox[{"parsed", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "6"}], "]"}], "]"}], ",", 
                    RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<{\>\""}]}], "]"}], 
                  ",", 
                  RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<}\>\""}]}], "]"}], 
                "]"}]}], "]"}], ",", "2"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"Length", "[", "parsed", "]"}]}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"replaceBrackets", "[", "stringList_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"test1", ",", "stringReplaced"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"stringReplaced", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringQ", "[", "stringList", "]"}], "\[Equal]", "True"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"stringList", ",", "\"\<[\>\""}], "]"}], "\[Equal]", 
            "True"}], "||", 
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"stringList", ",", "\"\<(\>\""}], "]"}], "\[Equal]", 
            "True"}]}], ")"}]}], ",", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"stringList", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
             RowBox[{"\"\<(\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
             RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<}\>\""}], ",", 
             RowBox[{"\"\<)\>\"", "\[Rule]", "\"\<}\>\""}]}], "}"}]}], "]"}], 
         "]"}], ",", "stringList"}], "]"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeProgressCurvePlotRFU", "[", 
    RowBox[{
    "timeData_", ",", "medianIntensityData_", ",", "rate_", ",", "intercept_",
      ",", "pointsUsed_", ",", "standardCurveSlope_", ",", 
     "standardCurveIntercept_", ",", "substrateConc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "data", ",", "noPointsFit", ",", "xmin", ",", "ymin", ",", "padding", 
       ",", "xscale", ",", "yscale"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Riffle", "[", 
          RowBox[{"timeData", ",", "medianIntensityData"}], "]"}], ",", "2"}],
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"noPointsFit", "=", 
       RowBox[{"Length", "[", "pointsUsed", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "set", " ", "plotting", " ", "and", " ", "padding", " ", "values"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"xmin", "=", 
       RowBox[{
        RowBox[{"Last", "[", "data", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ymin", "=", 
       RowBox[{
        RowBox[{"Last", "[", "data", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"padding", "=", "50"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xscale", "=", "1.1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"yscale", "=", "1.4"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Overlay", "[", 
       RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{"data", ",", 
           RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "200"}], ",", 
                RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
              RowBox[{"PointSize", "[", "0.015", "]"}]}], "]"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"False", ",", "True", ",", "True", ",", "False"}], 
             "}"}]}], ",", 
           RowBox[{"FrameStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "Black", ",", "Black", ",", "Black"}], 
             "}"}]}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", "All"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Time (s)\>\"", ",", "\"\<RFU\>\"", ",", "\"\<Time (s)\>\"", 
              ",", "\"\<RFU\>\""}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"None", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"standardCurveSlope", "*", "substrateConc"}], "+", 
                 "standardCurveIntercept"}], ",", "standardCurveIntercept"}], 
               "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Darker", "[", "Red", "]"}], ",", "Dashed"}], "]"}]}], 
           ",", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{"\"\<[S]=\>\"", ",", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"Round", "[", "substrateConc", "]"}], "]"}], ",", 
                  "\"\<uM\>\""}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xmin", "/", "1.25"}], ",", 
                 RowBox[{"ymin", "*", 
                  RowBox[{"yscale", "/", "4"}]}]}], "}"}]}], "]"}], "}"}]}]}],
           "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rate", "*", "time"}], "+", "intercept"}], ",", 
           RowBox[{"{", 
            RowBox[{"time", ",", 
             RowBox[{"-", "200"}], ",", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
              "150."}]}], "}"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
             "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "200"}], ",", 
                RowBox[{
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
                 "150."}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Dashed", ",", 
              RowBox[{"Darker", "[", 
               RowBox[{"Hue", "[", 
                RowBox[{"1", "*", "0.1"}], "]"}], "]"}]}], "]"}]}]}], "]"}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rate", "*", "time"}], "+", "intercept"}], ",", 
           RowBox[{"{", 
            RowBox[{"time", ",", 
             RowBox[{"-", "200"}], ",", 
             RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
             "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "200"}], ",", 
                RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Dashed", ",", 
              RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}]}]}], "]"}], ",",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "noPointsFit"}], "]"}], "]"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "200"}], ",", 
                RowBox[{
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
                 "150."}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False", ",", "False", ",", "True"}], 
             "}"}]}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", "All"}], ",", 
           RowBox[{"FrameStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "[", 
               RowBox[{
                RowBox[{"ColorData", "[", 
                 RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], ",", "Black", 
              ",", "Black", ",", 
              RowBox[{"Darker", "[", 
               RowBox[{
                RowBox[{"ColorData", "[", 
                 RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", 
           RowBox[{"AxesOrigin", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"AxesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Darker", "[", 
              RowBox[{
               RowBox[{"ColorData", "[", 
                RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Darker", "[", 
               RowBox[{
                RowBox[{"ColorData", "[", 
                 RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"PointSize", "[", "0.03", "]"}], ",", 
              RowBox[{"Opacity", "[", "0.8", "]"}]}], "]"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Time (s)\>\"", ",", "\"\<RFU\>\"", ",", "\"\<Time (s)\>\"", 
              ",", "\"\<RFU\>\""}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"None", ",", 
              RowBox[{"{", "65535.", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", "Dashed"}], 
             "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]",
         "}"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeProgressCurvePlot", "[", 
    RowBox[{
    "timeData_", ",", "progressCurve_", ",", "rate_", ",", "intercept_", ",", 
     "pointsUsed_", ",", "substrateConc_", ",", "expFitModel_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "data", ",", "noPointsFit", ",", "xmin", ",", "ymin", ",", "padding", 
       ",", "xscale", ",", "yscale", ",", "firstPointY"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Riffle", "[", 
          RowBox[{"timeData", ",", "progressCurve"}], "]"}], ",", "2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"noPointsFit", "=", 
       RowBox[{"Length", "[", "pointsUsed", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "set", " ", "plotting", " ", "and", " ", "padding", " ", "values"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"xmin", "=", 
       RowBox[{
        RowBox[{"Last", "[", "data", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ymin", "=", 
       RowBox[{
        RowBox[{"Last", "[", "data", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"padding", "=", "50"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xscale", "=", "1.1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"yscale", "=", "1.4"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"firstPointY", "=", 
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "0.5"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Overlay", "[", 
       RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{"data", ",", 
           RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "200"}], ",", 
                RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"firstPointY", ",", 
                RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
              RowBox[{"PointSize", "[", "0.015", "]"}]}], "]"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"False", ",", "True", ",", "True", ",", "False"}], 
             "}"}]}], ",", 
           RowBox[{"FrameStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "Black", ",", "Black", ",", "Black"}], 
             "}"}]}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", "All"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Time (s)\>\"", ",", "\"\<Product (uM)\>\"", ",", 
              "\"\<Time (s)\>\"", ",", "\"\<Product (uM)\>\""}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"None", ",", 
              RowBox[{"{", "substrateConc", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Darker", "[", "Red", "]"}], ",", "Dashed"}], "]"}]}], 
           ",", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{"\"\<[S]=\>\"", ",", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"Round", "[", "substrateConc", "]"}], "]"}], ",", 
                  "\"\<uM\>\""}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xmin", "/", "1.25"}], ",", 
                 RowBox[{"ymin", "*", 
                  RowBox[{"yscale", "/", "4"}]}]}], "}"}]}], "]"}], "}"}]}]}],
           "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rate", "*", "time"}], "+", "intercept"}], ",", 
           RowBox[{"{", 
            RowBox[{"time", ",", 
             RowBox[{"-", "200"}], ",", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
              "150."}]}], "}"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
             "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "200"}], ",", 
                RowBox[{
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
                 "150."}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"firstPointY", ",", 
                RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Dashed", ",", 
              RowBox[{"Darker", "[", 
               RowBox[{"Hue", "[", 
                RowBox[{"1", "*", "0.1"}], "]"}], "]"}]}], "]"}]}]}], "]"}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rate", "*", "time"}], "+", "intercept"}], ",", 
           RowBox[{"{", 
            RowBox[{"time", ",", 
             RowBox[{"-", "200"}], ",", 
             RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
             "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "200"}], ",", 
                RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"firstPointY", ",", 
                RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Dashed", ",", 
              RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}]}]}], "]"}], ",",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "expFitModel", "]"}], "\[Equal]", "4"}], 
           ",", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"expFitModel", "[", "time", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{"-", "200"}], ",", 
               RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
             RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
             RowBox[{"Frame", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
               "}"}]}], ",", 
             RowBox[{"Axes", "\[Rule]", "False"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "200"}], ",", 
                  RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"firstPointY", ",", 
                  RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Dashed", ",", 
                RowBox[{"Darker", "[", 
                 RowBox[{"Hue", "[", 
                  RowBox[{"1", "*", "0.1"}], "]"}], "]"}]}], "]"}]}]}], "]"}],
            ",", "\"\<\>\""}], "]"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "noPointsFit"}], "]"}], "]"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "200"}], ",", 
                RowBox[{
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
                 "150."}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"firstPointY", ",", 
                RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False", ",", "False", ",", "True"}], 
             "}"}]}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", "All"}], ",", 
           RowBox[{"FrameStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "[", 
               RowBox[{
                RowBox[{"ColorData", "[", 
                 RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], ",", "Black", 
              ",", "Black", ",", 
              RowBox[{"Darker", "[", 
               RowBox[{
                RowBox[{"ColorData", "[", 
                 RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", 
           RowBox[{"AxesOrigin", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"AxesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Darker", "[", 
              RowBox[{
               RowBox[{"ColorData", "[", 
                RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Darker", "[", 
               RowBox[{
                RowBox[{"ColorData", "[", 
                 RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"PointSize", "[", "0.03", "]"}], ",", 
              RowBox[{"Opacity", "[", "0.8", "]"}]}], "]"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Time (s)\>\"", ",", "\"\<RFU\>\"", ",", "\"\<Time (s)\>\"", 
              ",", "\"\<RFU\>\""}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"None", ",", 
              RowBox[{"{", "65535.", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", "Dashed"}], 
             "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]",
         "}"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeProgressCurvePlotPBP", "[", 
    RowBox[{
    "timeData_", ",", "turnoverData_", ",", "rate_", ",", "intercept_", ",", 
     "pointsUsed_", ",", "substrateConc_", ",", "PBPconc_", ",", "coplotExp_",
      ",", "expFitModel_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "data", ",", "noPointsFit", ",", "xmin", ",", "ymin", ",", "padding", 
       ",", "xscale", ",", "yscale", ",", "kobstest"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Riffle", "[", 
          RowBox[{"timeData", ",", "turnoverData"}], "]"}], ",", "2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"noPointsFit", "=", 
       RowBox[{"Length", "[", "pointsUsed", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "set", " ", "plotting", " ", "and", " ", "padding", " ", "values"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"xmin", "=", 
       RowBox[{
        RowBox[{"Last", "[", "data", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ymin", "=", 
         RowBox[{
          RowBox[{"Last", "[", "data", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ymin", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Sort", "[", 
             RowBox[{"data", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ">", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", "60.0"}], ",", 
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"Sort", "[", 
            RowBox[{"data", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ">", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "]"}], "[", 
          
          RowBox[{"[", "2", "]"}], "]"}], ",", "60.0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"padding", "=", "50"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xscale", "=", "1.1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"yscale", "=", "1.4"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"kobstest", "=", 
         RowBox[{"kobs", "/.", 
          RowBox[{"expFitModel", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "kobstest", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"noPointsFit", "\[GreaterEqual]", "1"}], ",", 
        RowBox[{"Overlay", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{"data", ",", 
             RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "200"}], ",", 
                  RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
                RowBox[{"PointSize", "[", "0.015", "]"}]}], "]"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"False", ",", "True", ",", "True", ",", "False"}], 
               "}"}]}], ",", 
             RowBox[{"FrameStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Black", ",", "Black", ",", "Black", ",", "Black"}], 
               "}"}]}], ",", 
             RowBox[{"FrameTicks", "\[Rule]", "All"}], ",", 
             RowBox[{"Axes", "\[Rule]", "False"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Time (s)\>\"", ",", "\"\<[Pi]\>\"", ",", 
                "\"\<Time (s)\>\"", ",", "\"\<[Pi]\>\""}], "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
             RowBox[{"GridLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"None", ",", 
                RowBox[{"{", 
                 RowBox[{"substrateConc", ",", "PBPconc"}], "}"}]}], "}"}]}], 
             ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Darker", "[", "Red", "]"}], ",", "Dashed"}], "]"}]}],
              ",", 
             RowBox[{"Epilog", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Inset", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"StringJoin", "[", 
                   RowBox[{"\"\<[S]=\>\"", ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"Round", "[", "substrateConc", "]"}], "]"}], ",", 
                    "\"\<uM\>\""}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xmin", "/", "1.25"}], ",", 
                   RowBox[{"ymin", "*", 
                    RowBox[{"yscale", "/", "4"}]}]}], "}"}]}], "]"}], 
               "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "*", "time"}], "+", "intercept"}], ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{"-", "200"}], ",", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
                "150."}]}], "}"}], ",", 
             RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
             RowBox[{"Frame", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
               "}"}]}], ",", 
             RowBox[{"Axes", "\[Rule]", "False"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "200"}], ",", 
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
                   "150."}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Dashed", ",", 
                RowBox[{"Darker", "[", 
                 RowBox[{"Hue", "[", 
                  RowBox[{"1", "*", "0.1"}], "]"}], "]"}]}], "]"}]}]}], "]"}],
            ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "*", "time"}], "+", "intercept"}], ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{"-", "200"}], ",", 
               RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
             RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
             RowBox[{"Frame", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
               "}"}]}], ",", 
             RowBox[{"Axes", "\[Rule]", "False"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "200"}], ",", 
                  RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Dashed", ",", 
                RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}]}]}], "]"}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "expFitModel", "]"}], "\[Equal]", "4"}], 
             ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"expFitModel", "[", "time", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"time", ",", 
                 RowBox[{"-", "200"}], ",", 
                 RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
               RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
               RowBox[{"Frame", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
                 "}"}]}], ",", 
               RowBox[{"Axes", "\[Rule]", "False"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "200"}], ",", 
                    RowBox[{"xmin", "*", "xscale"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
               
               RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Dashed", ",", 
                  RowBox[{"Darker", "[", 
                   RowBox[{"Hue", "[", 
                    RowBox[{"1", "*", "0.1"}], "]"}], "]"}]}], "]"}]}]}], 
              "]"}], ",", "\"\<\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "noPointsFit"}], "]"}], "]"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "200"}], ",", 
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"noPointsFit", ",", "1"}], "]"}], "]"}], "+", 
                   "150."}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"ymin", "*", "yscale"}]}], "}"}]}], "}"}]}], ",", 
             RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
             RowBox[{"Frame", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False", ",", "False", ",", "True"}], 
               "}"}]}], ",", 
             RowBox[{"FrameTicks", "\[Rule]", "All"}], ",", 
             RowBox[{"FrameStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Darker", "[", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], ",", "Black",
                 ",", "Black", ",", 
                RowBox[{"Darker", "[", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
             ",", 
             RowBox[{"Axes", "\[Rule]", "True"}], ",", 
             RowBox[{"AxesOrigin", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"AxesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Darker", "[", 
                RowBox[{
                 RowBox[{"ColorData", "[", 
                  RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
             
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Darker", "[", 
                 RowBox[{
                  RowBox[{"ColorData", "[", 
                   RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"PointSize", "[", "0.03", "]"}], ",", 
                RowBox[{"Opacity", "[", "0.8", "]"}]}], "]"}]}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Time (s)\>\"", ",", "\"\<[Pi]\>\"", ",", 
                "\"\<Time (s)\>\"", ",", "\"\<[Pi]\>\""}], "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
             RowBox[{"GridLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"None", ",", 
                RowBox[{"{", "65535.", "}"}]}], "}"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", "Dashed"}], 
               "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "}"}], "]"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isotherm", "[", 
    RowBox[{"kd_", ",", "ptot_", ",", "scale_", ",", "offset_", ",", "x_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.5", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kd", "+", "x", "+", "ptot"}], ")"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"kd", "+", "x", "+", "ptot"}], ")"}], "^", "2"}], "-", 
            RowBox[{"(", 
             RowBox[{"4", "*", "x", "*", "ptot"}], ")"}]}], ")"}], "^", 
          "0.5"}]}], ")"}]}], ")"}], "*", "scale"}], "+", "offset"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inverseIsotherm", "[", 
    RowBox[{
    "kd_", ",", "ptot_", ",", "scale_", ",", "offset_", ",", "intensity_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1.`", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1.`", " ", 
         SuperscriptBox["intensity", "2"]}], "-", 
        RowBox[{"2.`", " ", "intensity", " ", "offset"}], "+", 
        RowBox[{"1.`", " ", 
         SuperscriptBox["offset", "2"]}], "-", 
        RowBox[{"1.`", " ", "intensity", " ", "kd", " ", "scale"}], "+", 
        RowBox[{"1.`", " ", "kd", " ", "offset", " ", "scale"}], "-", 
        RowBox[{"1.`", " ", "intensity", " ", "ptot", " ", "scale"}], "+", 
        RowBox[{"1.`", " ", "offset", " ", "ptot", " ", "scale"}]}], ")"}]}], 
     ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"scale", " ", 
      RowBox[{"(", 
       RowBox[{"intensity", "-", 
        RowBox[{"1.`", " ", "offset"}], "-", 
        RowBox[{"1.`", " ", "ptot", " ", "scale"}]}], ")"}]}], ")"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regenerateProgressCurve", "[", 
    RowBox[{
    "timeData_", ",", "medianIntensityData_", ",", "standardCurveParams_", 
     ",", "sensorConc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Riffle", "[", 
          RowBox[{"timeData", ",", "medianIntensityData"}], "]"}], ",", "2"}],
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"inverseIsotherm", "[", 
           RowBox[{
            RowBox[{
            "standardCurveParams", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "standardCurveParams", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "standardCurveParams", "\[LeftDoubleBracket]", "3", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "standardCurveParams", "\[LeftDoubleBracket]", "4", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "2"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makePBPcurvePlot", "[", 
    RowBox[{"standardCurveParams_", ",", "standardCurveData_"}], "]"}], ":=", 
   
   RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{"standardCurveData", ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<[\!\(\*SubscriptBox[\(P\), \(i\)]\)] (uM)\>\"", ",", 
          "\"\<PBP Intensity\>\""}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"50", ",", "50"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"50", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Darker", "[", "Cyan", "]"}], ",", 
          RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"isotherm", "[", 
        RowBox[{
         RowBox[{"standardCurveParams", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"standardCurveParams", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"standardCurveParams", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"standardCurveParams", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", "Pi"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"Pi", ",", "0", ",", "160"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "All"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Darker", "[", "Cyan", "]"}], "]"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", "Black"}]}], "]"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linearFitWalkingProgressCurve", "[", 
    RowBox[{"timeData_", ",", "progressCurve_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"data", ",", "linFits"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"n", ".", "b", ".", " ", "had"}], " ", "to", " ", "add", " ", 
        "Select", " ", "because", " ", "1", " ", "point", " ", "is", " ", 
        "expressed", " ", "in", " ", "scientific", " ", "notation", " ", "in",
         " ", "input", " ", "csv"}], ",", " ", 
       RowBox[{"and", " ", 
        RowBox[{"doesn", "'"}], "t", " ", "parse", " ", "properly"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Riffle", "[", 
            RowBox[{"timeData", ",", "progressCurve"}], "]"}], ",", "2"}], 
          "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Equal]", "Real"}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"linFits", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"LinearModelFit", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "n"}], "]"}], "]"}], ",", "x", ",", "x"}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "2", ",", 
           RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"linFits", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"linFits", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "2", ",", "1", ",", "2", ",", "2"}], "]"}], 
           "]"}], ",", 
          RowBox[{"linFits", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "2", ",", "1", ",", "2", ",", "1"}], "]"}], 
           "]"}], ",", 
          RowBox[{"linFits", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "linFits", "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"optimizeLinFit", "[", 
    RowBox[{
    "timeData_", ",", "progressCurve_", ",", "substrateConc_", ",", 
     "stdCurveSlope_", ",", "stdCurveIntercept_", ",", "cutoff_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "data", ",", "cutoffNew", ",", "dataForFit", ",", "sensorSat", ",", 
       "dataForFitTemp", ",", "fit"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "fit", " ", "all", " ", "points", " ", "under", " ", "30", "%", " ", 
        "of", " ", "total", " ", "expected", " ", "turnover"}], ",", " ", 
       RowBox[{
        RowBox[{"unless", " ", "this", " ", "leaves"}], " ", "<", " ", 
        RowBox[{
         RowBox[{
         "2", " ", "points", " ", "in", " ", "which", " ", "default", " ", 
          "to", " ", "a", " ", "2"}], "-", 
         RowBox[{"point", " ", "fit"}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Riffle", "[", 
          RowBox[{"timeData", ",", "progressCurve"}], "]"}], ",", "2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sensorSat", "=", 
       RowBox[{"65536.0", "*", "0.9"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"cutoffNew", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"substrateConc", "*", "stdCurveSlope"}], "+", 
            "stdCurveIntercept"}], ")"}], "<", "sensorSat"}], ",", 
         RowBox[{"cutoff", "*", "substrateConc"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"substrateConc", "*", "stdCurveSlope"}], "+", 
             "stdCurveIntercept"}], ")"}], "\[GreaterEqual]", "sensorSat"}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"substrateConc", "*", "cutoff", "*", "stdCurveSlope"}], 
             "+", "stdCurveIntercept"}], ")"}], "<", "sensorSat"}]}], ",", 
         RowBox[{"cutoff", "*", "substrateConc"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"substrateConc", "*", "stdCurveSlope"}], "+", 
             "stdCurveIntercept"}], ")"}], "\[GreaterEqual]", "sensorSat"}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"substrateConc", "*", "cutoff", "*", "stdCurveSlope"}], 
             "+", "stdCurveIntercept"}], ")"}], "\[GreaterEqual]", 
           "sensorSat"}]}], ",", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"sensorSat", "-", "stdCurveIntercept"}], "stdCurveSlope"], 
          ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dataForFitTemp", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"data", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "<", "cutoffNew"}], "&"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dataForFit", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dataForFitTemp", "]"}], "<", "2"}], ",", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", "dataForFitTemp"}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitOptimized", "[", "dataIN_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"data", ",", "linFit", ",", "params"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "works", " ", "for", " ", "both", " ", "cMUP", " ", "and", " ", "MeP", 
       " ", "assays"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Normal", "[", "dataIN", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"linFit", "=", 
       RowBox[{
        RowBox[{"LinearModelFit", "[", 
         RowBox[{"data", ",", "x", ",", "x"}], "]"}], "//", "Quiet"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"params", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "data", "]"}], "<", "2"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", 
           "\"\<NaN\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"linFit", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"linFit", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], ",", "linFit", 
           ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "data", "]"}], ">", "2"}], ",", 
             RowBox[{"linFit", "[", "\"\<RSquared\>\"", "]"}], ",", "1.0"}], 
            "]"}], ",", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<OptLinFitSlope\>\"", "\[Rule]", 
         RowBox[{"params", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"\"\<OptLinFitIntercept\>\"", "->", 
         RowBox[{"params", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"\"\<OptLinFitModel\>\"", "->", 
         RowBox[{"params", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", 
        RowBox[{"\"\<OptLinFitR2\>\"", "->", 
         RowBox[{"params", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"optimizeLinFitPBP", "[", 
    RowBox[{
    "timeData_", ",", "progressCurve_", ",", "substrateConc_", ",", 
     "sensorConc_", ",", "cutoff_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "data", ",", "cutoffNew", ",", "dataForFitTemp", ",", "dataForFit"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Riffle", "[", 
          RowBox[{"timeData", ",", "progressCurve"}], "]"}], ",", "2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"for", " ", "the", " ", "PBP", " ", "coupled", " ", "assay"}],
         ",", " ", 
        RowBox[{
         RowBox[{
         "the", " ", "fitting", " ", "strategy", " ", "will", " ", "depend", 
          " ", "on", " ", "the", " ", "relative", " ", "concentrations", " ", 
          "of", " ", "substrate", " ", "and", " ", "PBP"}], " ", "\[Rule]", 
         " ", 
         RowBox[{
          RowBox[{"if", " ", "[", "S", "]"}], "<", 
          RowBox[{
           RowBox[{"[", "PBP", "]"}], " ", "use", " ", "cutoff", "*", 
           RowBox[{"[", "S", "]"}], " ", "as", " ", "cutoff"}]}]}], ",", " ", 
        
        RowBox[{"else", " ", "use", " ", "cutoff", "*", 
         RowBox[{"[", "PBP", "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"cutoffNew", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"substrateConc", "<", "sensorConc"}], ",", 
         RowBox[{"cutoff", "*", "substrateConc"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"cutoff", "*", "substrateConc"}], ")"}], ">", 
          RowBox[{"sensorConc", "*", 
           RowBox[{"2", "/", "3"}]}]}], ",", 
         RowBox[{"sensorConc", "*", 
          RowBox[{"2", "/", "3"}]}], ",", 
         RowBox[{
          RowBox[{"substrateConc", ">", "sensorConc"}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"cutoff", "*", "substrateConc"}], ")"}], "<", 
           RowBox[{"sensorConc", "*", 
            RowBox[{"2", "/", "3"}]}]}]}], ",", 
         RowBox[{"cutoff", "*", "substrateConc"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dataForFitTemp", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"data", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "<", "cutoffNew"}], "&"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dataForFit", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dataForFitTemp", "]"}], "<", "2"}], ",", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", "dataForFitTemp"}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitOptimizedLinFitPointsPBP", "[", "dataIN_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"linFit", ",", "data"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Normal", "[", "dataIN", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"linFit", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "data", "]"}], "\[GreaterEqual]", "2"}], ",", 
         RowBox[{"LinearModelFit", "[", 
          RowBox[{"data", ",", "x", ",", "x"}], "]"}], ",", "\"\<NaN\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "data", "]"}], "<", "2"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", 
          "\"\<NaN\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"linFit", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"linFit", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "data", "]"}], ">", "2"}], ",", 
            RowBox[{"linFit", "[", "\"\<RSquared\>\"", "]"}], ",", "1.0"}], 
           "]"}], ",", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exponentialFit", "[", 
    RowBox[{
    "timeData_", ",", "progressCurve_", ",", "substrateConc_", ",", 
     "stdCurveSlope_", ",", "stdCurveIntercept_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "forFit", ",", "expFit", ",", "kobsout", ",", "bout", ",", "cout", ",", 
       "forFitOnlyGoodPoints", ",", "out"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"forFit", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Riffle", "[", 
            RowBox[{"timeData", ",", "progressCurve"}], "]"}], ",", "2"}], 
          "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Equal]", "Real"}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"stdCurveSlope", "*", "substrateConc"}], "+", 
            "stdCurveIntercept"}], ")"}], "\[LessEqual]", 
          RowBox[{"65536.0", "*", "0.9"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"expFit", "=", 
           RowBox[{"NonlinearModelFit", "[", 
            RowBox[{"forFit", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "kobs"}], "*", "t"}], "]"}]}], ")"}], "*", 
                 "b"}], "+", "c"}], ",", 
               RowBox[{
                RowBox[{"b", ">", "0"}], "&&", 
                RowBox[{"kobs", "<", "0.02"}], "&&", 
                RowBox[{"b", "<", 
                 RowBox[{"substrateConc", "*", "1.25"}]}], "&&", 
                RowBox[{"c", ">", 
                 RowBox[{"-", "4"}]}], "&&", 
                RowBox[{"c", "<", "5"}], "&&", 
                RowBox[{"kobs", ">", "0"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"kobs", ",", "b", ",", "c"}], "}"}], ",", "t"}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"kobsout", "=", 
           RowBox[{"kobs", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bout", "=", 
           RowBox[{"b", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cout", "=", 
           RowBox[{"c", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"kobsout", ",", "bout", ",", "cout", ",", 
            RowBox[{"expFit", "[", "\"\<RSquared\>\"", "]"}], ",", "expFit"}],
            "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"forFitOnlyGoodPoints", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"forFit", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "<", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"65536.0", "-", "stdCurveIntercept"}], ")"}], "/", 
                  "stdCurveSlope"}], ")"}], "*", "0.9"}]}], "&"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"expFit", "=", 
           RowBox[{"NonlinearModelFit", "[", 
            RowBox[{"forFitOnlyGoodPoints", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "kobs"}], "*", "t"}], "]"}]}], ")"}], "*", 
                 "substrateConc"}], "+", "c"}], ",", 
               RowBox[{
                RowBox[{"kobs", "<", "0.2"}], "&&", 
                RowBox[{"c", ">", 
                 RowBox[{"-", "2"}]}], "&&", 
                RowBox[{"c", "<", "5"}], "&&", 
                RowBox[{"kobs", ">", "0"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"kobs", ",", "c"}], "}"}], ",", "t"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"kobsout", "=", 
           RowBox[{"kobs", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bout", "=", "substrateConc"}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"cout", "=", 
           RowBox[{"c", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"expFit", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", "3"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"kobsout", ",", "bout", ",", "cout", ",", 
              RowBox[{"expFit", "[", "\"\<RSquared\>\"", "]"}], ",", 
              "expFit"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", 
              "\"\<NaN\>\"", ",", "\"\<NaN\>\""}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "out"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exponentialFitPBP", "[", 
    RowBox[{
    "timeData_", ",", "progressCurve_", ",", "substrateConc_", ",", 
     "PBPconc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "forFit", ",", "expFit", ",", "kobsout", ",", "bout", ",", "cout", ",", 
       "forFitOnlyGoodPoints", ",", "out"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"forFit", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Riffle", "[", 
            RowBox[{"timeData", ",", "progressCurve"}], "]"}], ",", "2"}], 
          "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"NumberQ", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Equal]", "True"}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"substrateConc", "\[LessEqual]", "PBPconc"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"expFit", "=", 
           RowBox[{"NonlinearModelFit", "[", 
            RowBox[{"forFit", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "kobs"}], "*", "t"}], "]"}]}], ")"}], "*", 
                 "b"}], "+", "c"}], ",", 
               RowBox[{
                RowBox[{"b", ">", 
                 RowBox[{"substrateConc", "*", "0.8"}]}], "&&", 
                RowBox[{"b", "<", 
                 RowBox[{"substrateConc", "*", "1.2"}]}], "&&", 
                RowBox[{"kobs", "<", "0.02"}], "&&", 
                RowBox[{"c", ">", 
                 RowBox[{"-", "4"}]}], "&&", 
                RowBox[{"c", "<", "3"}], "&&", 
                RowBox[{"kobs", ">", "0"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"kobs", ",", "b", ",", "c"}], "}"}], ",", "t"}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"kobsout", "=", 
           RowBox[{"kobs", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bout", "=", 
           RowBox[{"b", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cout", "=", 
           RowBox[{"c", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"kobsout", ",", "bout", ",", "cout", ",", 
            RowBox[{"expFit", "[", "\"\<RSquared\>\"", "]"}], ",", "expFit"}],
            "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"forFitOnlyGoodPoints", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"forFit", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "<", 
                RowBox[{"PBPconc", "*", "0.85"}]}], "&&", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ">", "0"}]}], "&"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"expFit", "=", 
           RowBox[{"NonlinearModelFit", "[", 
            RowBox[{"forFitOnlyGoodPoints", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "kobs"}], "*", "t"}], "]"}]}], ")"}], "*", 
                 "substrateConc"}], "+", "c"}], ",", 
               RowBox[{
                RowBox[{"kobs", "<", "0.02"}], "&&", 
                RowBox[{"c", ">", 
                 RowBox[{"-", "4"}]}], "&&", 
                RowBox[{"c", "<", "3"}], "&&", 
                RowBox[{"kobs", ">", "0"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"kobs", ",", "c"}], "}"}], ",", "t"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"kobsout", "=", 
           RowBox[{"kobs", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bout", "=", "substrateConc"}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"cout", "=", 
           RowBox[{"c", "/.", 
            RowBox[{"expFit", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"expFit", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", "3"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"kobsout", ",", "bout", ",", "cout", ",", 
              RowBox[{"expFit", "[", "\"\<RSquared\>\"", "]"}], ",", 
              "expFit"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", 
              "\"\<NaN\>\"", ",", "\"\<NaN\>\""}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "out"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeStdCurvePlot", "[", 
    RowBox[{"slope_", ",", "intercept_", ",", "data_"}], "]"}], ":=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{"data", ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<[cMU] (uM)\>\"", ",", "\"\<cMU Intensity\>\""}], 
         "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Darker", "[", "Cyan", "]"}], ",", 
          RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"slope", "*", "cMU"}], "+", "intercept"}], ",", 
       RowBox[{"{", 
        RowBox[{"cMU", ",", "0", ",", "105"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Darker", "[", "Cyan", "]"}], "]"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", "Black"}]}], "]"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "need", " ", "to", " ", "add", " ", "inhibitor", " ", "concentration", " ",
     "column", " ", "to", " ", "the", " ", "dataset"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitInhibition", "[", 
    RowBox[{"dataset_", ",", "rateKey_", ",", "keyAppend_", ",", 
     RowBox[{"scaleByGFP_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "removeControl", ",", "grouped", ",", "fitdata", ",", "fits", ",", 
       "rates", ",", "data", ",", "data2", ",", "dataMax", ",", "dataNorm", 
       ",", "droppedfits", ",", "Vmaxout", ",", "KIout", ",", 
       "dropoutFitPlot", ",", "slopeout", ",", "interceptout", ",", 
       "dropoutLinearFitPlot", ",", "MMfitplot", ",", "fullLinearFitPlot", 
       ",", "eGFPscalingList", ",", "data2a", ",", "data2b", ",", 
       "eGFPscaleAppend", ",", "eGFPscaleUnits", ",", 
       "inhibitorConcentrations", ",", "onlyControl", ",", "groupedControl", 
       ",", "controlData", ",", "inhibitorConcentrationsControl", ",", 
       "eGFPscalingListControl", ",", "controlPlotTEMP", ",", "controlPlot"}],
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"reads", " ", "in", " ", "Dataset"}], ",", " ", 
       RowBox[{
        RowBox[{"fits", " ", "chosen", " ", "rates", " ", 
         RowBox[{"(", 
          RowBox[{"determined", " ", "by", " ", "key"}], ")"}], " ", "to", 
         " ", "linear", " ", "and", " ", "Michaelis"}], "-", 
        RowBox[{"Menten", " ", "models"}]}], ",", " ", 
       RowBox[{
       "returning", " ", "a", " ", "list", " ", "of", " ", "associations"}], 
       ",", " ", 
       RowBox[{
       "and", " ", "merging", " ", "fit", " ", "data", " ", "with", " ", 
        "input", " ", "data", " ", "to", " ", "create", " ", "a", " ", "new", 
        " ", "aggregate", " ", "dataset"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"removeControl", "=", 
       RowBox[{"dataset", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"#AssayType", "\[Equal]", "1"}], "&"}], "]"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"grouped", "=", 
       RowBox[{"removeControl", "[", 
        RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"onlyControl", "=", 
       RowBox[{"dataset", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"#AssayType", "\[Equal]", "0"}], "&"}], "]"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"groupedControl", "=", 
       RowBox[{"onlyControl", "[", 
        RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fitdata", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Clear", "[", 
            RowBox[{
            "fits", ",", "data", ",", "data2", ",", "dataNorm", ",", "rates", 
             ",", "inhibitorConcentrations", ",", "eGFPscalingList"}], "]"}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"inhibitorConcentrations", "=", 
            RowBox[{"Normal", "[", 
             RowBox[{"grouped", "[", 
              RowBox[{
              "n", ",", "All", ",", "\"\<InhibitorConcentration\>\""}], "]"}],
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"eGFPscalingList", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Normal", "[", 
                 RowBox[{"grouped", "[", 
                  RowBox[{"n", ",", "All", ",", "\"\<eGFPSummedI\>\""}], 
                  "]"}], "]"}], "/", "eGFPslope"}], "/", "1000."}], ",", 
              RowBox[{"scaleByGFP", "\[Equal]", "0"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{"1", ",", 
                RowBox[{"{", 
                 RowBox[{"Length", "[", "inhibitorConcentrations", "]"}], 
                 "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"rates", "=", 
            RowBox[{"Normal", "[", 
             RowBox[{"grouped", "[", 
              RowBox[{"n", ",", "All", ",", "rateKey"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"data", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"inhibitorConcentrations", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"rates", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"eGFPscalingList", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"Length", "[", "inhibitorConcentrations", "]"}]}], 
               "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"data2a", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"data", ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", 
                 "\"\<NaN\>\""}], "&&", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], "&&", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ">", "0"}]}], "&"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"data2b", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"data2a", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"data2a", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "2"}], "]"}], "]"}], "/", 
                 RowBox[{"data2a", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"Length", "[", "data2a", "]"}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"dataMax", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"data2b", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"data2", "=", "data2b"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"dataNorm", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"data2", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"data2", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "2"}], "]"}], "]"}], "/", "dataMax"}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"Length", "[", "data2", "]"}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"fits", "=", 
            RowBox[{"NonlinearModelFit", "[", 
             RowBox[{"dataNorm", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Vmax", "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"inhibitor", "/", "Ki"}]}], ")"}]}], ",", 
                RowBox[{
                 RowBox[{"Ki", ">", "0.0"}], "&&", 
                 RowBox[{"Vmax", ">", "0.75"}], "&&", 
                 RowBox[{"Vmax", "<", "1.5"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Ki", ",", "Vmax"}], "}"}], ",", "inhibitor"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "drop", " ", "individual", " ", "points", " ", "and", " ", 
             "refit"}], " ", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"droppedfits", "=", 
            RowBox[{
            "Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"dataNorm", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"NonlinearModelFit", "[", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{"dataNorm", ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Vmax", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"inhibitor", "/", "Ki"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"Ki", ">", "0.0"}], "&&", 
                    RowBox[{"Vmax", ">", "0.75"}], "&&", 
                    RowBox[{"Vmax", "<", "1.5"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Ki", ",", "Vmax"}], "}"}], ",", "inhibitor"}], 
                 "]"}]}], "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
               ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"Length", "[", "dataNorm", "]"}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"extract", " ", "parameters"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Vmaxout", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Vmax", "/.", 
               RowBox[{"droppedfits", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2", ",", "1", ",", "2"}], "]"}], 
                "]"}]}], ")"}], "*", "dataMax"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"KIout", "=", 
            RowBox[{"KI", "/.", 
             RowBox[{"droppedfits", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2", ",", "1", ",", "2"}], "]"}], 
              "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"eGFPscaleUnits", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
              "\"\<Scaled initial rate (\!\(\*SuperscriptBox[\(s\), \
\(-1\)]\))\>\"", ",", "\"\<Initial rate (uM/s)\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"control", " ", "data"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"controlData", "=", 
            RowBox[{"groupedControl", "[", "n", "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"inhibitorConcentrationsControl", "=", 
            RowBox[{"Normal", "[", 
             RowBox[{"controlData", "[", 
              RowBox[{"All", ",", "\"\<InhibitorConcentration\>\""}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"eGFPscalingListControl", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Normal", "[", 
                 RowBox[{"controlData", "[", 
                  RowBox[{"All", ",", "\"\<eGFPSummedI\>\""}], "]"}], "]"}], 
                "/", "eGFPslope"}], "/", "1000."}], ",", 
              RowBox[{"scaleByGFP", "\[Equal]", "0"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{"1", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "Length", "[", "inhibitorConcentrationsControl", "]"}], 
                 "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"controlPlotTEMP", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"controlData", "[", 
                 RowBox[{"run", ",", "\"\<InhibitorConcentration\>\""}], 
                 "]"}], ",", 
                RowBox[{"controlData", "[", 
                 RowBox[{"run", ",", "rateKey"}], "]"}], ",", 
                RowBox[{"eGFPscalingListControl", "[", 
                 RowBox[{"[", "run", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"run", ",", "1", ",", 
                RowBox[{"Length", "[", "controlData", "]"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"controlPlot", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"controlPlotTEMP", "[", 
                 RowBox[{"[", 
                  RowBox[{"run", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"controlPlotTEMP", "[", 
                  RowBox[{"[", 
                   RowBox[{"run", ",", "2"}], "]"}], "]"}], "/", 
                 RowBox[{"controlPlotTEMP", "[", 
                  RowBox[{"[", 
                   RowBox[{"run", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"run", ",", "1", ",", 
                RowBox[{"Length", "[", "controlPlotTEMP", "]"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"full", " ", "inhibition", " ", "fit"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"MMfitplot", "=", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"LogLinearPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"fits", "[", "x", "]"}], "*", "dataMax"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "0.4", ",", "1250"}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<[I] (uM)\>\"", ",", "\"\<Initial rate (uM/s)\>\""}], 
                  "}"}]}]}], "]"}], ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{"data2", ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                RowBox[{"GridLines", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"None", ",", 
                   RowBox[{"{", 
                    RowBox[{"data2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "}"}]}], "}"}]}], 
                ",", 
                RowBox[{"GridLinesStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Gray", ",", " ", "Dashed"}], "]"}]}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<[I] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                  "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{"controlPlot", ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Black", ",", 
                   RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
               "]"}], ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"controlPlot", "[", 
                   RowBox[{"[", "run", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"White", ",", 
                   RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
               "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"plot", " ", "dropout", " ", "fitting"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"dropoutFitPlot", "=", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"LogLinearPlot", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "2"}], "]"}], "]"}], "[", "x", "]"}], 
                    "*", "dataMax"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0.4", ",", "1250"}], "}"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], ",", 
                    RowBox[{"ColorData", "[", 
                    RowBox[{"4", ",", "\"\<ColorList\>\""}], "]"}]}], "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
                    RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}]}], "]"}], 
                  ",", 
                  RowBox[{"ListLogLinearPlot", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                   "]"}], ",", 
                  RowBox[{"ListLogLinearPlot", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], ",", 
                    RowBox[{"ColorData", "[", 
                    RowBox[{"4", ",", "\"\<ColorList\>\""}], "]"}]}], "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"run", ",", "1", ",", 
                  RowBox[{"Length", "[", "droppedfits", "]"}]}], "}"}]}], 
               "]"}], ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{"controlPlot", ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Black", ",", 
                   RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
               "]"}], ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"controlPlot", "[", 
                   RowBox[{"[", "run", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"White", ",", 
                   RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
               "]"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
              RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
              RowBox[{"GridLines", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"None", ",", 
                 RowBox[{"{", 
                  RowBox[{"data2", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "}"}]}], "}"}]}], 
              ",", 
              RowBox[{"GridLinesStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"Gray", ",", " ", "Dashed"}], "]"}]}], ",", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"Axes", "\[Rule]", "False"}], ",", 
              RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<[I] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"eGFPscaleAppend", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
              "\"\< PerPointScaled\>\"", ",", "\"\< Unscaled\>\""}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "note", " ", "that", " ", "when", " ", "plotting", " ", 
             "MMFitObj", " ", "need", " ", "to", " ", "apply", " ", "the", 
             " ", "scale", " ", "factor"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Association", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<Indices\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"grouped", "[", 
                  RowBox[{"n", ",", "1", ",", "\"\<Indices\>\""}], "]"}], "//",
                  "Normal"}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<VmaxMMfit\>\"", ",", "\"\< \>\"", ",", "keyAppend", ",", 
                 "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Vmax", "/.", 
                   RowBox[{"fits", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ")"}], "*", 
                 "dataMax"}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<KiInhibitionFit\>\"", ",", "\"\< \>\"", ",", "keyAppend",
                  ",", "eGFPscaleAppend"}], "]"}], "->", 
               RowBox[{"(", 
                RowBox[{"Ki", "/.", 
                 RowBox[{"fits", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<InhibitionFitObj\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               RowBox[{"(", "fits", ")"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<InhibitionFit ScaleFactor\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend"}], "]"}], "\[Rule]", 
               RowBox[{"(", "dataMax", ")"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<InhibitionFitRsquared\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               RowBox[{"fits", "[", "\"\<RSquared\>\"", "]"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<DataPointsUsedforInhibitionfitting\>\"", ",", 
                 "\"\< \>\"", ",", "keyAppend", ",", "eGFPscaleAppend"}], 
                "]"}], "\[Rule]", 
               RowBox[{"Length", "[", 
                RowBox[{"Normal", "[", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"grouped", "[", 
                    RowBox[{"n", ",", "All", ",", "rateKey"}], "]"}], ",", 
                   "\"\<NaN\>\""}], "]"}], "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<InhibitionFitPlot\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               "MMfitplot"}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<InhibitionFitPlotAll\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               "dropoutFitPlot"}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                "\"\<DropoutFitObjects\>\"", ",", "\"\< \>\"", ",", 
                 "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
               "droppedfits"}]}], "}"}], "]"}]}], ")"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"Length", "[", "grouped", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Dataset", "[", 
       RowBox[{"JoinAcross", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "dataset", "]"}], ",", "fitdata", ",", 
         "\"\<Indices\>\"", ",", "\"\<Left\>\""}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fitMichaelisMentenNoPlotting", "[", 
     RowBox[{"dataset_", ",", "rateKey_", ",", "keyAppend_", ",", 
      RowBox[{"scaleByGFP_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "removeControl", ",", "grouped", ",", "fitdata", ",", "fits", ",", 
        "rates", ",", "data", ",", "data2", ",", "dataMax", ",", "dataNorm", 
        ",", "droppedfits", ",", "Vmaxout", ",", "KIout", ",", 
        "dropoutFitPlot", ",", "slopeout", ",", "interceptout", ",", 
        "dropoutLinearFitPlot", ",", "MMfitplot", ",", "fullLinearFitPlot", 
        ",", "eGFPscalingList", ",", "data2a", ",", "data2b", ",", 
        "eGFPscaleAppend", ",", "eGFPscaleUnits", ",", 
        "substrateconcentrations", ",", "onlyControl", ",", "groupedControl", 
        ",", "controlData", ",", "substrateConcentrationsControl", ",", 
        "eGFPscalingListControl", ",", "controlPlotTEMP", ",", 
        "controlPlot"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"reads", " ", "in", " ", "Dataset"}], ",", " ", 
        RowBox[{
         RowBox[{"fits", " ", "chosen", " ", "rates", " ", 
          RowBox[{"(", 
           RowBox[{"determined", " ", "by", " ", "key"}], ")"}], " ", "to", 
          " ", "linear", " ", "and", " ", "Michaelis"}], "-", 
         RowBox[{"Menten", " ", "models"}]}], ",", " ", 
        RowBox[{
        "returning", " ", "a", " ", "list", " ", "of", " ", "associations"}], 
        ",", " ", 
        RowBox[{
        "and", " ", "merging", " ", "fit", " ", "data", " ", "with", " ", 
         "input", " ", "data", " ", "to", " ", "create", " ", "a", " ", "new",
          " ", "aggregate", " ", "dataset"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"start", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"removeControl", "=", 
        RowBox[{"dataset", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"#AssayType", "\[Equal]", "1"}], "&"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"grouped", "=", 
        RowBox[{"removeControl", "[", 
         RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"onlyControl", "=", 
        RowBox[{"dataset", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"#AssayType", "\[Equal]", "0"}], "&"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"groupedControl", "=", 
        RowBox[{"onlyControl", "[", 
         RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"fitdata", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Clear", "[", 
             RowBox[{
             "fits", ",", "data", ",", "data2", ",", "rates", ",", 
              "substrateconcentrations", ",", "eGFPscalingList"}], "]"}], ";",
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"substrateconcentrations", "=", 
             RowBox[{"Normal", "[", 
              RowBox[{"grouped", "[", 
               RowBox[{"n", ",", "All", ",", "\"\<SubstrateConc\>\""}], "]"}],
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"eGFPscalingList", "=", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Normal", "[", 
                  RowBox[{"grouped", "[", 
                   RowBox[{"n", ",", "All", ",", "\"\<eGFPSummedI\>\""}], 
                   "]"}], "]"}], "/", "eGFPslope"}], "/", "1000."}], ",", 
               RowBox[{"scaleByGFP", "\[Equal]", "0"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "substrateconcentrations", "]"}], 
                  "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"rates", "=", 
             RowBox[{"Normal", "[", 
              RowBox[{"grouped", "[", 
               RowBox[{"n", ",", "All", ",", "rateKey"}], "]"}], "]"}]}], ";",
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"data", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"substrateconcentrations", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], ",", 
                 RowBox[{"rates", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], ",", 
                 RowBox[{"eGFPscalingList", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "substrateconcentrations", "]"}]}], 
                "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"data2a", "=", 
             RowBox[{"Select", "[", 
              RowBox[{"data", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", 
                  "\"\<NaN\>\""}], "&&", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ">", "0"}]}], "&"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"data2b", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"data2a", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"data2a", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], "/", 
                  RowBox[{"data2a", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "data2a", "]"}]}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"dataMax", "=", 
             RowBox[{"Max", "[", 
              RowBox[{"data2b", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"data2", "=", "data2b"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"dataNorm", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"data2", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"data2", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], "/", "dataMax"}]}],
                 "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "data2", "]"}]}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"fits", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"LinearModelFit", "[", 
                RowBox[{"data2", ",", "x", ",", "x"}], "]"}], ",", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"dataNorm", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Vmax", "*", 
                    RowBox[{"substrate", "/", 
                    RowBox[{"(", 
                    RowBox[{"KM", "+", "substrate"}], ")"}]}]}], ",", 
                   RowBox[{
                    RowBox[{"KM", ">", "0"}], "&&", 
                    RowBox[{"Vmax", ">", "0"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Vmax", ",", "KM"}], "}"}], ",", "substrate"}], 
                "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "drop", " ", "individual", " ", "points", " ", "and", " ", 
              "refit"}], " ", "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"droppedfits", "=", 
             RowBox[{
             "Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"dataNorm", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], ",", 
                 RowBox[{"NonlinearModelFit", "[", 
                  RowBox[{
                   RowBox[{"Drop", "[", 
                    RowBox[{"dataNorm", ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Vmax", "*", 
                    RowBox[{"substrate", "/", 
                    RowBox[{"(", 
                    RowBox[{"KM", "+", "substrate"}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"KM", ">", "0"}], "&&", 
                    RowBox[{"Vmax", ">", "0"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"Vmax", ",", "KM"}], "}"}], ",", "substrate"}], 
                  "]"}], ",", 
                 RowBox[{"LinearModelFit", "[", 
                  RowBox[{
                   RowBox[{"Drop", "[", 
                    RowBox[{"data2", ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}], ",", "x", ",", "x"}], 
                  "]"}]}], "}"}], "\[IndentingNewLine]", 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "dataNorm", "]"}]}], "}"}]}], "]"}]}],
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"extract", " ", "parameters"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Vmaxout", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Vmax", "/.", 
                RowBox[{"droppedfits", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2", ",", "1", ",", "2"}], "]"}], 
                 "]"}]}], ")"}], "*", "dataMax"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"KMout", "=", 
             RowBox[{"KM", "/.", 
              RowBox[{"droppedfits", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2", ",", "1", ",", "2"}], "]"}], 
               "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"slopeout", "=", 
             RowBox[{"droppedfits", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3", ",", "1", ",", "2", ",", "2"}], "]"}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"interceptout", "=", 
             RowBox[{"droppedfits", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3", ",", "1", ",", "2", ",", "1"}], "]"}],
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"eGFPscaleUnits", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               "\"\<Scaled initial rate (\!\(\*SuperscriptBox[\(s\), \
\(-1\)]\))\>\"", ",", "\"\<Initial rate (uM/s)\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"eGFPscaleAppend", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               "\"\< PerPointScaled\>\"", ",", "\"\< Unscaled\>\""}], "]"}]}],
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Vmaxorkcat", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               "\"\< kcatMMfit\>\"", ",", "\"\< VmaxMMfit\>\""}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "note", " ", "that", " ", "when", " ", "plotting", " ", 
              "MMFitObj", " ", "need", " ", "to", " ", "apply", " ", "the", 
              " ", "scale", " ", "factor"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Association", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<Indices\>\"", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"grouped", "[", 
                   RowBox[{"n", ",", "1", ",", "\"\<Indices\>\""}], "]"}], "//",
                   "Normal"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<LinFitSlope\>\"", ",", "\"\< \>\"", ",", "keyAppend", 
                  ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"fits", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}]}],
                ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<LinFitIntercept\>\"", ",", "\"\< \>\"", ",", 
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "->", 
                RowBox[{"fits", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}]}],
                ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<LinMMFitObj\>\"", ",", "\"\< \>\"", ",", "keyAppend", 
                  ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"fits", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<LinMMFitRsquared\>\"", ",", "\"\< \>\"", ",", 
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"fits", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<RSquared\>\"", 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "Vmaxorkcat", ",", "\"\< \>\"", ",", "keyAppend", ",", 
                  "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Vmax", "/.", 
                    RowBox[{"fits", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], ")"}], 
                  "*", "dataMax"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<KmMMfit\>\"", ",", "\"\< \>\"", ",", "keyAppend", ",", 
                  "eGFPscaleAppend"}], "]"}], "->", 
                RowBox[{"(", 
                 RowBox[{"KM", "/.", 
                  RowBox[{"fits", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], 
                 ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<MMFitObj\>\"", ",", "\"\< \>\"", ",", "keyAppend", ",", 
                  "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"fits", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<MMFit ScaleFactor\>\"", ",", "\"\< \>\"", ",", 
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"(", "dataMax", ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<MMFitRsquared\>\"", ",", "\"\< \>\"", ",", "keyAppend", 
                  ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"fits", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<RSquared\>\"", 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<DataPointsUsedforMMfitting\>\"", ",", "\"\< \>\"", ",", 
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"Length", "[", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"grouped", "[", 
                    RowBox[{"n", ",", "All", ",", "rateKey"}], "]"}], ",", 
                    "\"\<NaN\>\""}], "]"}], "]"}], "]"}]}]}], "}"}], "]"}]}], 
           ")"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "grouped", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Dataset", "[", 
        RowBox[{"JoinAcross", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "dataset", "]"}], ",", "fitdata", ",", 
          "\"\<Indices\>\"", ",", "\"\<Left\>\""}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fitMichaelisMenten", "[", 
     RowBox[{"dataset_", ",", "rateKey_", ",", "keyAppend_", ",", 
      RowBox[{"scaleByGFP_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "removeControl", ",", "grouped", ",", "fitdata", ",", "fits", ",", 
        "rates", ",", "data", ",", "data2", ",", "dataMax", ",", "dataNorm", 
        ",", "droppedfits", ",", "Vmaxout", ",", "KIout", ",", 
        "dropoutFitPlot", ",", "slopeout", ",", "interceptout", ",", 
        "dropoutLinearFitPlot", ",", "MMfitplot", ",", "fullLinearFitPlot", 
        ",", "eGFPscalingList", ",", "data2a", ",", "data2b", ",", 
        "eGFPscaleAppend", ",", "eGFPscaleUnits", ",", 
        "substrateconcentrations", ",", "onlyControl", ",", "groupedControl", 
        ",", "controlData", ",", "substrateConcentrationsControl", ",", 
        "eGFPscalingListControl", ",", "controlPlotTEMP", ",", 
        "controlPlot"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"reads", " ", "in", " ", "Dataset"}], ",", " ", 
        RowBox[{
         RowBox[{"fits", " ", "chosen", " ", "rates", " ", 
          RowBox[{"(", 
           RowBox[{"determined", " ", "by", " ", "key"}], ")"}], " ", "to", 
          " ", "linear", " ", "and", " ", "Michaelis"}], "-", 
         RowBox[{"Menten", " ", "models"}]}], ",", " ", 
        RowBox[{
        "returning", " ", "a", " ", "list", " ", "of", " ", "associations"}], 
        ",", " ", 
        RowBox[{
        "and", " ", "merging", " ", "fit", " ", "data", " ", "with", " ", 
         "input", " ", "data", " ", "to", " ", "create", " ", "a", " ", "new",
          " ", "aggregate", " ", "dataset"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"removeControl", "=", 
        RowBox[{"dataset", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"#AssayType", "\[Equal]", "1"}], "&"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"grouped", "=", 
        RowBox[{"removeControl", "[", 
         RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"onlyControl", "=", 
        RowBox[{"dataset", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"#AssayType", "\[Equal]", "0"}], "&"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"groupedControl", "=", 
        RowBox[{"onlyControl", "[", 
         RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"fitdata", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Clear", "[", 
             RowBox[{
             "fits", ",", "data", ",", "data2", ",", "rates", ",", 
              "substrateconcentrations", ",", "eGFPscalingList"}], "]"}], ";",
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"substrateconcentrations", "=", 
             RowBox[{"Normal", "[", 
              RowBox[{"grouped", "[", 
               RowBox[{"n", ",", "All", ",", "\"\<SubstrateConc\>\""}], "]"}],
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"eGFPscalingList", "=", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Normal", "[", 
                  RowBox[{"grouped", "[", 
                   RowBox[{"n", ",", "All", ",", "\"\<eGFPSummedI\>\""}], 
                   "]"}], "]"}], "/", "eGFPslope"}], "/", "1000."}], ",", 
               RowBox[{"scaleByGFP", "\[Equal]", "0"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "substrateconcentrations", "]"}], 
                  "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"rates", "=", 
             RowBox[{"Normal", "[", 
              RowBox[{"grouped", "[", 
               RowBox[{"n", ",", "All", ",", "rateKey"}], "]"}], "]"}]}], ";",
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"data", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"substrateconcentrations", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], ",", 
                 RowBox[{"rates", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], ",", 
                 RowBox[{"eGFPscalingList", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "substrateconcentrations", "]"}]}], 
                "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"data2a", "=", 
             RowBox[{"Select", "[", 
              RowBox[{"data", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", 
                  "\"\<NaN\>\""}], "&&", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ">", "0"}]}], "&"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"data2b", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"data2a", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"data2a", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], "/", 
                  RowBox[{"data2a", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "data2a", "]"}]}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"dataMax", "=", 
             RowBox[{"Max", "[", 
              RowBox[{"data2b", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"data2", "=", "data2b"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"dataNorm", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"data2", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"data2", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], "/", "dataMax"}]}],
                 "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "data2", "]"}]}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"fits", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"LinearModelFit", "[", 
                RowBox[{"data2", ",", "x", ",", "x"}], "]"}], ",", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"dataNorm", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Vmax", "*", 
                    RowBox[{"substrate", "/", 
                    RowBox[{"(", 
                    RowBox[{"KM", "+", "substrate"}], ")"}]}]}], ",", 
                   RowBox[{
                    RowBox[{"KM", ">", "0"}], "&&", 
                    RowBox[{"Vmax", ">", "0"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Vmax", ",", "KM"}], "}"}], ",", "substrate"}], 
                "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "drop", " ", "individual", " ", "points", " ", "and", " ", 
              "refit"}], " ", "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"droppedfits", "=", 
             RowBox[{
             "Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"dataNorm", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], ",", 
                 RowBox[{"NonlinearModelFit", "[", 
                  RowBox[{
                   RowBox[{"Drop", "[", 
                    RowBox[{"dataNorm", ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Vmax", "*", 
                    RowBox[{"substrate", "/", 
                    RowBox[{"(", 
                    RowBox[{"KM", "+", "substrate"}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"KM", ">", "0"}], "&&", 
                    RowBox[{"Vmax", ">", "0"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"Vmax", ",", "KM"}], "}"}], ",", "substrate"}], 
                  "]"}], ",", 
                 RowBox[{"LinearModelFit", "[", 
                  RowBox[{
                   RowBox[{"Drop", "[", 
                    RowBox[{"data2", ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}], ",", "x", ",", "x"}], 
                  "]"}]}], "}"}], "\[IndentingNewLine]", 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "dataNorm", "]"}]}], "}"}]}], "]"}]}],
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"extract", " ", "parameters"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Vmaxout", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Vmax", "/.", 
                RowBox[{"droppedfits", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2", ",", "1", ",", "2"}], "]"}], 
                 "]"}]}], ")"}], "*", "dataMax"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"KMout", "=", 
             RowBox[{"KM", "/.", 
              RowBox[{"droppedfits", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2", ",", "1", ",", "2"}], "]"}], 
               "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"slopeout", "=", 
             RowBox[{"droppedfits", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3", ",", "1", ",", "2", ",", "2"}], "]"}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"interceptout", "=", 
             RowBox[{"droppedfits", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3", ",", "1", ",", "2", ",", "1"}], "]"}],
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"eGFPscaleUnits", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               
               "\"\<Scaled initial rate (\!\(\*SuperscriptBox[\(s\), \
\(-1\)]\))\>\"", ",", "\"\<Initial rate (uM/s)\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"control", " ", "data"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"controlData", "=", 
             RowBox[{"groupedControl", "[", "n", "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"substrateConcentrationsControl", "=", 
             RowBox[{"Normal", "[", 
              RowBox[{"controlData", "[", 
               RowBox[{"All", ",", "\"\<SubstrateConc\>\""}], "]"}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"eGFPscalingListControl", "=", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Normal", "[", 
                  RowBox[{"controlData", "[", 
                   RowBox[{"All", ",", "\"\<eGFPSummedI\>\""}], "]"}], "]"}], 
                 "/", "eGFPslope"}], "/", "1000."}], ",", 
               RowBox[{"scaleByGFP", "\[Equal]", "0"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "Length", "[", "substrateConcentrationsControl", "]"}], 
                  "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"controlPlotTEMP", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"controlData", "[", 
                  RowBox[{"run", ",", "\"\<SubstrateConc\>\""}], "]"}], ",", 
                 RowBox[{"controlData", "[", 
                  RowBox[{"run", ",", "rateKey"}], "]"}], ",", 
                 RowBox[{"eGFPscalingListControl", "[", 
                  RowBox[{"[", "run", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"run", ",", "1", ",", 
                 RowBox[{"Length", "[", "controlData", "]"}]}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"controlPlot", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"controlPlotTEMP", "[", 
                  RowBox[{"[", 
                   RowBox[{"run", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"controlPlotTEMP", "[", 
                   RowBox[{"[", 
                    RowBox[{"run", ",", "2"}], "]"}], "]"}], "/", 
                  RowBox[{"controlPlotTEMP", "[", 
                   RowBox[{"[", 
                    RowBox[{"run", ",", "3"}], "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"run", ",", "1", ",", 
                 RowBox[{"Length", "[", "controlPlotTEMP", "]"}]}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"full", " ", "MM", " ", "fit"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"MMfitplot", "=", 
               RowBox[{"Show", "[", 
                RowBox[{
                 RowBox[{"Plot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"fits", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "x", "]"}], "*", 
                    "dataMax"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1250"}], "}"}], ",", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                   RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                   RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                   RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<[cMUP] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                    "}"}]}]}], "]"}], ",", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{"data2", ",", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                   RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                   RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                   RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<[cMUP] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                    "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{"controlPlot", ",", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                  "]"}], ",", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Callout", "[", 
                    RowBox[{
                    RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                    "\"\<Remeasured\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                  "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"MMfitplot", "=", 
             RowBox[{"Show", "[", 
              RowBox[{
               RowBox[{"Plot", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"fits", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "x", "]"}], "*", 
                  "dataMax"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "0", ",", 
                   RowBox[{
                    RowBox[{"Last", "[", "substrateconcentrations", "]"}], 
                    "*", "1.25"}]}], "}"}], ",", 
                 RowBox[{"PlotRange", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                 RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                 RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                 RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                 RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                 RowBox[{"FrameLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<[Substrate] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                   "}"}]}]}], "]"}], ",", 
               RowBox[{"ListPlot", "[", 
                RowBox[{"data2", ",", 
                 RowBox[{"PlotRange", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                 RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                 RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                 RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                 RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                 RowBox[{"FrameLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<[cMUP] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                   "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"ListPlot", "[", 
                RowBox[{"controlPlot", ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                "]"}], ",", 
               RowBox[{"ListPlot", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                  "]"}], ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"full", " ", "linear", " ", "fit"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"fullLinearFitPlot", "=", 
               RowBox[{"Show", "[", 
                RowBox[{
                 RowBox[{"Plot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"fits", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "x", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1250"}], "}"}]}], "]"}], ",", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{"data2", ",", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                   RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                   RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                   RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<[cMUP] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                    "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{"controlPlot", ",", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                  "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Callout", "[", 
                    RowBox[{
                    RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                    "\"\<Remeasured\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                  "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
                "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"fullLinearFitPlot", "=", 
             RowBox[{"Show", "[", 
              RowBox[{
               RowBox[{"Plot", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"fits", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", "x", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "0", ",", 
                   RowBox[{
                    RowBox[{"Last", "[", "substrateconcentrations", "]"}], 
                    "*", "1.25"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"ListPlot", "[", 
                RowBox[{"data2", ",", 
                 RowBox[{"PlotRange", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "All"}], "}"}]}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                 RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                 RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                 RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                 RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                 RowBox[{"FrameLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<[Substrate] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                   "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"ListPlot", "[", 
                RowBox[{"controlPlot", ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"ListPlot", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                  "]"}], ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"plot", " ", "dropout", " ", "fitting"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"dropoutFitPlot", "=", 
               RowBox[{"Show", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "2"}], "]"}], "]"}], "[", "x", "]"}], 
                    "*", "dataMax"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1250"}], "}"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
                    RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{"controlPlot", ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Callout", "[", 
                    RowBox[{
                    RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                    "\"\<Remeasured\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "droppedfits", "]"}]}], "}"}]}], 
                  "]"}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                 RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                 RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                 RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                 RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                 RowBox[{"FrameLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<[cMUP] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                   "}"}]}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"dropoutFitPlot", "=", 
             RowBox[{"Show", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Plot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "2"}], "]"}], "]"}], "[", "x", "]"}], 
                    "*", "dataMax"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "substrateconcentrations", "]"}], 
                    "*", "1.25"}]}], "}"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
                    RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}]}], "]"}], 
                   ",", 
                   RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                   RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                   RowBox[{"ListPlot", "[", 
                    RowBox[{"controlPlot", ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                   RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"run", ",", "1", ",", 
                   RowBox[{"Length", "[", "droppedfits", "]"}]}], "}"}]}], 
                "]"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
               RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"Axes", "\[Rule]", "False"}], ",", 
               RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"\"\<[Substrate] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                 "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"dropoutLinearFitPlot", "=", 
               RowBox[{"Show", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "3"}], "]"}], "]"}], "[", "x", "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1250"}], "}"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
                    RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "droppedfits", "]"}]}], "}"}]}], 
                  "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{"controlPlot", ",", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                  "]"}], ",", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Callout", "[", 
                    RowBox[{
                    RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                    "\"\<Remeasured\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                  "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
                 RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
                 RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                 RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                 RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                 RowBox[{"FrameLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<[cMUP] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                   "}"}]}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"dropoutLinearFitPlot", "=", 
             RowBox[{"Show", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Plot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "3"}], "]"}], "]"}], "[", "x", "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "substrateconcentrations", "]"}], 
                    "*", "1.25"}]}], "}"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
                    RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}]}], "]"}], 
                   ",", 
                   RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                    "]"}], ",", 
                   RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"droppedfits", "[", 
                    RowBox[{"[", 
                    RowBox[{"run", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1.0", ",", "dataMax"}], "}"}]}], "}"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"run", "+", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"run", ",", "1", ",", 
                   RowBox[{"Length", "[", "droppedfits", "]"}]}], "}"}]}], 
                "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"ListPlot", "[", 
                RowBox[{"controlPlot", ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}]}], "]"}]}]}], 
                "]"}], ",", 
               RowBox[{"ListPlot", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"controlPlot", "[", 
                    RowBox[{"[", "run", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"run", ",", "1", ",", 
                    RowBox[{"Length", "[", "controlPlot", "]"}]}], "}"}]}], 
                  "]"}], ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"White", ",", 
                    RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}]}], 
                "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
               RowBox[{"ImagePadding", "\[Rule]", "50"}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"Axes", "\[Rule]", "False"}], ",", 
               RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"\"\<[Substrate] (uM)\>\"", ",", "eGFPscaleUnits"}], 
                 "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"eGFPscaleAppend", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               "\"\< PerPointScaled\>\"", ",", "\"\< Unscaled\>\""}], "]"}]}],
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Vmaxorkcat", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"scaleByGFP", "\[Equal]", "1"}], ",", 
               "\"\< kcatMMfit\>\"", ",", "\"\< VmaxMMfit\>\""}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "note", " ", "that", " ", "when", " ", "plotting", " ", 
              "MMFitObj", " ", "need", " ", "to", " ", "apply", " ", "the", 
              " ", "scale", " ", "factor"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Association", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<Indices\>\"", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"grouped", "[", 
                   RowBox[{"n", ",", "1", ",", "\"\<Indices\>\""}], "]"}], "//",
                   "Normal"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<LinFitSlope\>\"", ",", "\"\< \>\"", ",", "keyAppend", 
                  ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"fits", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}]}],
                ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<LinFitIntercept\>\"", ",", "\"\< \>\"", ",", 
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "->", 
                RowBox[{"fits", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}]}],
                ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<LinMMFitObj\>\"", ",", "\"\< \>\"", ",", "keyAppend", 
                  ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"fits", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<LinMMFitRsquared\>\"", ",", "\"\< \>\"", ",", 
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"fits", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<RSquared\>\"", 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "Vmaxorkcat", ",", "\"\< \>\"", ",", "keyAppend", ",", 
                  "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Vmax", "/.", 
                    RowBox[{"fits", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], ")"}], 
                  "*", "dataMax"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<KmMMfit\>\"", ",", "\"\< \>\"", ",", "keyAppend", ",", 
                  "eGFPscaleAppend"}], "]"}], "->", 
                RowBox[{"(", 
                 RowBox[{"KM", "/.", 
                  RowBox[{"fits", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], 
                 ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<MMFitObj\>\"", ",", "\"\< \>\"", ",", "keyAppend", ",", 
                  "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"fits", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<MMFit ScaleFactor\>\"", ",", "\"\< \>\"", ",", 
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"(", "dataMax", ")"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<MMFitRsquared\>\"", ",", "\"\< \>\"", ",", "keyAppend", 
                  ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"fits", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<RSquared\>\"", 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<DataPointsUsedforMMfitting\>\"", ",", "\"\< \>\"", ",", 
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                RowBox[{"Length", "[", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"grouped", "[", 
                    RowBox[{
                    "n", ",", "All", ",", "rateKey", ",", "eGFPscaleAppend"}],
                     "]"}], ",", "\"\<NaN\>\""}], "]"}], "]"}], "]"}]}], ",", 
               
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<MMFitPlot\>\"", ",", "\"\< \>\"", ",", "keyAppend", ",",
                   "eGFPscaleAppend"}], "]"}], "\[Rule]", "MMfitplot"}], ",", 
               
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<LinearMMFitPlot\>\"", ",", "\"\< \>\"", ",", 
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                "fullLinearFitPlot"}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<MMFitPlotAll\>\"", ",", "\"\< \>\"", ",", "keyAppend", 
                  ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                "dropoutFitPlot"}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<LinearFitPlotAll\>\"", ",", "\"\< \>\"", ",", 
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                "dropoutLinearFitPlot"}], ",", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                 "\"\<DropoutFitObjects\>\"", ",", "\"\< \>\"", ",", 
                  "keyAppend", ",", "eGFPscaleAppend"}], "]"}], "\[Rule]", 
                "droppedfits"}]}], "}"}], "]"}]}], ")"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "grouped", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Dataset", "[", 
        RowBox[{"JoinAcross", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "dataset", "]"}], ",", "fitdata", ",", 
          "\"\<Indices\>\"", ",", "\"\<Left\>\""}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "local", " ", "background", " ", "interpolation", " ", "and", " ", 
    "plotting", " ", "functions"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interpolateDeadMutantsPerColumn", "[", 
    RowBox[{
    "mutantList_", ",", "expIndex_", ",", "column_", ",", "datasetIN_", ",", 
     "rateKey_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"selected", ",", "selectedRates", ",", "out", ",", "dataset"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataset", "=", "datasetIN"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selected", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"Values", "[", 
           RowBox[{"dataset", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Apply", "[", 
                  RowBox[{"Or", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"#MutantID", "\[Equal]", 
                    RowBox[{"mutantList", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "1", ",", 
                    RowBox[{"Length", "[", "mutantList", "]"}]}], "}"}]}], 
                    "]"}]}], "]"}], ")"}], "&&", 
                RowBox[{"#ExpIndex", "\[Equal]", "expIndex"}], "&&", 
                RowBox[{
                 RowBox[{"#Indices", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "column"}]}], 
               " ", "&"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Indices\>\"", ",", "rateKey", ",", "\"\<MutantID\>\""}], 
              "}"}]}], "]"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "<", 
           RowBox[{"#2", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"selectedRates", "=", 
       RowBox[{"selected", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"out", "=", "selectedRates"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"selectedRates", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], ",", 
         "out", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"out", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"column", ",", "1"}], "}"}], ",", " ", 
             RowBox[{"selectedRates", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"selectedRates", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], ",", "56"}], 
          "]"}], ",", "out", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"out", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"column", ",", "56"}], "}"}], ",", " ", 
             RowBox[{"selectedRates", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", " ", "2"}], "]"}], "]"}]}], "}"}]}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"Length", "[", "out", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", " ", "56", ",", " ", "1"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"calculateLocalBGRatio", "[", 
    RowBox[{
    "chamber_", ",", "expIndex_", ",", "interpolation_", ",", "datasetIN_", 
     ",", "rateKey_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "column", ",", "measuredChamberRate", ",", "dataset", ",", 
       "backgroundRate"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataset", "=", "datasetIN"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"measuredChamberRate", "=", 
       RowBox[{
        RowBox[{"Values", "[", 
         RowBox[{"Normal", "[", 
          RowBox[{"dataset", "[", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#Indices", "\[Equal]", "chamber"}], "&&", 
               RowBox[{"#ExpIndex", "\[Equal]", "expIndex"}]}], "&"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Indices\>\"", ",", "rateKey", ",", "\"\<MutantID\>\""}], 
             "}"}]}], "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"backgroundRate", "=", 
       RowBox[{"interpolation", "[", 
        RowBox[{"[", 
         RowBox[{"chamber", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"measuredChamberRate", "/", "backgroundRate"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"generateLocalBGPlot", "[", 
    RowBox[{
    "chamber_", ",", "expIndex_", ",", "interpolation_", ",", 
     "boundingMutants_", ",", "datasetIN_", ",", "rateKey_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "allinColumn", ",", "column", ",", "row", ",", "dataset", ",", 
       "upperBound", ",", "lowerBound"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "upper", " ", "and", " ", "lower", " ", "bounds", " ", "are", " ", 
        "dynamic", " ", "range", " ", "limits"}], ",", " ", 
       RowBox[{
       "often", " ", "set", " ", "by", " ", "wtMedian", " ", "and", " ", 
        "T79Smedian", " ", 
        RowBox[{"(", 
         RowBox[{
         "culling", " ", "for", " ", "chambers", " ", "with", " ", 
          "expression"}], ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataset", "=", "datasetIN"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"column", "=", 
       RowBox[{"chamber", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"row", "=", 
       RowBox[{"chamber", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"upperBound", "=", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Values", "[", 
          RowBox[{"Normal", "[", 
           RowBox[{"dataset", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#MutantID", "\[Equal]", 
                 RowBox[{"boundingMutants", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
                RowBox[{"#ExpIndex", "\[Equal]", "expIndex"}], "&&", 
                RowBox[{"#eGFPSummedI", ">", 
                 RowBox[{"0.5", "*", "eGFPslope"}]}]}], "&"}], "]"}], ",", 
             RowBox[{"{", "rateKey", "}"}]}], "]"}], "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"lowerBound", "=", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Values", "[", 
          RowBox[{"Normal", "[", 
           RowBox[{"dataset", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#MutantID", "\[Equal]", 
                 RowBox[{"boundingMutants", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
                RowBox[{"#ExpIndex", "\[Equal]", "expIndex"}], "&&", 
                RowBox[{"#eGFPSummedI", ">", 
                 RowBox[{"0.5", "*", "eGFPslope"}]}]}], "&"}], "]"}], ",", 
             RowBox[{"{", "rateKey", "}"}]}], "]"}], "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"allinColumn", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Values", "[", 
          RowBox[{"Normal", "[", 
           RowBox[{"dataset", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"#Indices", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "column"}], "&&", 
                RowBox[{"#ExpIndex", "\[Equal]", "expIndex"}]}], "&"}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Indices\>\"", ",", "rateKey", ",", "\"\<MutantID\>\""}], 
              "}"}]}], "]"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "<", 
           RowBox[{"#2", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListLogPlot", "[", 
         RowBox[{"interpolation", ",", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Dashed", ",", "Black"}], "]"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "56"}], "}"}], ",", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"10", "^", 
                RowBox[{"-", "5"}]}], ",", " ", 
               RowBox[{"10", "^", "0"}]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"FontSize", "\[Rule]", "12"}], ",", " ", "Black"}], 
            "]"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.002", "]"}], ",", "Black", ",", 
             RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Y Index\>\"", ",", "\"\<Rate (\[Micro]M/s)\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", "None"}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{"{", 
              RowBox[{"upperBound", ",", " ", "lowerBound"}], "}"}]}], 
            "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "0.5"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ListLogPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Callout", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"allinColumn", "[", 
                RowBox[{"[", 
                 RowBox[{"row", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"allinColumn", "[", 
                RowBox[{"[", 
                 RowBox[{"row", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"allinColumn", "[", 
              RowBox[{"[", 
               RowBox[{"row", ",", "3"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"allinColumn", "[", 
                RowBox[{"[", 
                 RowBox[{"row", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
               "0.01"}], "}"}]}], "]"}], "}"}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Green", ",", " ", "4"}], "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ListLogPlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"allinColumn", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"allinColumn", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", "56"}], "}"}]}], "]"}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Green", ",", " ", "4"}], "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getGFPImage", "[", 
    RowBox[{
    "mutant_", ",", "xindex_", ",", "yindex_", ",", "scalingFactor_"}], "]"}],
    ":=", 
   RowBox[{"ImageResize", "[", 
    RowBox[{
     RowBox[{"Image", "[", 
      RowBox[{
       RowBox[{"ImageData", "[", 
        RowBox[{"Import", "[", 
         RowBox[{"StringJoin", "[", 
          RowBox[{
          "repoPath", ",", "mutant", ",", "\"\</\>\"", ",", "\"\<(\>\"", ",", 
           
           RowBox[{"ToString", "[", "xindex", "]"}], ",", "\"\<, \>\"", ",", 
           RowBox[{"ToString", "[", "yindex", "]"}], ",", "\"\<)/\>\"", ",", 
           "deviceID", ",", "\"\<_eGFP_500ms_ButtonQuant/\>\"", ",", 
           "\"\<(\>\"", ",", 
           RowBox[{"ToString", "[", "xindex", "]"}], ",", "\"\<, \>\"", ",", 
           RowBox[{"ToString", "[", "yindex", "]"}], ",", "\"\<)_\>\"", ",", 
           "mutant", ",", "\"\<.png\>\""}], "]"}], "]"}], "]"}], "*", 
       "scalingFactor"}], "]"}], ",", "75"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeGrid", "[", 
    RowBox[{"datasetIN_", ",", "indices_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grouped", ",", "progresscurves"}], "}"}], ",", 
     RowBox[{
      RowBox[{"grouped", "=", 
       RowBox[{"datasetIN", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"#Indices", "\[Equal]", "indices"}], "&"}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"progresscurves", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"grouped", "[", 
         RowBox[{"All", ",", "\"\<ProgressCurveOptFit\>\""}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"grouped", "[", 
              RowBox[{"1", ",", "\"\<eGFPPostSDSImage\>\""}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Mutant\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Substrate\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Chamber\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<\!\(\*SubscriptBox[\(V\), \(max\)]\) \
(\!\(\*SuperscriptBox[\(s\), \(-1\)]\))\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<\!\(\*SubscriptBox[\(k\), \(cat\)]\) \
(\!\(\*SuperscriptBox[\(s\), \(-1\)]\))\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<\!\(\*SubscriptBox[\(K\), \(M\)]\) (uM)\>\"", ",", "Bold", 
               ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<\!\(\*SubscriptBox[\(k\), \
\(cat\)]\)/\!\(\*SubscriptBox[\(K\), \(M\)]\) (\!\(\*SuperscriptBox[\(M\), \
\(-1\)]\) \!\(\*SuperscriptBox[\(s\), \(-1\)]\))\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<\!\(\*SuperscriptBox[\(R\), \(2\)]\)\>\"", ",", "Bold", 
               ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<[E]\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<eGFP Intensity\>\"", ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}], 
            "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"SpanFromAbove", ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"grouped", "[", 
                RowBox[{"1", ",", "\"\<MutantID\>\""}], "]"}], ",", "Bold", 
               ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<cMUP\>\"", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"grouped", "[", 
                 RowBox[{"1", ",", "\"\<Indices\>\""}], "]"}], "]"}], ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"grouped", "[", 
                 RowBox[{"1", ",", "\"\< kcatMMfit Opt. PerPointScaled\>\""}],
                  "]"}], "]"}], ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"grouped", "[", 
                 RowBox[{"1", ",", "\"\< kcatMMfit Opt. PerPointScaled\>\""}],
                  "]"}], "]"}], ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"grouped", "[", 
                RowBox[{"1", ",", "\"\<KmMMfit Opt. PerPointScaled\>\""}], 
                "]"}], ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"grouped", "[", 
                 RowBox[{"1", ",", "\"\< kcatMMfit Opt. PerPointScaled\>\""}],
                  "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Normal", "[", 
                   RowBox[{"grouped", "[", 
                    RowBox[{"1", ",", "\"\<KmMMfit Opt. PerPointScaled\>\""}],
                     "]"}], "]"}], " ", 
                  RowBox[{"10", "^", 
                   RowBox[{"-", "6"}]}]}], ")"}]}], ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"grouped", "[", 
                 RowBox[{
                 "1", ",", "\"\<MMFitRsquared Opt. PerPointScaled\>\""}], 
                 "]"}], "]"}], ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Normal", "[", 
                 RowBox[{"grouped", "[", 
                  RowBox[{"1", ",", "\"\<eGFPSummedI\>\""}], "]"}], "]"}], 
                "/", 
                RowBox[{"Normal", "[", 
                 RowBox[{"grouped", "[", 
                  RowBox[{"1", ",", "\"\<eGFPSlope\>\""}], "]"}], "]"}]}], 
               ",", "Bold", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"grouped", "[", 
                 RowBox[{"1", ",", "\"\<eGFPSummedI\>\""}], "]"}], "]"}], ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}], 
            "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"TableForm", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Normal", "[", 
                 RowBox[{"grouped", "[", 
                  RowBox[{
                  "1", ",", "\"\<MMFitPlotAll Opt. PerPointScaled\>\""}], 
                  "]"}], "]"}], ",", 
                RowBox[{"Normal", "[", 
                 RowBox[{"grouped", "[", 
                  RowBox[{"1", ",", "\"\<eGFPIntensityPlot\>\""}], "]"}], 
                 "]"}], ",", 
                RowBox[{"Normal", "[", 
                 RowBox[{"grouped", "[", 
                  RowBox[{"1", ",", "\"\<StandardCurvePlot\>\""}], "]"}], 
                 "]"}], ",", 
                RowBox[{"Normal", "[", 
                 RowBox[{"grouped", "[", 
                  RowBox[{"1", ",", "\"\<LocalBGMMPlot\>\""}], "]"}], "]"}]}],
                "}"}], "]"}], ",", "SpanFromLeft", ",", 
             RowBox[{"TableForm", "[", 
              RowBox[{"Partition", "[", 
               RowBox[{
                RowBox[{"PadRight", "[", 
                 RowBox[{"progresscurves", ",", 
                  RowBox[{
                   RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "progresscurves", "]"}], "/", 
                    "2"}], "]"}], "*", "2"}], ",", "\"\<\>\""}], "]"}], ",", 
                "2"}], "]"}], "]"}], ",", "SpanFromLeft"}], "}"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}], ",", 
        RowBox[{"Spacings", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], ",", 
        RowBox[{"Alignment", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Center", ",", "Top"}], "}"}]}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"generateLocalBGMMPlot", "[", 
   RowBox[{"chamber_", ",", "datasetIN_", ",", "rateKey_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "column", ",", "measuredChamberRate", ",", "dataset", ",", 
      "backgroundRates"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dataset", "=", "datasetIN"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"measuredChamberRate", "=", 
      RowBox[{
       RowBox[{"Values", "[", 
        RowBox[{"Normal", "[", 
         RowBox[{"dataset", "[", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"#Indices", "\[Equal]", "chamber"}], "&"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Indices\>\"", ",", "rateKey", ",", "\"\<MutantID\>\"", ",", 
             "\"\<SubstrateConc\>\"", ",", "\"\<Interpolation\>\"", ",", 
             "\"\<eGFPSummedI\>\"", ",", "\"\<eGFPSlope\>\""}], "}"}]}], 
          "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"backgroundRates", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"measuredChamberRate", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"measuredChamberRate", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "2", ",", 
              RowBox[{"chamber", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"measuredChamberRate", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3"}], "]"}], "]"}], "/", 
               RowBox[{"measuredChamberRate", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "4"}], "]"}], "]"}]}], ")"}], "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "3"}]}]}], ")"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "measuredChamberRate", "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"backgroundRates", ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "12"}], "]"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"PointSize", "[", "0.025", "]"}], ",", 
           RowBox[{"GrayLevel", "[", "0.5", "]"}]}], "]"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<[S] (\[Mu]M)\>\"", ",", 
           "\"\<BG Rate/[E] (\!\(\*SuperscriptBox[\(s\), \(-1\)]\))\>\""}], 
          "}"}]}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", "50"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.732734519313447*^9, 3.7327345196081133`*^9}, 
   3.7327347490239773`*^9, {3.732816795354333*^9, 3.732816923862208*^9}, {
   3.732817108610519*^9, 3.732817133925861*^9}, {3.732817916793426*^9, 
   3.732817917236841*^9}, {3.732817957911532*^9, 3.732817968559558*^9}, {
   3.732818744915225*^9, 3.732818778441243*^9}, {3.732819682017524*^9, 
   3.732819682703261*^9}, {3.732819713850809*^9, 3.7328197494685926`*^9}, {
   3.7328199689110518`*^9, 3.7328199978194027`*^9}, {3.732820032345057*^9, 
   3.7328200450938473`*^9}, 3.732820247429782*^9, {3.732821310369616*^9, 
   3.732821379044612*^9}, {3.732821427444298*^9, 3.732821443586916*^9}, {
   3.7328214959574966`*^9, 3.7328215665296383`*^9}, {3.7328217499603777`*^9, 
   3.732821769973604*^9}, {3.732821889876337*^9, 3.732821893708391*^9}, {
   3.732827678461425*^9, 3.732827996439777*^9}, {3.732828030379079*^9, 
   3.732828058610034*^9}, {3.7328282995683603`*^9, 3.732828299713214*^9}, {
   3.732828374802285*^9, 3.732828376060054*^9}, {3.732828408738184*^9, 
   3.73282841095273*^9}, {3.732828465926602*^9, 3.7328284711041307`*^9}, {
   3.732828696137602*^9, 3.732828719001034*^9}, {3.732829078498312*^9, 
   3.732829079084334*^9}, {3.7328291248049*^9, 3.732829220794536*^9}, {
   3.732829320938328*^9, 3.732829322684307*^9}, {3.732830061758718*^9, 
   3.732830085241437*^9}, {3.7328301205055437`*^9, 3.732830204045191*^9}, {
   3.7328304884940767`*^9, 3.7328305373073177`*^9}, {3.732830638817354*^9, 
   3.732830642442947*^9}, {3.732830685052309*^9, 3.732830712525044*^9}, {
   3.732830757872312*^9, 3.732830758866479*^9}, {3.732831049085156*^9, 
   3.732831051305684*^9}, {3.732831509171523*^9, 3.7328315235149117`*^9}, {
   3.732831560308303*^9, 3.732831562269196*^9}, {3.732832612641382*^9, 
   3.73283263889312*^9}, {3.7328327357011423`*^9, 3.732832777578816*^9}, {
   3.73283292059835*^9, 3.732832926404221*^9}, {3.732832989877523*^9, 
   3.73283301795411*^9}, {3.732833051028429*^9, 3.732833139644775*^9}, {
   3.732833277925747*^9, 3.732833288796887*^9}, 3.7328333349390173`*^9, {
   3.732833384496855*^9, 3.732833392030738*^9}, {3.7328338927022047`*^9, 
   3.732833894829845*^9}, {3.732900899557596*^9, 3.732900935441663*^9}, {
   3.732901367394619*^9, 3.732901377706794*^9}, {3.732901769517828*^9, 
   3.732901787255741*^9}, {3.73290307923744*^9, 3.732903176329398*^9}, {
   3.732903345221506*^9, 3.732903354967257*^9}, {3.732904174108536*^9, 
   3.732904184487029*^9}, {3.7329105287055597`*^9, 3.732910556222013*^9}, {
   3.7329113090682173`*^9, 3.732911346832547*^9}, {3.732914079585999*^9, 
   3.732914105962956*^9}, {3.732974145736065*^9, 3.732974173173771*^9}, {
   3.7329742242867613`*^9, 3.7329742410056467`*^9}, 3.732974278238517*^9, {
   3.7329743497072287`*^9, 3.7329743986938963`*^9}, {3.732975280109962*^9, 
   3.732975340732807*^9}, {3.732975443996851*^9, 3.732975511175679*^9}, {
   3.732975617720545*^9, 3.732975618960536*^9}, {3.7329757659111834`*^9, 
   3.732975826450919*^9}, {3.732976127826898*^9, 3.7329761905475597`*^9}, {
   3.732976408778714*^9, 3.7329764135262747`*^9}, {3.7329764781054497`*^9, 
   3.732976490556306*^9}, {3.732976594358453*^9, 3.732976601351533*^9}, {
   3.7329781807604094`*^9, 3.732978186385721*^9}, {3.732978289620611*^9, 
   3.732978308233391*^9}, {3.7329785000837708`*^9, 3.7329785060958977`*^9}, {
   3.732978571732277*^9, 3.732978575159197*^9}, {3.732978744166198*^9, 
   3.732978769075718*^9}, {3.732978805708539*^9, 3.732978866854314*^9}, {
   3.732986234380019*^9, 3.732986235630916*^9}, {3.732986269887087*^9, 
   3.732986315845764*^9}, 3.732986440197185*^9, {3.7329864717463923`*^9, 
   3.732986509294257*^9}, {3.732986778419056*^9, 3.732986812471532*^9}, {
   3.7329868575940723`*^9, 3.73298686237047*^9}, {3.732986936813566*^9, 
   3.732987015889592*^9}, {3.732987641441877*^9, 3.732987672151244*^9}, {
   3.732988314755776*^9, 3.732988407359716*^9}, {3.732992851563038*^9, 
   3.7329928592062187`*^9}, {3.732994063423956*^9, 3.732994117559099*^9}, {
   3.732994570266694*^9, 3.732994583163463*^9}, {3.73299469377363*^9, 
   3.732994699210587*^9}, {3.7329947394190063`*^9, 3.732994742874988*^9}, {
   3.733071262016165*^9, 3.733071270157156*^9}, {3.7330714850743847`*^9, 
   3.733071563833626*^9}, {3.7330734622294397`*^9, 3.7330735186273727`*^9}, {
   3.733073729282876*^9, 3.7330737608412848`*^9}, 3.733169206923683*^9, {
   3.7335233088329144`*^9, 3.733523309426903*^9}, {3.73352362789248*^9, 
   3.73352362856034*^9}, {3.733524795761491*^9, 3.733524796121278*^9}, {
   3.7335252140619802`*^9, 3.7335252217079678`*^9}, {3.733525584267128*^9, 
   3.733525681772966*^9}, 3.733526171688204*^9, 3.733526304008156*^9, 
   3.733526463370901*^9, {3.733527091076243*^9, 3.733527097641474*^9}, {
   3.733539934823739*^9, 3.7335399773576317`*^9}, {3.7335400413774433`*^9, 
   3.7335400697682943`*^9}, {3.733580032045431*^9, 3.733580121628709*^9}, 
   3.733580153452415*^9, {3.7335813405652227`*^9, 3.733581437247617*^9}, {
   3.733581682438512*^9, 3.733581686342469*^9}, {3.733581720503249*^9, 
   3.73358173786865*^9}, {3.733581804197515*^9, 3.7335818287569036`*^9}, {
   3.733581859794587*^9, 3.733581884356617*^9}, {3.733581927633657*^9, 
   3.733581930226996*^9}, {3.733581969823296*^9, 3.733582054015933*^9}, {
   3.733582639515339*^9, 3.733582641572007*^9}, {3.733582684276441*^9, 
   3.733582750335287*^9}, {3.733582785567206*^9, 3.73358287435598*^9}, {
   3.733584600930997*^9, 3.733584607194882*^9}, {3.733584714054255*^9, 
   3.733584716356299*^9}, {3.73358506776369*^9, 3.733585092481868*^9}, 
   3.733585448128916*^9, 3.733585497874857*^9, {3.7335855472924137`*^9, 
   3.733585577019393*^9}, {3.7335857627448883`*^9, 3.733585800406435*^9}, {
   3.7335860334726133`*^9, 3.7335861079667664`*^9}, {3.733586175079207*^9, 
   3.733586188616827*^9}, {3.733586244151793*^9, 3.73358626744171*^9}, {
   3.733586550540979*^9, 3.7335866068478203`*^9}, {3.7335866390357103`*^9, 
   3.733586664931033*^9}, {3.733586714172065*^9, 3.7335868153162823`*^9}, {
   3.733586974376109*^9, 3.733586974627686*^9}, 3.733588072743037*^9, {
   3.7336019045417213`*^9, 3.733601905303759*^9}, {3.7336206136293364`*^9, 
   3.7336206193441687`*^9}, {3.733621024353992*^9, 3.7336210517205133`*^9}, {
   3.733669699076766*^9, 3.733669752368237*^9}, {3.733669783903408*^9, 
   3.733669788953875*^9}, {3.7336699762465467`*^9, 3.733670048856525*^9}, {
   3.7336701335704603`*^9, 3.733670141827681*^9}, {3.733670882390532*^9, 
   3.7336710292956944`*^9}, {3.73367124841921*^9, 3.7336712807891417`*^9}, {
   3.733672555488739*^9, 3.733672586877502*^9}, {3.733672921850686*^9, 
   3.733673008619944*^9}, {3.7336730598959627`*^9, 3.7336730615052643`*^9}, {
   3.7336730938064337`*^9, 3.7336730994558992`*^9}, {3.733675371695413*^9, 
   3.7336754827263823`*^9}, {3.7336761723595953`*^9, 
   3.7336761874767838`*^9}, {3.733676226896441*^9, 3.733676227231368*^9}, 
   3.7336762932643337`*^9, {3.7336764360894136`*^9, 3.733676462987051*^9}, {
   3.733676654228499*^9, 3.733676655555245*^9}, {3.733676781291296*^9, 
   3.733676842221814*^9}, {3.7336770016928387`*^9, 3.7336771667108192`*^9}, 
   3.73367722337584*^9, {3.7336772607324057`*^9, 3.7336772632865057`*^9}, {
   3.733677393485457*^9, 3.733677418702405*^9}, {3.7336774792091703`*^9, 
   3.733677571764861*^9}, 3.733677616369994*^9, {3.733677657216261*^9, 
   3.733677670558032*^9}, {3.733677712087888*^9, 3.733677731217332*^9}, {
   3.7336784185058537`*^9, 3.733678451369204*^9}, {3.733678524648044*^9, 
   3.733678623411716*^9}, {3.733678715300603*^9, 3.7336787485152493`*^9}, {
   3.733678786818431*^9, 3.733678789098339*^9}, {3.733678832306197*^9, 
   3.7336788607933207`*^9}, {3.733688712406824*^9, 3.7336887125394707`*^9}, {
   3.733693090493923*^9, 3.733693097169958*^9}, {3.733693139136533*^9, 
   3.733693161138483*^9}, {3.733697474970674*^9, 3.733697565740472*^9}, {
   3.7336976485036077`*^9, 3.7336977247546387`*^9}, {3.73369775477815*^9, 
   3.733697858983171*^9}, 3.733698752852519*^9, {3.733711919122966*^9, 
   3.733712033602973*^9}, {3.733712142476025*^9, 3.73371215601793*^9}, {
   3.733712194644359*^9, 3.733712205317951*^9}, {3.733712410242655*^9, 
   3.7337124226400337`*^9}, {3.733840091140026*^9, 3.733840195195918*^9}, {
   3.733840237752372*^9, 3.733840250250374*^9}, {3.733840319598802*^9, 
   3.7338403582445498`*^9}, {3.733840397392871*^9, 3.7338404552781687`*^9}, {
   3.733840688229357*^9, 3.733840723278563*^9}, {3.73384079132439*^9, 
   3.733840791488686*^9}, {3.733840953527513*^9, 3.7338409689735107`*^9}, {
   3.7338410020657663`*^9, 3.733841071497875*^9}, {3.733841291839361*^9, 
   3.733841487710513*^9}, {3.733841560770466*^9, 3.733841562278227*^9}, {
   3.733842253577468*^9, 3.733842326858755*^9}, {3.733842373993767*^9, 
   3.733842403221422*^9}, {3.733852719154397*^9, 3.733852719855132*^9}, {
   3.733852852385244*^9, 3.733852869757676*^9}, {3.733854210801893*^9, 
   3.7338542758856897`*^9}, {3.733854359455984*^9, 3.7338543664343452`*^9}, 
   3.7338558767417173`*^9, {3.733855936522031*^9, 3.733856049895083*^9}, {
   3.733856081016286*^9, 3.733856145772255*^9}, 3.733857969472001*^9, {
   3.7338580539832287`*^9, 3.733858127782983*^9}, {3.7338581725775337`*^9, 
   3.733858304114077*^9}, {3.733858341065535*^9, 3.733858545854528*^9}, {
   3.73385903349981*^9, 3.733859036715982*^9}, {3.733877074842589*^9, 
   3.733877076248534*^9}, {3.7338771885352*^9, 3.733877192595757*^9}, {
   3.733877229237485*^9, 3.733877232295741*^9}, {3.7338776420395*^9, 
   3.733877661547361*^9}, {3.733877739334601*^9, 3.7338777402666063`*^9}, {
   3.733879387042007*^9, 3.733879414348316*^9}, {3.7339672498584433`*^9, 
   3.7339673046655493`*^9}, {3.73402356371062*^9, 3.73402356770019*^9}, {
   3.734023708136651*^9, 3.734023710750595*^9}, {3.7340238903443203`*^9, 
   3.7340238935148287`*^9}, {3.734024110417019*^9, 3.734024110752839*^9}, {
   3.7340245036924*^9, 3.734024711147957*^9}, {3.734030229005494*^9, 
   3.734030406068544*^9}, {3.734030442620573*^9, 3.734030456662874*^9}, {
   3.734030657291059*^9, 3.73403068034512*^9}, {3.734030882338685*^9, 
   3.734030886987094*^9}, {3.734031150862287*^9, 3.734031154991104*^9}, {
   3.734031189116404*^9, 3.734031196749164*^9}, {3.734031231800437*^9, 
   3.734031234085478*^9}, {3.7340313002582827`*^9, 3.734031306409092*^9}, {
   3.73403134806138*^9, 3.734031370079598*^9}, {3.734031443006906*^9, 
   3.73403146240981*^9}, {3.734031514290284*^9, 3.734031527778647*^9}, {
   3.734031618394594*^9, 3.73403162197003*^9}, {3.734031665887533*^9, 
   3.734031699044362*^9}, {3.734031740216502*^9, 3.734031786584784*^9}, {
   3.7340318240303926`*^9, 3.734031899010791*^9}, {3.7340329575265427`*^9, 
   3.734032968224812*^9}, {3.734033063800127*^9, 3.7340330673321953`*^9}, {
   3.734033114111987*^9, 3.734033158882132*^9}, {3.734033199067768*^9, 
   3.734033254847139*^9}, {3.734035004771326*^9, 3.734035048476191*^9}, {
   3.734035291331463*^9, 3.734035314116694*^9}, {3.734037345464484*^9, 
   3.734037435681094*^9}, {3.734037466606188*^9, 3.734037498229741*^9}, {
   3.734037557017335*^9, 3.734037558733577*^9}, {3.7340376222451277`*^9, 
   3.734037646054015*^9}, {3.734037694865665*^9, 3.734037728186798*^9}, 
   3.734037794450131*^9, {3.73403783023135*^9, 3.734037869263329*^9}, {
   3.734038097448037*^9, 3.734038105047957*^9}, {3.734038164043486*^9, 
   3.734038176019947*^9}, {3.734038464593*^9, 3.734038464972134*^9}, {
   3.73403850113256*^9, 3.734038537190089*^9}, {3.734038572244535*^9, 
   3.7340386489158983`*^9}, {3.7340387961618757`*^9, 3.734038861783283*^9}, {
   3.734038910402994*^9, 3.734038913425106*^9}, {3.7340391341577177`*^9, 
   3.7340391347845287`*^9}, {3.7340391747633533`*^9, 3.734039174922222*^9}, {
   3.734039271544156*^9, 3.7340393041820583`*^9}, {3.734039396109185*^9, 
   3.7340393965435867`*^9}, {3.7340394299324493`*^9, 3.734039430269527*^9}, {
   3.734056471256012*^9, 3.734056482887496*^9}, {3.734108907826023*^9, 
   3.7341089227366734`*^9}, {3.73413962721021*^9, 3.734139628347063*^9}, {
   3.734139698531764*^9, 3.734139744891881*^9}, {3.7341399261448793`*^9, 
   3.7341400191751547`*^9}, {3.734140118004689*^9, 3.734140121513126*^9}, {
   3.734140632137581*^9, 3.734140632713992*^9}, {3.734140903494321*^9, 
   3.73414090741297*^9}, {3.734140949191661*^9, 3.734141003867133*^9}, {
   3.734147348669187*^9, 3.734147355569417*^9}, {3.734147391867716*^9, 
   3.734147400977798*^9}, {3.734147443110043*^9, 3.7341474580540237`*^9}, {
   3.734147493527686*^9, 3.734147501496972*^9}, {3.734188446102886*^9, 
   3.734188450724017*^9}, {3.734188576599265*^9, 3.734188582673435*^9}, {
   3.734188622211691*^9, 3.7341886438921843`*^9}, {3.7341886916288843`*^9, 
   3.734188710253643*^9}, {3.7341893542820044`*^9, 3.734189355315675*^9}, {
   3.734210636503215*^9, 3.734210741856217*^9}, {3.734210969450945*^9, 
   3.7342110210210752`*^9}, {3.734211079707856*^9, 3.734211157430358*^9}, {
   3.734214225623418*^9, 3.7342142405478897`*^9}, {3.734214294908456*^9, 
   3.734214298283016*^9}, {3.7342143654675837`*^9, 3.734214365686014*^9}, {
   3.7342153449348373`*^9, 3.734215351088167*^9}, {3.7342154277597218`*^9, 
   3.7342154545046883`*^9}, {3.734215664995411*^9, 3.734215682294071*^9}, {
   3.734215747184712*^9, 3.734215748385208*^9}, {3.7342157952308817`*^9, 
   3.734215795535522*^9}, {3.734274435732127*^9, 3.73427448218687*^9}, {
   3.7342745406714087`*^9, 3.734274556427906*^9}, {3.734274990625436*^9, 
   3.734274991783163*^9}, {3.734276215609601*^9, 3.734276234499785*^9}, {
   3.734276364515594*^9, 3.7342763768166*^9}, {3.734276409839817*^9, 
   3.734276426324629*^9}, {3.7342820287414427`*^9, 3.734282058805512*^9}, {
   3.734282114732484*^9, 3.734282119865986*^9}, {3.734282182240958*^9, 
   3.7342822553612833`*^9}, {3.734283319508627*^9, 3.7342833309648952`*^9}, {
   3.734286856145506*^9, 3.734286874439314*^9}, {3.734288919988215*^9, 
   3.7342889384716883`*^9}, {3.734289081477953*^9, 3.734289083528413*^9}, {
   3.734289135010078*^9, 3.7342891444539013`*^9}, {3.734293095771418*^9, 
   3.7342931273060904`*^9}, {3.734530010413245*^9, 3.734530027482436*^9}, 
   3.734892518207178*^9, {3.734969161037169*^9, 3.734969161633851*^9}, {
   3.734972772092067*^9, 3.734972772580101*^9}, {3.734973117358954*^9, 
   3.734973117773056*^9}, {3.7349749078387423`*^9, 3.7349749211932507`*^9}, {
   3.734975908092991*^9, 3.73497591316818*^9}, {3.7349760112254477`*^9, 
   3.734976011778899*^9}, {3.73497619988389*^9, 3.73497620397626*^9}, {
   3.734976523392186*^9, 3.734976523565981*^9}, 3.7350630215811996`*^9, {
   3.735239982723688*^9, 3.735240021703841*^9}, {3.7352535564937897`*^9, 
   3.735253569134162*^9}, {3.735253628404776*^9, 3.735253672342433*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"3910e96f-8244-473b-938a-b403469393f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Input", "Section",
 CellChangeTimes->{{3.732732210052601*^9, 3.732732219292498*^9}, {
   3.7331692470144167`*^9, 3.733169248195539*^9}, 
   3.733169607436493*^9},ExpressionUUID->"ba452b1b-3762-41f2-91e4-\
7d42bc0a6dd5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"inhibitorconcentrations", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0.0", ",", 
      RowBox[{"{", "5", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"substrateconcentrations", "=", 
    RowBox[{"{", 
     RowBox[{"10.0", ",", "20.0", ",", "35.0", ",", "50.0", ",", "10.0"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"type", "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"parameters", " ", "for", " ", 
    RowBox[{"calculating", " ", "[", "E", "]"}], " ", "and", " ", "reading", 
    " ", "in", " ", "image", " ", "tiles", " ", "from", " ", "repository"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deviceID", "=", "\"\<d1\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"setup", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expDate", "=", "\"\<180531\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"experiment", "=", "\"\<PafA_GlyScan_MeP\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"substrateType", "=", "\"\<MeP\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"replicate", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eGFPslope", "=", "100000.0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "rootPath", "=", 
    "\"\</Users/craig/atlas/media/dmokhtari/Atlas-HDD/eMITOMI_Workup\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setupPath", "=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<Setup\>\"", ",", 
      RowBox[{"ToString", "[", "setup", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"repoPath", "=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "rootPath", ",", "setupPath", ",", "expDate", ",", "\"\<Repo\>\""}], 
        "}"}], "]"}], ",", "\"\</\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "exportPath", "=", 
    "\"\</Users/craig/atlas/media/dmokhtari/Atlas-HDD/eMITOMI_Processed/\>\""}\
], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outName", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"expDate", ",", "\"\<_S\>\"", ",", 
     RowBox[{"ToString", "[", "setup", "]"}], ",", "deviceID", ",", 
     "\"\<_\>\"", ",", "experiment"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.734964014733989*^9, 3.734964021925211*^9}, {
   3.734964052418363*^9, 3.734964086857307*^9}, {3.7349676756347847`*^9, 
   3.73496769605987*^9}, 3.7349680340611687`*^9, {3.734976718349825*^9, 
   3.734976718773717*^9}, {3.73506362784694*^9, 3.735063673714023*^9}, {
   3.735238315209505*^9, 3.735238331526716*^9}, {3.735248120428743*^9, 
   3.73524812072314*^9}, {3.7352514600752897`*^9, 3.7352514606503983`*^9}, {
   3.735579593244824*^9, 3.735579623515791*^9}, {3.735579666850457*^9, 
   3.735579669252502*^9}, {3.735585158739811*^9, 3.735585159582024*^9}, {
   3.735585247758215*^9, 3.7355852512740307`*^9}, {3.735587491358225*^9, 
   3.7355874933363123`*^9}, {3.7361819642838917`*^9, 3.736182001411949*^9}, {
   3.736182040812271*^9, 3.7361820433230743`*^9}, {3.736224593177724*^9, 
   3.736224593508443*^9}, {3.736707193635943*^9, 3.7367072005367317`*^9}, {
   3.736707335770254*^9, 3.7367073366776342`*^9}, {3.736737753950644*^9, 
   3.736737759535718*^9}, {3.736738054628145*^9, 3.736738054868475*^9}, {
   3.736989049138788*^9, 3.736989109998204*^9}, {3.736989213775238*^9, 
   3.73698921564515*^9}, {3.7370420223849688`*^9, 3.737042026438854*^9}, {
   3.7370421276698914`*^9, 3.7370421311364403`*^9}, {3.737052060907675*^9, 
   3.737052081001637*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"c302fd43-2b8c-4e60-afba-6a3c47888d9d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rates", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/craig/atlas/media/dmokhtari/Atlas-HDD/eMITOMI_Workup/\
Setup3/180531/Assays/MeP/Analysis/d1_10MeP_Rep1_RateAnalysis.csv\>\"", ",", 
        "\"\<Data\>\""}], "]"}], ",", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/craig/atlas/media/dmokhtari/Atlas-HDD/eMITOMI_Workup/\
Setup3/180531/Assays/MeP/Analysis/d1_20MeP_RateAnalysis.csv\>\"", ",", 
        "\"\<Data\>\""}], "]"}], ",", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/craig/atlas/media/dmokhtari/Atlas-HDD/eMITOMI_Workup/\
Setup3/180531/Assays/MeP/Analysis/d1_35MeP_RateAnalysis.csv\>\"", ",", 
        "\"\<Data\>\""}], "]"}], ",", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/craig/atlas/media/dmokhtari/Atlas-HDD/eMITOMI_Workup/\
Setup3/180531/Assays/MeP/Analysis/d1_50MeP_RateAnalysis.csv\>\"", ",", 
        "\"\<Data\>\""}], "]"}], ",", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/craig/atlas/media/dmokhtari/Atlas-HDD/eMITOMI_Workup/\
Setup3/180531/Assays/MeP/Analysis/d1_10MeP_RateAnalysis.csv\>\"", ",", 
        "\"\<Data\>\""}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "standardcurveinputfile", "=", 
    "\"\</Users/craig/atlas/media/dmokhtari/Atlas-HDD/eMITOMI_Workup/Setup3/\
180531/Assays/MeP/Analysis/D1_100ms_StandardCurveAnalysis_Results.csv\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"standardcurve", "=", 
    RowBox[{"importstandardcurve", "[", "standardcurveinputfile", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expectedTimeDelaysIN", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
     "\"\</Users/craig/Dropbox/craig_analysis_and_simulation_code/valine_scan_\
experiment_022318/Analysis/mePDelays.csv\>\"", ",", "\"\<Data\>\""}], "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expectedTimeDelays", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"expectedTimeDelaysIN", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"expectedTimeDelaysIN", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"AbsoluteTime", "[", 
         RowBox[{"StringDrop", "[", 
          RowBox[{
           RowBox[{"expectedTimeDelaysIN", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "6"}], "]"}], "]"}], ",", "7"}], "]"}], "]"}], 
        "-", 
        RowBox[{"AbsoluteTime", "[", "\"\<00:00:00.000000000\>\"", "]"}]}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "2", ",", 
       RowBox[{"Length", "[", "expectedTimeDelaysIN", "]"}]}], "}"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.719686981281328*^9, 3.7196870143732147`*^9}, {
   3.7196870619526043`*^9, 3.719687115845892*^9}, {3.719687574714863*^9, 
   3.719687590225253*^9}, {3.722298635950145*^9, 3.7222987203144913`*^9}, {
   3.7223008567285547`*^9, 3.722300869992189*^9}, {3.7223013454080267`*^9, 
   3.7223013609682426`*^9}, {3.722795325202532*^9, 3.7227953418066*^9}, {
   3.7227958453940487`*^9, 3.722795853800312*^9}, {3.72279588695693*^9, 
   3.722795896532625*^9}, {3.722795985773534*^9, 3.722795987361333*^9}, {
   3.7228058499185743`*^9, 3.722805851577468*^9}, {3.724447004393304*^9, 
   3.7244470341373997`*^9}, {3.724447300434081*^9, 3.72444730610441*^9}, {
   3.728125370586198*^9, 3.728125475262018*^9}, 3.728125532717168*^9, {
   3.728129872267164*^9, 3.7281298976600323`*^9}, {3.728241092209907*^9, 
   3.728241136404192*^9}, {3.728241463099566*^9, 3.728241481510487*^9}, {
   3.728241649213969*^9, 3.728241714391842*^9}, {3.7282418706141157`*^9, 
   3.728241936831512*^9}, {3.728832696757757*^9, 3.728832743669137*^9}, {
   3.728832979357912*^9, 3.7288330330920477`*^9}, {3.728833073126194*^9, 
   3.728833098362237*^9}, 3.728833150201289*^9, {3.7297256054733887`*^9, 
   3.72972567335534*^9}, {3.729725971087227*^9, 3.729725991519813*^9}, {
   3.7324658716702623`*^9, 3.7324658790014*^9}, {3.732465946749613*^9, 
   3.732465970777063*^9}, {3.7326467251495943`*^9, 3.732646733863511*^9}, 
   3.732646831615788*^9, {3.732646944726405*^9, 3.7326469705784616`*^9}, {
   3.732648125174499*^9, 3.7326481446111803`*^9}, {3.732648205743279*^9, 
   3.732648307844205*^9}, {3.732648504577067*^9, 3.732648524481887*^9}, {
   3.7326485800469913`*^9, 3.732648594654457*^9}, {3.7326486691301126`*^9, 
   3.732648697262788*^9}, {3.732648801961879*^9, 3.732648994625415*^9}, {
   3.732649392554352*^9, 3.7326494056335917`*^9}, 3.732649460788621*^9, {
   3.732649660408043*^9, 3.73264966365586*^9}, {3.7326496941398363`*^9, 
   3.732649697894216*^9}, {3.732649813779859*^9, 3.732649845586029*^9}, {
   3.732649878713727*^9, 3.732649881202785*^9}, {3.7326499287764273`*^9, 
   3.7326499452201347`*^9}, {3.7326500541898127`*^9, 
   3.7326500546409073`*^9}, {3.7326513713200083`*^9, 3.73265139945721*^9}, {
   3.7326517206194553`*^9, 3.732651721990458*^9}, {3.7327337077615223`*^9, 
   3.732733713329822*^9}, {3.732733858020467*^9, 3.732733864469529*^9}, {
   3.732734640252248*^9, 3.732734645394642*^9}, {3.732818000072907*^9, 
   3.732818083481278*^9}, {3.7328183711030493`*^9, 3.7328183810848427`*^9}, {
   3.7329124198125772`*^9, 3.732912422718884*^9}, {3.73291246787379*^9, 
   3.732912539155284*^9}, {3.7330705445479107`*^9, 3.733070678524457*^9}, {
   3.7331693083730927`*^9, 3.733169328011593*^9}, {3.733169363218368*^9, 
   3.733169377870604*^9}, {3.7331694666342382`*^9, 3.7331695360604067`*^9}, {
   3.7335194627508163`*^9, 3.733519526868702*^9}, {3.733520668211026*^9, 
   3.733520776272703*^9}, {3.733608878586123*^9, 3.73360888972289*^9}, {
   3.733668186030753*^9, 3.7336681973474493`*^9}, {3.73367490739804*^9, 
   3.733674908679576*^9}, {3.733674940423601*^9, 3.733674945607609*^9}, {
   3.7336789387455263`*^9, 3.7336789585890703`*^9}, {3.7336789989912157`*^9, 
   3.733679010400441*^9}, {3.7338603798710003`*^9, 3.733860497681521*^9}, {
   3.7340342439419813`*^9, 3.734034273427771*^9}, {3.734034307382618*^9, 
   3.734034321361485*^9}, 3.734034439983488*^9, {3.7340345189442863`*^9, 
   3.7340346189305573`*^9}, {3.734034752275317*^9, 3.73403494425093*^9}, {
   3.734188849599023*^9, 3.7341888678449802`*^9}, {3.734188906189155*^9, 
   3.734188967077825*^9}, {3.734196647676587*^9, 3.734196649483823*^9}, {
   3.734201316358087*^9, 3.734201319478313*^9}, {3.7342014375301743`*^9, 
   3.7342014734846087`*^9}, {3.734201509777323*^9, 3.734201560029715*^9}, 
   3.7342016133079567`*^9, {3.734201911033637*^9, 3.734201914380883*^9}, 
   3.73420195324163*^9, 3.734202561048195*^9, {3.734211744673091*^9, 
   3.734211744844627*^9}, {3.734211799180675*^9, 3.734211899477729*^9}, {
   3.734216097484249*^9, 3.734216104588684*^9}, {3.7342162100373*^9, 
   3.73421621021294*^9}, {3.7342751361057177`*^9, 3.734275142047041*^9}, {
   3.734282943736418*^9, 3.734283044519186*^9}, {3.7342880355093393`*^9, 
   3.73428804548411*^9}, {3.7342880884886*^9, 3.734288090663431*^9}, {
   3.734288144273013*^9, 3.734288234195674*^9}, {3.734288309756802*^9, 
   3.734288312080306*^9}, {3.73429215386412*^9, 3.734292232451767*^9}, {
   3.734363025683156*^9, 3.734363100052793*^9}, 3.734363142348414*^9, {
   3.734363992890905*^9, 3.7343640296234503`*^9}, {3.734407802461458*^9, 
   3.734407814232445*^9}, {3.7344079883757763`*^9, 3.734408040301859*^9}, {
   3.734429673518608*^9, 3.7344296913676777`*^9}, {3.734429751714628*^9, 
   3.734429752023541*^9}, {3.7345297131084948`*^9, 3.734529909729228*^9}, {
   3.73453011166396*^9, 3.734530113243692*^9}, 3.734530189452145*^9, {
   3.734531213528365*^9, 3.734531223437697*^9}, {3.734531279111516*^9, 
   3.734531311955874*^9}, {3.7345313488389606`*^9, 3.734531361901145*^9}, {
   3.734564021080226*^9, 3.734564165753985*^9}, {3.734564218074211*^9, 
   3.734564218973591*^9}, {3.7346255936226892`*^9, 3.734625608995781*^9}, {
   3.734625742888916*^9, 3.734625753337165*^9}, {3.73462578837831*^9, 
   3.734625849988392*^9}, {3.734627560933373*^9, 3.7346275714064207`*^9}, {
   3.734627614785612*^9, 3.734627724850898*^9}, {3.734627798728932*^9, 
   3.7346277994277287`*^9}, {3.734701373569454*^9, 3.7347015051031513`*^9}, {
   3.734701542583242*^9, 3.7347015483751802`*^9}, {3.734963989668551*^9, 
   3.7349640058097897`*^9}, {3.734964084385892*^9, 3.734964085224422*^9}, {
   3.734967596024148*^9, 3.7349676321595097`*^9}, {3.734967671572461*^9, 
   3.734967690971408*^9}, {3.7349767138472347`*^9, 3.734976717103578*^9}, {
   3.73506368218574*^9, 3.7350637765954323`*^9}, {3.735248118266777*^9, 
   3.7352481193997507`*^9}, {3.73557967985233*^9, 3.7355797132357264`*^9}, {
   3.7355852681466427`*^9, 3.735585281379787*^9}, {3.735587498474905*^9, 
   3.735587510402534*^9}, {3.7361821731917048`*^9, 3.736182214580009*^9}, {
   3.7361822532456703`*^9, 3.736182260663166*^9}, {3.736183113573625*^9, 
   3.736183140791787*^9}, {3.7362247460754547`*^9, 3.736224770908342*^9}, {
   3.736224859527961*^9, 3.7362248771948338`*^9}, {3.736707144428987*^9, 
   3.7367071917731943`*^9}, {3.736707307213275*^9, 3.736707317666621*^9}, {
   3.736737833728593*^9, 3.736737895649665*^9}, {3.736738028543518*^9, 
   3.7367380628862658`*^9}, {3.73698925301647*^9, 3.736989319357328*^9}, {
   3.73704211936248*^9, 3.737042119693857*^9}, {3.737052138183648*^9, 
   3.737052167527493*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"bc4ea9a4-2bd6-45db-834f-23c53e78f053"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analysis", "Section",
 CellChangeTimes->{{3.732732210052601*^9, 3.732732219292498*^9}, {
  3.7331692470144167`*^9, 3.733169248195539*^9}, {3.73316960366033*^9, 
  3.733169606101077*^9}},ExpressionUUID->"46e27fd9-8d24-4613-b1a0-\
27d6bce139d6"],

Cell[CellGroupData[{

Cell["\<\
Generate the initial Dataset or import a saved Dataset in which to append \
additional analyses:\
\>", "Subsubsection",
 CellChangeTimes->{{3.732981294756315*^9, 3.732981301817131*^9}, {
  3.734963641059845*^9, 3.734963655470152*^9}, {3.7349637316623917`*^9, 
  3.7349637552439127`*^9}},ExpressionUUID->"eb4fc38c-b472-4b23-b4ea-\
71356699cde5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"keys", "=", 
    RowBox[{"rates", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"assayDataSet", "=", 
    RowBox[{"Dataset", "[", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"keys", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], "\[Rule]", 
                  RowBox[{"replaceBrackets", "[", 
                   RowBox[{"rates", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"i", "+", "1"}], ",", "n"}], "]"}], "]"}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", "1", ",", 
                  RowBox[{"Length", "[", "keys", "]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<GlobalExperimentIndex\>\"", "\[Rule]", 
                  RowBox[{"StringJoin", "[", 
                   RowBox[{"expDate", ",", "\"\<_S\>\"", ",", 
                    RowBox[{"ToString", "[", "setup", "]"}], ",", "\"\<_\>\"",
                     ",", "deviceID", ",", "\"\<_\>\"", ",", "substrateType", 
                    ",", "\"\<_\>\"", ",", 
                    RowBox[{"ToString", "[", "replicate", "]"}]}], "]"}]}], 
                 ",", 
                 RowBox[{"\"\<ExpIndex\>\"", "\[Rule]", "m"}], ",", 
                 RowBox[{"\"\<Date\>\"", "\[Rule]", "expDate"}], ",", 
                 RowBox[{"\"\<Experiment\>\"", "\[Rule]", "experiment"}], ",", 
                 RowBox[{"\"\<Setup\>\"", "\[Rule]", "setup"}], ",", 
                 RowBox[{"\"\<Device\>\"", "\[Rule]", "deviceID"}], ",", 
                 RowBox[{"\"\<AssayType\>\"", "\[Rule]", 
                  RowBox[{"type", "[", 
                   RowBox[{"[", "m", "]"}], "]"}]}], ",", 
                 RowBox[{"\"\<SubstrateConc\>\"", "\[Rule]", 
                  RowBox[{"substrateconcentrations", "[", 
                   RowBox[{"[", "m", "]"}], "]"}]}], ",", 
                 RowBox[{"\"\<InhibitorConcentration\>\"", "\[Rule]", 
                  RowBox[{"inhibitorconcentrations", "[", 
                   RowBox[{"[", "m", "]"}], "]"}]}], ",", 
                 RowBox[{"\"\<eGFPSlope\>\"", "->", "eGFPslope"}]}], "}"}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<StdCurveSlope\>\"", "\[Rule]", 
                RowBox[{"replaceBrackets", "[", 
                 RowBox[{"standardcurve", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<StdCurveIntercept\>\"", "->", 
                RowBox[{"standardcurve", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "4"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<StdCurveData\>\"", "\[Rule]", 
                RowBox[{"standardcurve", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "5"}], "]"}], "]"}]}]}], "}"}], "}"}]}], 
           "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", 
           RowBox[{"Length", "[", "substrateconcentrations", "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "1568"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"assayDataSetWorking", "=", 
    RowBox[{
    "Import", "[", 
     "\"\</Users/craig/atlas/media/dmokhtari/Atlas-HDD/eMITOMI_Processed/mx_\
format_files/180402_S2d2_MeP_titration_series_50uMpointDropped_reprocessed.mx\
\>\"", "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.732733742235869*^9, 3.732733810785824*^9}, {
   3.732733877909441*^9, 3.7327338942128*^9}, {3.7327339879235992`*^9, 
   3.732734003754887*^9}, {3.732734388263599*^9, 3.732734411338696*^9}, {
   3.732734555760565*^9, 3.7327346187711763`*^9}, {3.7327347758715773`*^9, 
   3.732734806873704*^9}, {3.7327348459740467`*^9, 3.732734854516893*^9}, {
   3.732818508195798*^9, 3.732818541269745*^9}, {3.732819814248485*^9, 
   3.732819851400675*^9}, {3.7329125613809423`*^9, 3.73291257157535*^9}, 
   3.732981305135995*^9, 3.733519568541795*^9, {3.733520135696691*^9, 
   3.733520153053665*^9}, 3.733534771213159*^9, 3.733677780138608*^9, {
   3.733678964971322*^9, 3.733679020660479*^9}, {3.733860529209201*^9, 
   3.733860534267825*^9}, {3.733860656584486*^9, 3.733860657546772*^9}, {
   3.73414013232673*^9, 3.734140145665807*^9}, {3.734188949090075*^9, 
   3.734188949464633*^9}, {3.734211937767874*^9, 3.7342119449306107`*^9}, {
   3.734530219556903*^9, 3.734530245397016*^9}, 3.734531421756034*^9, 
   3.734531513755706*^9, {3.7345642298064833`*^9, 3.7345642372417393`*^9}, {
   3.7349636590723877`*^9, 3.734963695431684*^9}, {3.735063785005704*^9, 
   3.73506379138988*^9}, {3.735237985905282*^9, 3.73523802654568*^9}, {
   3.735253712909093*^9, 3.7352537186092577`*^9}, {3.736182404259791*^9, 
   3.7361824051608953`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"1ba4cf3e-134b-4920-8d7d-da19aaefba58"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Prepend a global experimental index in order to concatenate full datasets in \
later stages of analysis:\
\>", "Subsubsection",
 CellChangeTimes->{{3.735238177189847*^9, 
  3.735238194367365*^9}},ExpressionUUID->"90a02fae-a082-4e0b-aaf6-\
3e6c65bea02b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"assayDataset", "=", 
   RowBox[{"assayDataSet", "[", 
    RowBox[{"All", ",", 
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<GlobalExperimentIndex\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"expDate", ",", "\"\<_S\>\"", ",", 
            RowBox[{"ToString", "[", "setup", "]"}], ",", "\"\<_\>\"", ",", 
            "deviceID", ",", "\"\<_\>\"", ",", "substrateType", ",", 
            "\"\<_\>\"", ",", 
            RowBox[{"ToString", "[", "replicate", "]"}]}], "]"}]}], "}"}]}], 
       "]"}], "&"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.735238209269184*^9, 3.735238231450396*^9}, {
  3.735238263157218*^9, 3.735238302441058*^9}, {3.735238339385621*^9, 
  3.735238392847331*^9}, {3.735238440518774*^9, 3.735238446590693*^9}, {
  3.735253730388112*^9, 3.735253737515945*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"020e7c04-ccbf-48e6-ac02-7e810e3b4931"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate and add standard curve plots:", "Subsubsection",
 CellChangeTimes->{{3.732982122369422*^9, 3.73298212984267*^9}, {
  3.7335198368618307`*^9, 3.733519840007523*^9}, {3.733520332191161*^9, 
  3.7335203379182167`*^9}, {3.7335221789957314`*^9, 3.733522179567046*^9}, {
  3.733523573728622*^9, 
  3.733523582310413*^9}},ExpressionUUID->"fdcbc86f-9ea8-4ab0-aac9-\
25db2a59b58d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"withStdCurvePlot", "=", 
    RowBox[{"assayDataSet", "[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<StandardCurvePlot\>\"", "\[Rule]", 
           RowBox[{"Quiet", "[", 
            RowBox[{"makePBPcurvePlot", "[", 
             RowBox[{"#StdCurveSlope", ",", "#StdCurveData"}], "]"}], "]"}]}],
           "}"}]}], "]"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"withStdCurvePlot", "=", 
     RowBox[{"assayDataSet", "[", 
      RowBox[{"All", ",", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<StandardCurvePlot\>\"", "\[Rule]", 
            RowBox[{"Quiet", "[", 
             RowBox[{"makeStdCurvePlot", "[", 
              RowBox[{
              "#StdCurveSlope", ",", "#StdCurveIntercept", ",", 
               "#StdCurveData"}], "]"}], "]"}]}], "}"}]}], "]"}], "&"}]}], 
      "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}]}], "Input",
 CellChangeTimes->{{3.733523597976165*^9, 3.7335236150715837`*^9}, {
   3.733523648389865*^9, 3.733523734840747*^9}, {3.733535894563966*^9, 
   3.733535895351377*^9}, {3.734102877683872*^9, 3.734102889967964*^9}, {
   3.734103080475646*^9, 3.734103080797895*^9}, {3.734274751749447*^9, 
   3.7342747533398943`*^9}, {3.7342752728395576`*^9, 3.73427528819278*^9}, 
   3.734275476991047*^9, {3.734283094546897*^9, 3.734283100094578*^9}, {
   3.7342883494889393`*^9, 3.734288355678158*^9}, {3.7345301689225607`*^9, 
   3.7345301739354563`*^9}, {3.73523842968882*^9, 3.735238455546618*^9}, {
   3.736182447615982*^9, 3.73618245522029*^9}, {3.7369893404243193`*^9, 
   3.736989344887883*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"24a33a3f-3bbb-47aa-835d-506a68ef003a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\[OpenCurlyDoubleQuote]Walk\[CloseCurlyDoubleQuote] the progress curves, \
fitting by adding additional points:\
\>", "Subsubsection",
 CellChangeTimes->{{3.732981420007461*^9, 
  3.732981435969029*^9}},ExpressionUUID->"71f596cf-7b6c-420d-81ae-\
6efee26753b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"assayDataSetNew", "=", 
    RowBox[{"withStdCurvePlot", "[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"\"\<LinFitsAddingPoints (uM/s)\>\"", "\[Rule]", 
          RowBox[{"linearFitWalkingProgressCurve", "[", 
           RowBox[{"#Times", ",", 
            RowBox[{"#", "[", "\"\<TurnoverData (uM)\>\"", "]"}]}], "]"}]}]}],
         "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"assayDataSetNew2", "=", 
   RowBox[{"assayDataSetNew", "[", 
    RowBox[{"All", ",", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\"\<LinFitsAddingPoints (RFU/s)\>\"", "\[Rule]", 
         RowBox[{"linearFitWalkingProgressCurve", "[", 
          RowBox[{"#Times", ",", "#MedianIntensities"}], "]"}]}]}], "]"}], 
      "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.732819865366827*^9, 3.732819937165308*^9}, {
   3.732820052999302*^9, 3.732820059633494*^9}, {3.732820113745331*^9, 
   3.73282012040818*^9}, {3.7328217935315313`*^9, 3.732821841518342*^9}, {
   3.732821898662826*^9, 3.732821899076359*^9}, {3.732821950546376*^9, 
   3.73282195470468*^9}, {3.732830794899547*^9, 3.73283079578308*^9}, {
   3.73307085559181*^9, 3.7330708561754417`*^9}, {3.733071019956319*^9, 
   3.7330710927413588`*^9}, {3.7330711793015003`*^9, 3.733071234155797*^9}, {
   3.733071288646563*^9, 3.7330712950440207`*^9}, {3.733071550299336*^9, 
   3.733071550581236*^9}, {3.73351958914775*^9, 3.73351958988904*^9}, {
   3.733519734839047*^9, 3.733519747112032*^9}, {3.733520829706312*^9, 
   3.733520856225848*^9}, 3.733535981488503*^9, 3.733677806359264*^9, 
   3.734211977436246*^9, 3.7342760182931423`*^9, 3.7342883782341747`*^9, {
   3.7343619718273706`*^9, 3.7343619726472683`*^9}, 3.734408362246622*^9, {
   3.7345302700322027`*^9, 3.734530273040141*^9}, {3.734564247345327*^9, 
   3.734564248117839*^9}, 3.735253750251443*^9, {3.736989400856913*^9, 
   3.736989402488242*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"4c211c7a-e762-49ad-bb87-c165bf8ea733"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Do optimized fit (<30% || default to 2-point) on progress curves:\
\>", "Subsubsection",
 CellChangeTimes->{{3.733841886251356*^9, 
  3.7338419278901157`*^9}},ExpressionUUID->"83393b69-ef95-427b-bfe9-\
34cc7352c217"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"optDataPoints", "=", 
    RowBox[{"assayDataSetNew2", "[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"\"\<DataPointsOptLinFit\>\"", "\[Rule]", 
          RowBox[{"optimizeLinFitPBP", "[", 
           RowBox[{"#Times", ",", 
            RowBox[{"#", "[", "\"\<TurnoverData (uM)\>\"", "]"}], ",", 
            "#SubstrateConc", ",", "30.0", ",", "0.30"}], "]"}]}]}], "]"}], 
       "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"optDataPoints", "=", 
     RowBox[{"assayDataSetNew2", "[", 
      RowBox[{"All", ",", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"\"\<DataPointsOptLinFit\>\"", "\[Rule]", 
           RowBox[{"optimizeLinFit", "[", 
            RowBox[{"#Times", ",", 
             RowBox[{"#", "[", "\"\<TurnoverTimepoints(uM)\>\"", "]"}], ",", 
             "#SubstrateConc", ",", "#StdCurveSlope", ",", 
             "#StdCurveIntercept", ",", "0.30"}], "]"}]}]}], "]"}], "&"}]}], 
      "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"optDataPoints2", "=", 
    RowBox[{"optDataPoints", "[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"fitOptimized", "[", "#DataPointsOptLinFit", "]"}]}], "]"}], 
       "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}]}], "Input",
 CellChangeTimes->{{3.733841968135112*^9, 3.7338419930870333`*^9}, {
   3.733842033581826*^9, 3.733842088548485*^9}, {3.733842126506892*^9, 
   3.733842126795927*^9}, {3.73384217722064*^9, 3.7338422032433777`*^9}, {
   3.733842439552656*^9, 3.733842448762781*^9}, {3.7338430560800056`*^9, 
   3.733843070734223*^9}, {3.734030709962677*^9, 3.734030710970731*^9}, {
   3.734102015812273*^9, 3.734102073329945*^9}, {3.734102128345435*^9, 
   3.7341021291108837`*^9}, 3.734103100229019*^9, {3.734104186016677*^9, 
   3.7341041927509747`*^9}, {3.734140198097604*^9, 3.734140198531053*^9}, {
   3.7341891639313793`*^9, 3.7341892130582113`*^9}, {3.734189371875873*^9, 
   3.734189375915504*^9}, {3.734212005423595*^9, 3.734212005841793*^9}, {
   3.734212239193623*^9, 3.7342122451551113`*^9}, {3.7342122814627333`*^9, 
   3.7342122857772293`*^9}, {3.734212400175596*^9, 3.7342124005880833`*^9}, 
   3.734276031860869*^9, 3.734276065858754*^9, {3.734283180126869*^9, 
   3.7342831924214287`*^9}, 3.734288009980249*^9, {3.734288390453318*^9, 
   3.734288396013752*^9}, {3.734289034267872*^9, 3.734289034715716*^9}, 
   3.734292490568884*^9, {3.734530207641334*^9, 3.734530212563863*^9}, {
   3.7345642647577477`*^9, 3.734564266926696*^9}, {3.735063828522564*^9, 
   3.735063846247608*^9}, 3.73525375765287*^9, 3.735579770194434*^9, {
   3.736183302701256*^9, 3.736183309563961*^9}, {3.7369893538904457`*^9, 
   3.736989359498473*^9}, {3.736989859775029*^9, 3.736989863758395*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"a8b62022-0b11-421c-8c76-1a28082b915a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exponential fits (cMUP):", "Subsubsection",
 CellChangeTimes->{{3.732982122369422*^9, 3.73298212984267*^9}, {
  3.7335198368618307`*^9, 3.733519840007523*^9}, {3.733520332191161*^9, 
  3.7335203379182167`*^9}, {3.7335221789957314`*^9, 3.733522179567046*^9}, {
  3.733523573728622*^9, 3.733523582310413*^9}, {3.733524831539154*^9, 
  3.733524841053845*^9}},ExpressionUUID->"3fd01350-f90b-405e-8382-\
cca5f2b27724"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addExpFits", "=", 
    RowBox[{"optDataPoints2", "[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<ExponentialFit\>\"", "\[Rule]", 
           RowBox[{"Quiet", "[", 
            RowBox[{"exponentialFitPBP", "[", 
             RowBox[{"#Times", ",", 
              RowBox[{"#", "[", "\"\<TurnoverData (uM)\>\"", "]"}], ",", 
              "#SubstrateConc", ",", "30.0"}], "]"}], "]"}]}], "}"}]}], "]"}],
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"addExpFits", "=", 
     RowBox[{"optDataPoints2", "[", 
      RowBox[{"All", ",", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<ExponentialFit\>\"", "\[Rule]", 
            RowBox[{"Quiet", "[", 
             RowBox[{"exponentialFit", "[", 
              RowBox[{"#Times", ",", 
               RowBox[{"#", "[", "\"\<TurnoverTimepoints(uM)\>\"", "]"}], ",",
                "#SubstrateConc", ",", "#StdCurveSlope", ",", 
               "#StdCurveIntercept"}], "]"}], "]"}]}], "}"}]}], "]"}], 
        "&"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "exportPath", ",", "outName", ",", "\"\<_working_2\>\"", ",", 
       "\"\<.mx\>\""}], "]"}], ",", "addExpFits"}], "]"}], "*)"}]}]}], "Input",\

 CellChangeTimes->{{3.733524825015667*^9, 3.733524950254587*^9}, 
   3.733525107959381*^9, {3.733525257256226*^9, 3.733525258393737*^9}, {
   3.733536591044949*^9, 3.733536601994522*^9}, {3.733536758149169*^9, 
   3.7335367851824083`*^9}, {3.733539610003603*^9, 3.733539614459094*^9}, {
   3.733539659887191*^9, 3.733539661760502*^9}, {3.7335396974774237`*^9, 
   3.73353969782694*^9}, {3.733539762363942*^9, 3.733539817446825*^9}, {
   3.733540087630085*^9, 3.733540088778327*^9}, {3.733678164022956*^9, 
   3.733678167798142*^9}, 3.73384386503576*^9, {3.734102711065818*^9, 
   3.734102724145734*^9}, {3.73410284059282*^9, 3.734102870783929*^9}, {
   3.734104231858851*^9, 3.734104252088538*^9}, {3.734104305723729*^9, 
   3.734104306071257*^9}, {3.73420264292292*^9, 3.734202648379595*^9}, {
   3.734212070007834*^9, 3.734212071075952*^9}, {3.734212180158289*^9, 
   3.734212219947329*^9}, {3.7342123397240477`*^9, 3.7342123451596518`*^9}, {
   3.734276157500095*^9, 3.7342761598484697`*^9}, {3.734276438094433*^9, 
   3.734276448496091*^9}, {3.734283225339991*^9, 3.734283233963277*^9}, {
   3.7342886958442574`*^9, 3.73428870172959*^9}, {3.734288963434135*^9, 
   3.7342889702029676`*^9}, {3.734289165564324*^9, 3.7342891660826063`*^9}, {
   3.734292759640684*^9, 3.734292761781427*^9}, {3.734292803266699*^9, 
   3.7342928955532293`*^9}, {3.7342931514839687`*^9, 3.734293151756518*^9}, {
   3.73453028772528*^9, 3.734530292525387*^9}, {3.735063862118473*^9, 
   3.735063867986094*^9}, {3.736183321701795*^9, 3.7361833262571907`*^9}, {
   3.7369894160467033`*^9, 3.736989420875956*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"8fbc1de9-211a-4c72-a4c2-8e0fda11c9d3"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{
    "exportPath", ",", "outName", ",", "\"\<_working_1\>\"", ",", 
     "\"\<.mx\>\""}], "]"}], ",", "addExpFits"}], "]"}]], "Input",
 CellChangeTimes->{{3.734530346101818*^9, 3.734530349548806*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"915a79b7-c4c1-4219-aaab-395fd1587fee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Generate progress curve plots based on optimized fitting (intensities):\
\>", "Subsubsection",
 CellChangeTimes->{{3.732982122369422*^9, 3.73298212984267*^9}, {
  3.7335198368618307`*^9, 3.733519840007523*^9}, {3.733520332191161*^9, 
  3.7335203379182167`*^9}, {3.7338438233932753`*^9, 
  3.733843827234573*^9}},ExpressionUUID->"b5a10a85-42c8-40e5-a998-\
bbd7c06e8165"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"withPCs", "=", 
    RowBox[{"addExpFits", "[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<ProgressCurveOptFit\>\"", "\[Rule]", 
           RowBox[{"Quiet", "[", 
            RowBox[{"makeProgressCurvePlotPBP", "[", 
             RowBox[{"#Times", ",", 
              RowBox[{"#", "[", "\"\<TurnoverData (uM)\>\"", "]"}], ",", 
              "#OptLinFitSlope", ",", 
              RowBox[{"#", "[", "\"\<OptLinFitIntercept\>\"", "]"}], ",", 
              "#DataPointsOptLinFit", ",", "#SubstrateConc", ",", "30.0", ",",
               "1", ",", 
              RowBox[{"#ExponentialFit", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
        "]"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"withPCs", "=", 
     RowBox[{"addExpFits", "[", 
      RowBox[{"All", ",", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<ProgressCurveOptFit\>\"", "\[Rule]", 
            RowBox[{"Quiet", "[", 
             RowBox[{"makeProgressCurvePlot", "[", 
              RowBox[{"#Times", ",", 
               RowBox[{"#", "[", "\"\<TurnoverTimepoints(uM)\>\"", "]"}], ",",
                "#OptLinFitSlope", ",", 
               RowBox[{"#", "[", "\"\<OptLinFitIntercept\>\"", "]"}], ",", 
               "#DataPointsOptLinFit", ",", "#SubstrateConc", ",", 
               RowBox[{"#ExponentialFit", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
         "]"}], "&"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{
    "exportPath", ",", "outName", ",", "\"\<_working_1\>\"", ",", 
     "\"\<.mx\>\""}], "]"}], ",", "withPCs"}], "]"}]}], "Input",
 CellChangeTimes->{{3.733541568598658*^9, 3.733541578722908*^9}, {
   3.733579179116023*^9, 3.7335791887902737`*^9}, {3.7336737322524643`*^9, 
   3.733673734302352*^9}, {3.7336788891131077`*^9, 3.733678890793058*^9}, {
   3.7338446494024277`*^9, 3.73384468457856*^9}, 3.733844885891556*^9, {
   3.733844926540389*^9, 3.733844926818028*^9}, {3.733844987807495*^9, 
   3.733844988903393*^9}, {3.7341027584405212`*^9, 3.734102767097084*^9}, {
   3.734202662253459*^9, 3.7342026670200987`*^9}, {3.734277628838805*^9, 
   3.734277641249401*^9}, 3.7342776784205*^9, {3.734277780926309*^9, 
   3.734277800918448*^9}, {3.7342832397961283`*^9, 3.734283248826251*^9}, 
   3.734410047243732*^9, {3.7344102411783247`*^9, 3.734410247044869*^9}, {
   3.734530316718239*^9, 3.734530336548972*^9}, {3.734537528780539*^9, 
   3.7345375290217113`*^9}, {3.7350686519557257`*^9, 
   3.7350686573690853`*^9}, {3.735238736409395*^9, 3.73523873917117*^9}, {
   3.735240053307671*^9, 3.735240058254054*^9}, 3.7352537761896343`*^9, {
   3.736183340066271*^9, 3.736183361974292*^9}, {3.736989429372794*^9, 
   3.736989437144968*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"179ae7d0-b320-4a9e-9721-ee7c827c970b"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{
    "exportPath", ",", "outName", ",", "\"\<_working_2\>\"", ",", 
     "\"\<.mx\>\""}], "]"}], ",", "withPCs"}], "]"}]], "Input",
 CellChangeTimes->{{3.734531622991921*^9, 3.7345316230977907`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"2b43163e-163c-471c-b2fb-26fb2703a01a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculate local background and associated plot, append to the dataset:\
\>", "Subsubsection",
 CellChangeTimes->{{3.733588097841146*^9, 3.733588102836062*^9}, {
  3.7335978406785727`*^9, 
  3.7335978498768272`*^9}},ExpressionUUID->"0ec943ab-e138-4783-8a7e-\
21fdc19d6b49"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"datasetIN", "=", "withPCs"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mutantList", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<T79G\>\"", ",", "\"\<Skipped\>\"", ",", "\"\<K162A\>\""}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataset2", "=", "datasetIN"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interpolations", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Association", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<XIndex\>\"", "\[Rule]", "column"}], ",", 
           RowBox[{"\"\<ExpIndex\>\"", "\[Rule]", "n"}], ",", 
           RowBox[{"\"\<AssayType\>\"", "\[Rule]", 
            RowBox[{"type", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Interpolation\>\"", "->", 
            RowBox[{"interpolateDeadMutantsPerColumn", "[", 
             RowBox[{
             "mutantList", ",", "n", ",", "column", ",", "dataset2", ",", 
              "\"\<Rate (uM/s)\>\""}], "]"}]}], ",", 
           RowBox[{
           "\"\<MutantsUsedForLocalBG\>\"", "\[Rule]", "mutantList"}]}], 
          "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "substrateconcentrations", "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"column", ",", "1", ",", "28"}], "}"}]}], "]"}], ",", "1"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataset3", "=", 
    RowBox[{"Dataset", "[", 
     RowBox[{"JoinAcross", "[", 
      RowBox[{
       RowBox[{"Normal", "[", "dataset2", "]"}], ",", "interpolations", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<XIndex\>\"", ",", "\"\<ExpIndex\>\"", ",", "\"\<AssayType\>\""}],
         "}"}], ",", "\"\<Left\>\""}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"dataset3", "=", 
    RowBox[{"dataset2", "[", 
     RowBox[{
      RowBox[{"1", ";;", "10"}], ",", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<BackgroundInterpolation\>\"", "\[Rule]", 
           RowBox[{"Quiet", "[", 
            RowBox[{"interpolateDeadMutantsPerColumn", "[", 
             RowBox[{"mutantList", ",", "#SubstrateConc", ",", 
              RowBox[{"#Indices", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "dataset2", ",", 
              "\"\<Rate (uM/s)\>\""}], "]"}], "]"}]}], "}"}]}], "]"}], 
       "&"}]}], "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.73359786857764*^9, 3.733597939612916*^9}, {
   3.733597982541931*^9, 3.733597998571398*^9}, {3.7335980738075743`*^9, 
   3.733598100896803*^9}, {3.7335982346688538`*^9, 3.733598254978917*^9}, {
   3.733598322939097*^9, 3.733598350618823*^9}, {3.733598436187118*^9, 
   3.7335984566036673`*^9}, {3.733598508476384*^9, 3.733598508921424*^9}, {
   3.7335987355375443`*^9, 3.733598739163834*^9}, {3.733598793003971*^9, 
   3.733598863021151*^9}, {3.733598958247972*^9, 3.733598973401754*^9}, {
   3.733599016587936*^9, 3.733599036448422*^9}, {3.733599083195222*^9, 
   3.733599096669313*^9}, {3.733599152285111*^9, 3.733599208211561*^9}, 
   3.733599768772525*^9, 3.7336016078082323`*^9, {3.733601797199623*^9, 
   3.7336017973509912`*^9}, {3.733601921948431*^9, 3.733601924118101*^9}, {
   3.733602372780608*^9, 3.733602480980875*^9}, {3.733607785715536*^9, 
   3.733607899216687*^9}, {3.733608475166788*^9, 3.73360848047974*^9}, 
   3.733608835875473*^9, 3.733686803813751*^9, {3.7338436941583843`*^9, 
   3.733843696888975*^9}, {3.733845104293194*^9, 3.7338451388784122`*^9}, {
   3.7341086011762953`*^9, 3.734108608440586*^9}, {3.7341086826614122`*^9, 
   3.734108705532113*^9}, {3.7341088584811287`*^9, 3.73410888337792*^9}, {
   3.734139787733283*^9, 3.7341397947318*^9}, {3.73414021986346*^9, 
   3.7341402500782337`*^9}, {3.734140333980262*^9, 3.734140342532544*^9}, 
   3.734140579875409*^9, {3.734140646293427*^9, 3.7341406539811077`*^9}, {
   3.7341407385820007`*^9, 3.734140739941018*^9}, {3.734203893113785*^9, 
   3.7342039035954*^9}, {3.73421261216719*^9, 3.734212615892418*^9}, 
   3.734278554409746*^9, {3.7349639442561007`*^9, 3.73496395688518*^9}, {
   3.73523957673558*^9, 3.735239585668314*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"3efefcf1-c2a7-4658-bcf5-b564a8826099"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Append local background ratio:", "Subsubsection",
 CellChangeTimes->{{3.734969801636773*^9, 3.734969848836969*^9}, {
  3.735241101524466*^9, 
  3.735241106098493*^9}},ExpressionUUID->"13b5a6ab-d4dd-47e5-82c5-\
fe8d59cc8447"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataset4", "=", 
    RowBox[{"dataset3", "[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<LocalBackgroundRatio\>\"", "\[Rule]", 
           RowBox[{"Quiet", "[", 
            RowBox[{"calculateLocalBGRatio", "[", 
             RowBox[{
             "#Indices", ",", "#ExpIndex", ",", "#Interpolation", ",", 
              "dataset3", ",", "\"\<OptLinFitSlope\>\""}], "]"}], "]"}]}], 
          "}"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}]}], "Input",
 CellChangeTimes->{{3.733609022044655*^9, 3.733609129361319*^9}, 
   3.733609216589387*^9, {3.733609890275778*^9, 3.733609904486434*^9}, {
   3.733609994976199*^9, 3.733609995396483*^9}, {3.7336103614633913`*^9, 
   3.733610362014822*^9}, {3.7336104136690063`*^9, 3.733610414042047*^9}, {
   3.733610489026368*^9, 3.7336104893209457`*^9}, 3.7336872344942503`*^9, {
   3.7338451755070753`*^9, 3.733845177691243*^9}, {3.7338484666165752`*^9, 
   3.733848478627953*^9}, {3.733848595453981*^9, 3.733848595609212*^9}, {
   3.733848778192461*^9, 3.7338487785952578`*^9}, {3.734140822332056*^9, 
   3.7341408688425713`*^9}, {3.734140919612362*^9, 3.734140920219751*^9}, {
   3.7341410093735657`*^9, 3.7341410098957043`*^9}, {3.734203950418494*^9, 
   3.734203963277145*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"db82f1c4-85cc-4ba4-b030-7c0b55e0d71b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Make local background \[OpenCurlyDoubleQuote]Michaelis-Menten\
\[CloseCurlyDoubleQuote] plot, to identify chambers that may have compromised \
rates due to high relative background:\
\>", "Subsubsection",
 CellChangeTimes->{{3.734969801636773*^9, 
  3.734969848836969*^9}},ExpressionUUID->"9b9c03f2-5512-40a8-bc34-\
15c41caa7d00"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"indices", "=", 
    RowBox[{"Normal", "[", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"dataset4", "[", 
       RowBox[{"All", ",", "\"\<Indices\>\""}], "]"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MMBGplots", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Association", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Indices\>\"", "\[Rule]", 
          RowBox[{"indices", "[", 
           RowBox[{"[", "n", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<LocalBGMMPlot\>\"", "->", 
          RowBox[{"generateLocalBGMMPlot", "[", 
           RowBox[{
            RowBox[{"indices", "[", 
             RowBox[{"[", "n", "]"}], "]"}], ",", "dataset4", ",", 
            "\"\<OptLinFitSlope\>\""}], "]"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", "1568"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataset5", "=", 
    RowBox[{
     RowBox[{"Dataset", "[", 
      RowBox[{"JoinAcross", "[", 
       RowBox[{
        RowBox[{"Normal", "[", "dataset4", "]"}], ",", "MMBGplots", ",", 
        "\"\<Indices\>\"", ",", "\"\<Left\>\""}], "]"}], "]"}], "//", 
     "Quiet"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}]}], "Input",
 CellChangeTimes->{{3.7349698740895042`*^9, 3.73496988348495*^9}, {
   3.73496994942417*^9, 3.734969982181573*^9}, {3.734970049323257*^9, 
   3.734970144335096*^9}, {3.7349702498275642`*^9, 3.7349703689672947`*^9}, {
   3.7349705129947233`*^9, 3.734970517855542*^9}, {3.734970596579452*^9, 
   3.734970760235038*^9}, {3.734970810863413*^9, 3.73497088392238*^9}, {
   3.73497105634424*^9, 3.734971074546822*^9}, {3.734971112684774*^9, 
   3.734971142245185*^9}, {3.734972618018557*^9, 3.7349726267575493`*^9}, 
   3.73497276043355*^9, {3.734972874964286*^9, 3.7349729311486597`*^9}, {
   3.7349731427523003`*^9, 3.734973168989092*^9}, {3.734975213564021*^9, 
   3.734975260420424*^9}, {3.734975309768619*^9, 3.734975312248929*^9}, {
   3.734975365151463*^9, 3.7349753931090107`*^9}, {3.734975449238474*^9, 
   3.7349754515677633`*^9}, {3.7349758806009903`*^9, 3.734975880722917*^9}, {
   3.735240092530746*^9, 3.735240095769314*^9}, {3.735240145683536*^9, 
   3.7352401602979383`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"a5040f32-e911-4b5d-8252-68ebe4a78354"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Append local background plots:", "Subsubsection",
 CellChangeTimes->{{3.733621201347958*^9, 
  3.733621206447814*^9}},ExpressionUUID->"e86bae5e-30a3-4231-a170-\
c58a9d7babd1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataset6", "=", 
    RowBox[{"dataset5", "[", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<LocalBackgroundPlot\>\"", "\[Rule]", 
           RowBox[{"Quiet", "[", 
            RowBox[{"generateLocalBGPlot", "[", 
             RowBox[{"#Indices", ",", "#ExpIndex", ",", "#Interpolation", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<WT\>\"", ",", "\"\<T79S\>\""}], "}"}], ",", 
              "dataset5", ",", "\"\<OptLinFitSlope\>\""}], "]"}], "]"}]}], 
          "}"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTime", "[", "]"}], "-", "start"}]}], "Input",
 CellChangeTimes->{{3.73361624319683*^9, 3.733616246583975*^9}, {
   3.7336167207957582`*^9, 3.733616722480953*^9}, {3.73361683671169*^9, 
   3.7336168409706078`*^9}, {3.733620634815119*^9, 3.733620694691793*^9}, {
   3.7336207304675817`*^9, 3.7336207336315317`*^9}, {3.7336210662332287`*^9, 
   3.733621082204974*^9}, {3.7336211518541327`*^9, 3.733621157520652*^9}, {
   3.73362119690448*^9, 3.733621197668681*^9}, 3.733687244703673*^9, 
   3.733845214089003*^9, {3.733848683523692*^9, 3.733848722668034*^9}, {
   3.734141782894987*^9, 3.734141791496971*^9}, 3.734147411328787*^9, {
   3.734147470361533*^9, 3.734147474672205*^9}, {3.734147552810513*^9, 
   3.734147586529479*^9}, {3.7342039644550257`*^9, 3.734203971739805*^9}, {
   3.734204422282423*^9, 3.734204422505872*^9}, {3.7349671213150463`*^9, 
   3.734967121560965*^9}, {3.7352401094607573`*^9, 3.735240110721985*^9}, {
   3.7352401673127947`*^9, 3.735240171264042*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"e31ad947-1d98-4516-b7cc-65c687aa5149"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{
    "exportPath", ",", "outName", ",", "\"\<_working_2\>\"", ",", 
     "\"\<.mx\>\""}], "]"}], ",", "dataset6"}], "]"}]], "Input",
 CellChangeTimes->{{3.73524184961191*^9, 3.735241856603158*^9}, {
  3.736183425453065*^9, 3.736183428047298*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"67eda613-ee03-496a-b641-6f0a41c08034"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Append post-SDS eGFP images:", "Subsubsection",
 CellChangeTimes->{{3.7349674128747053`*^9, 
  3.7349674191287203`*^9}},ExpressionUUID->"337c1a85-9ab8-413b-9101-\
65978ef2e360"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"grouped", "=", 
    RowBox[{"dataset6", "[", 
     RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"indicesOut", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Values", "[", "#", "]"}], "&"}], "/@", 
     RowBox[{"Values", "[", 
      RowBox[{"Normal", "[", 
       RowBox[{"grouped", "[", 
        RowBox[{"All", ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<MutantID\>\"", ",", "\"\<Indices\>\""}], "}"}]}], 
        "]"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"addedImages", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<MutantID\>\"", "\[Rule]", 
         RowBox[{"indicesOut", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"\"\<Indices\>\"", "\[Rule]", 
         RowBox[{"indicesOut", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"\"\<eGFPPostSDSImage\>\"", "\[Rule]", 
         RowBox[{"getGFPImage", "[", 
          RowBox[{
           RowBox[{"indicesOut", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"indicesOut", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "2", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"indicesOut", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "2", ",", "2"}], "]"}], "]"}], ",", "75"}], 
          "]"}]}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "1568"}], "}"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.73496745461769*^9, 3.734967528383065*^9}, {
  3.734967950187125*^9, 3.734967957854609*^9}, {3.734968086903789*^9, 
  3.7349680877266283`*^9}, {3.735242742308928*^9, 3.7352427509907217`*^9}, {
  3.735245164153387*^9, 3.7352451711081867`*^9}, {3.736192318331418*^9, 
  3.736192346132526*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"be21ad37-c587-491d-b59f-48d36e20a5f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"addedImagesDataset", "=", 
   RowBox[{
    RowBox[{"Dataset", "[", 
     RowBox[{"JoinAcross", "[", 
      RowBox[{
       RowBox[{"Normal", "[", "dataset6", "]"}], ",", "addedImages", ",", 
       "\"\<Indices\>\"", ",", "\"\<Left\>\""}], "]"}], "]"}], "//", 
    "Quiet"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.73496745461769*^9, 3.734967528383065*^9}, {
   3.734967950187125*^9, 3.734967957854609*^9}, {3.734968086903789*^9, 
   3.7349680877266283`*^9}, {3.735242742308928*^9, 3.7352427509907217`*^9}, {
   3.735245164153387*^9, 3.7352451711081867`*^9}, 3.73699678476036*^9},
 CellLabel->"In[88]:=",ExpressionUUID->"2ffc3eee-a9f5-4e58-bf6b-5ba1dccfef50"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate plot of eGFP intensity per assay:", "Subsubsection",
 CellChangeTimes->{{3.7349685220676613`*^9, 
  3.734968531104865*^9}},ExpressionUUID->"0b6dd568-4c0b-48a3-aebe-\
858b663ead9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"grouped", "=", 
    RowBox[{"addedImagesDataset", "[", 
     RowBox[{"GroupBy", "[", "\"\<Indices\>\"", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"indicesOut", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Values", "[", "#", "]"}], "&"}], "/@", 
     RowBox[{"Values", "[", 
      RowBox[{"Normal", "[", 
       RowBox[{"grouped", "[", 
        RowBox[{"All", ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<MutantID\>\"", ",", "\"\<Indices\>\""}], "}"}]}], 
        "]"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addedeGFPIntensityPlot", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Association", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<MutantID\>\"", "\[Rule]", 
          RowBox[{"indicesOut", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"\"\<Indices\>\"", "\[Rule]", 
          RowBox[{"indicesOut", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "2"}], "]"}], "]"}]}], ",", 
         RowBox[{"\"\<eGFPIntensityPlot\>\"", "\[Rule]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", 
              RowBox[{"grouped", "[", 
               RowBox[{"n", ",", "All", ",", "\"\<eGFPSummedI\>\""}], "]"}], 
              "]"}], "/", 
             RowBox[{"10", "^", "6"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", 
                   RowBox[{"grouped", "[", 
                    RowBox[{"n", ",", "All", ",", "\"\<eGFPSummedI\>\""}], 
                    "]"}], "]"}], "/", 
                  RowBox[{"10", "^", "6"}]}], "]"}], "*", "1.5"}]}], "}"}]}], 
            ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"Axes", "\[Rule]", "False"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"Darker", "[", "Green", "]"}], ",", 
               RowBox[{"PointSize", "[", "0.02", "]"}]}], "]"}]}], ",", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Black", ",", "12"}], "]"}]}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Assay Number\>\"", ",", 
               "\"\<eGFP Intensity (\[Times]\!\(\*SuperscriptBox[\(10\), \
\(6\)]\))\>\""}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
            RowBox[{"ImagePadding", "\[Rule]", "50"}]}], "]"}]}]}], "}"}], 
       "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", "1568"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"addedeGFPIntensityPlotDataset", "=", 
   RowBox[{
    RowBox[{"Dataset", "[", 
     RowBox[{"JoinAcross", "[", 
      RowBox[{
       RowBox[{"Normal", "[", "addedImagesDataset", "]"}], ",", 
       "addedeGFPIntensityPlot", ",", "\"\<Indices\>\"", ",", 
       "\"\<Left\>\""}], "]"}], "]"}], "//", "Quiet"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.734968552318139*^9, 3.734968703004868*^9}, {
  3.734969003601969*^9, 3.734969006326923*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"7008d5d4-13f2-41c9-8f09-33c38b078bc1"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{
    "exportPath", ",", "outName", ",", "\"\<_working\>\"", ",", 
     "\"\<.mx\>\""}], "]"}], ",", "addedeGFPIntensityPlotDataset"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.73524526011444*^9, 3.735245266582426*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"1a65a750-2e9e-4ebe-a414-cdce384ee13a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Do MM/inhibition fitting on optimized initial rates:", "Subsubsection",
 CellChangeTimes->{{3.7329815105504503`*^9, 3.732981515226286*^9}, {
  3.732981619070964*^9, 3.732981628015257*^9}, {3.733845223994356*^9, 
  3.7338452243517427`*^9}, {3.733849127408181*^9, 3.7338491298183203`*^9}, {
  3.733862064706407*^9, 3.7338620683357077`*^9}, {3.734212743459549*^9, 
  3.734212746012377*^9}},ExpressionUUID->"a4595276-b22a-482d-aa39-\
8339f61f8871"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dynamic", "[", "n", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"addedMMcalc", "=", 
  RowBox[{
   RowBox[{"fitMichaelisMenten", "[", 
    RowBox[{
    "addedImagesDataset", ",", "\"\<OptLinFitSlope\>\"", ",", "\"\<Opt.\>\"", 
     ",", "1"}], "]"}], "//", "Quiet"}]}]}], "Input",
 CellChangeTimes->{{3.732828191302328*^9, 3.73282820710557*^9}, {
   3.7328284364936028`*^9, 3.732828443780792*^9}, {3.732831722315823*^9, 
   3.732831725378559*^9}, {3.732900269498952*^9, 3.732900284227059*^9}, 
   3.733627842458099*^9, {3.7336704770869513`*^9, 3.73367048142168*^9}, {
   3.733671111320716*^9, 3.733671115252977*^9}, {3.7337060190730667`*^9, 
   3.733706029288616*^9}, {3.733845227725439*^9, 3.733845238979539*^9}, {
   3.733862108776919*^9, 3.733862109808236*^9}, {3.733877026099456*^9, 
   3.7338770286980953`*^9}, {3.7340307316828737`*^9, 3.734030734614211*^9}, {
   3.734031051841358*^9, 3.734031052552471*^9}, {3.7340311685197153`*^9, 
   3.734031171251842*^9}, {3.734031202466367*^9, 3.7340312057294893`*^9}, {
   3.73403123892367*^9, 3.734031241868017*^9}, {3.734031311927002*^9, 
   3.7340313150240593`*^9}, {3.734031375414686*^9, 3.734031375531245*^9}, {
   3.7340316328876457`*^9, 3.734031632951627*^9}, {3.7340317948643007`*^9, 
   3.734031798620933*^9}, 3.7340319098772097`*^9, {3.7341899152854147`*^9, 
   3.7341899176423683`*^9}, {3.734190292020667*^9, 3.7341902934386883`*^9}, 
   3.734204328792881*^9, {3.7342111933645277`*^9, 3.734211195998844*^9}, 
   3.734212718065373*^9, {3.734214476969673*^9, 3.734214477961131*^9}, 
   3.7342161503453712`*^9, {3.734280476472961*^9, 3.734280480608233*^9}, {
   3.734282068346632*^9, 3.734282072801738*^9}, {3.734284446225918*^9, 
   3.734284447452318*^9}, {3.734289449929234*^9, 3.734289455413281*^9}, {
   3.734293937976171*^9, 3.734293939353435*^9}, {3.734408618480233*^9, 
   3.7344086200634623`*^9}, {3.734428148192651*^9, 3.73442814842953*^9}, {
   3.7345375760242147`*^9, 3.734537578938105*^9}, {3.734625945116146*^9, 
   3.734625958278081*^9}, {3.734701607148691*^9, 3.7347016080603237`*^9}, {
   3.735069144627019*^9, 3.735069151191079*^9}, {3.7350693272740803`*^9, 
   3.7350693278059998`*^9}, 3.7352452570344667`*^9, {3.7352455282449703`*^9, 
   3.735245532713469*^9}, {3.7352474475063753`*^9, 3.7352474505937243`*^9}, 
   3.735580027016666*^9, 3.736183453681279*^9, 3.736192415468719*^9, {
   3.73698954441826*^9, 3.736989548224608*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"beff489b-d264-4303-896c-44ee63611e2d"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{"exportPath", ",", "outName", ",", "\"\<.mx\>\""}], "]"}], ",", 
   "addedMMcalc"}], "]"}]], "Input",
 CellChangeTimes->{{3.735252766931054*^9, 3.735252772552207*^9}, 
   3.736707448959117*^9, {3.736715700061947*^9, 3.736715700099522*^9}, {
   3.7369967944515953`*^9, 3.7369967975666656`*^9}, 
   3.7371259605049953`*^9},ExpressionUUID->"86d64f19-d61b-4452-8a79-\
741e0261b63b"]
}, Open  ]],

Cell["Export aggregate dataset:", "Subsubsection",
 CellChangeTimes->{{3.734212756608108*^9, 
  3.734212760958433*^9}},ExpressionUUID->"9a77bf06-7afb-476f-adeb-\
341a0fd5b4b5"],

Cell[CellGroupData[{

Cell["\<\
Export CSV of all compatible data types (string, integer, list, real):\
\>", "Subsubsection",
 CellChangeTimes->{{3.734189486408122*^9, 
  3.7341895106160927`*^9}},ExpressionUUID->"2a7e32a4-2445-4f03-b154-\
5dba791a4164"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"headers", "=", 
   RowBox[{
    RowBox[{"Keys", "[", 
     RowBox[{"addedMMcalc", "[", "1", "]"}], "]"}], "//", "Normal"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"headers", "[", 
         RowBox[{"[", "n", "]"}], "]"}], ",", 
        RowBox[{"Head", "[", 
         RowBox[{"Normal", "[", 
          RowBox[{"addedMMcalc", "[", 
           RowBox[{"1", ",", 
            RowBox[{"headers", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", 
        RowBox[{"Length", "[", "headers", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"headersforcsv", "=", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"test", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "String"}], "||", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "Integer"}], "||", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "List"}], "||", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "Real"}]}], "&"}]}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"datasetForExport", "=", 
    RowBox[{"addedMMcalc", "[", 
     RowBox[{"All", ",", "headersforcsv"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{"exportPath", ",", "outName", ",", "\"\<.csv\>\""}], "]"}], ",", 
   "datasetForExport", ",", "\"\<Data\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.733704366135131*^9, 3.733704369820709*^9}, {
   3.7337044363656282`*^9, 3.733704446172799*^9}, {3.733704601732699*^9, 
   3.733704602627078*^9}, {3.7341958704939528`*^9, 3.734195873535461*^9}, {
   3.7342878923985577`*^9, 3.734287899614099*^9}, 3.735251217099908*^9, 
   3.735251257247861*^9, {3.735252803713551*^9, 3.73525282893347*^9}, {
   3.7352528634432096`*^9, 3.735252864477409*^9}, {3.735252899175758*^9, 
   3.7352528995179377`*^9}, {3.7352529310409403`*^9, 3.735253046953968*^9}, {
   3.735253085638761*^9, 3.735253090425413*^9}, {3.735253125090653*^9, 
   3.735253168608924*^9}, {3.735253211539119*^9, 3.7352532402965717`*^9}, {
   3.7352533220065813`*^9, 3.7352533438323383`*^9}, {3.735253496220271*^9, 
   3.7352534965655317`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"8dec5511-07cc-4276-98cc-1ee71122fe6d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate summary PDF pages:", "Subsubsection",
 CellChangeTimes->{{3.7349637995225077`*^9, 
  3.734963809455359*^9}},ExpressionUUID->"19749ecf-f6e0-42cc-8b75-\
d68f97e3f392"],

Cell["\<\
Individual PDF pages are output to a working directory. Stitching of PDFs is \
done using an external python session running PyPDF2.\
\>", "Text",
 CellChangeTimes->{{3.734963811562787*^9, 
  3.7349638470087233`*^9}},ExpressionUUID->"b9b7db25-3143-4281-8a95-\
103b684baa21"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"indices", "=", 
    RowBox[{"Normal", "[", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"addedMMcalc", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "\"\<Indices\>\""}], "]"}], "]"}], "]"}], "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dynamic", "[", "n", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"out", "=", 
     RowBox[{"makeGrid", "[", 
      RowBox[{"addedMMcalc", ",", 
       RowBox[{"indices", "[", 
        RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{
       "\"\</Users/craig/Dropbox/craig_analysis_and_simulation_code/temp_PDF_\
pages/\>\"", ",", "outName", ",", "\"\<_\>\"", ",", 
        RowBox[{"ToString", "[", "n", "]"}], ",", "\"\<.pdf\>\""}], "]"}], 
      ",", "out"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "1568"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.734968802754878*^9, 3.73496884924994*^9}, {
   3.734975973828043*^9, 3.7349759785186768`*^9}, {3.7349761556127987`*^9, 
   3.734976157836526*^9}, {3.734976630964161*^9, 3.7349767728034477`*^9}, {
   3.7352407445428658`*^9, 3.735240807389244*^9}, 3.735253388922279*^9, {
   3.73525347071425*^9, 3.735253473917111*^9}, {3.7352708205551977`*^9, 
   3.73527082126511*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"3c0623a5-3c95-412f-8fd7-d672e4904b7f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Join PDFs:", "Subsubsection",
 CellChangeTimes->{{3.735240822666081*^9, 
  3.735240825410522*^9}},ExpressionUUID->"d3a4e2aa-ed1a-4548-b455-\
2383a6a468f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"session", " ", "=", " ", 
   RowBox[{"StartExternalSession", "[", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<System\>\"", "\[Rule]", "\"\<Python\>\""}], ",", 
      RowBox[{"\"\<Version\>\"", "\[Rule]", "\"\<3.6\>\""}], ",", " ", 
      RowBox[{"\"\<SessionProlog\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<import os\>\"", ",", " ", 
         "\"\<from PyPDF2 import PdfFileMerger\>\""}], "}"}]}]}], "|>"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "defineRoot", " ", "=", " ", 
   "\"\<'/Users/craig/Dropbox/craig_analysis_and_simulation_code/temp_PDF_\
pages'\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "getNames", " ", "=", " ", 
   "\"\<pdfs=[os.path.join(root, dir) for dir in os.listdir(root)]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"createMerger", " ", "=", " ", "\"\<merger = PdfFileMerger()\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "executeMerge", " ", "=", " ", 
   "\"\<for pdf in pdfs: merger.append(open(pdf,'rb'))\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "executeExport", " ", "=", " ", 
   "\"\<with \
open('/Users/craig/Dropbox/craig_analysis_and_simulation_code/temp_PDF_pages/\
result.pdf', 'wb') as fout: merger.write(fout)\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "completionNotice", " ", "=", " ", 
   "\"\<print('PDF Concatenation Complete')\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.735240835805632*^9, 3.7352408695676327`*^9}, {
  3.7352723452425337`*^9, 3.735272349764186*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"946b4ba4-865e-4336-9b60-f546d098f1f7"],

Cell[BoxData[
 RowBox[{"ExternalEvaluate", "[", 
  RowBox[{"session", ",", 
   RowBox[{"{", 
    RowBox[{
    "defineRoot", ",", " ", "getNames", ",", " ", "createMerger", ",", " ", 
     "executeMerge", ",", " ", "executeExport", ",", " ", 
     "completionNotice"}], "}"}]}], "]"}]], "Input",
 CellLabel->
  "In[116]:=",ExpressionUUID->"a93208ea-ec8f-4307-bf90-42fcea504d6f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1794, 979},
WindowMargins->{{51, Automatic}, {46, Automatic}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 168, 3, 98, "Title",ExpressionUUID->"eb34816b-48f3-4f71-97ba-9ae535b70148"],
Cell[751, 27, 334, 6, 30, "Input",ExpressionUUID->"602aa742-052b-42c3-81fa-f44bf04ee6fc"],
Cell[CellGroupData[{
Cell[1110, 37, 177, 3, 67, "Section",ExpressionUUID->"af3b0309-97dd-46b1-9be6-5230c63f43b2"],
Cell[1290, 42, 224169, 4976, 19, "Input",ExpressionUUID->"3910e96f-8244-473b-938a-b403469393f0",
 CellOpen->False]
}, Open  ]],
Cell[CellGroupData[{
Cell[225496, 5023, 225, 4, 67, "Section",ExpressionUUID->"ba452b1b-3762-41f2-91e4-7d42bc0a6dd5"],
Cell[225724, 5029, 4182, 98, 535, "Input",ExpressionUUID->"c302fd43-2b8c-4e60-afba-6a3c47888d9d"],
Cell[229909, 5129, 9752, 170, 304, "Input",ExpressionUUID->"bc4ea9a4-2bd6-45db-834f-23c53e78f053"]
}, Open  ]],
Cell[CellGroupData[{
Cell[239698, 5304, 249, 4, 67, "Section",ExpressionUUID->"46e27fd9-8d24-4613-b1a0-27d6bce139d6"],
Cell[CellGroupData[{
Cell[239972, 5312, 354, 7, 45, "Subsubsection",ExpressionUUID->"eb4fc38c-b472-4b23-b4ea-71356699cde5"],
Cell[240329, 5321, 5619, 114, 262, "Input",ExpressionUUID->"1ba4cf3e-134b-4920-8d7d-da19aaefba58"]
}, Open  ]],
Cell[CellGroupData[{
Cell[245985, 5440, 263, 6, 45, "Subsubsection",ExpressionUUID->"90a02fae-a082-4e0b-aaf6-3e6c65bea02b"],
Cell[246251, 5448, 1004, 21, 30, "Input",ExpressionUUID->"020e7c04-ccbf-48e6-ac02-7e810e3b4931"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247292, 5474, 387, 6, 45, "Subsubsection",ExpressionUUID->"fdcbc86f-9ea8-4ab0-aac9-25db2a59b58d"],
Cell[247682, 5482, 2154, 50, 157, "Input",ExpressionUUID->"24a33a3f-3bbb-47aa-835d-506a68ef003a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[249873, 5537, 270, 6, 45, "Subsubsection",ExpressionUUID->"71f596cf-7b6c-420d-81ae-6efee26753b4"],
Cell[250146, 5545, 2158, 42, 73, "Input",ExpressionUUID->"4c211c7a-e762-49ad-bb87-c165bf8ea733"]
}, Open  ]],
Cell[CellGroupData[{
Cell[252341, 5592, 226, 5, 45, "Subsubsection",ExpressionUUID->"83393b69-ef95-427b-bfe9-34cc7352c217"],
Cell[252570, 5599, 3346, 70, 199, "Input",ExpressionUUID->"a8b62022-0b11-421c-8c76-1a28082b915a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[255953, 5674, 419, 6, 45, "Subsubsection",ExpressionUUID->"3fd01350-f90b-405e-8382-cca5f2b27724"],
Cell[256375, 5682, 3551, 75, 199, "Input",ExpressionUUID->"8fbc1de9-211a-4c72-a4c2-8e0fda11c9d3"],
Cell[259929, 5759, 372, 8, 30, "Input",ExpressionUUID->"915a79b7-c4c1-4219-aaab-395fd1587fee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[260338, 5772, 379, 7, 45, "Subsubsection",ExpressionUUID->"b5a10a85-42c8-40e5-a998-bbd7c06e8165"],
Cell[260720, 5781, 3477, 75, 304, "Input",ExpressionUUID->"179ae7d0-b320-4a9e-9721-ee7c827c970b"],
Cell[264200, 5858, 371, 8, 30, "Input",ExpressionUUID->"2b43163e-163c-471c-b2fb-26fb2703a01a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264608, 5871, 282, 6, 45, "Subsubsection",ExpressionUUID->"0ec943ab-e138-4783-8a7e-21fdc19d6b49"],
Cell[264893, 5879, 4890, 108, 388, "Input",ExpressionUUID->"3efefcf1-c2a7-4658-bcf5-b564a8826099"]
}, Open  ]],
Cell[CellGroupData[{
Cell[269820, 5992, 230, 4, 45, "Subsubsection",ExpressionUUID->"13b5a6ab-d4dd-47e5-82c5-fe8d59cc8447"],
Cell[270053, 5998, 1706, 36, 115, "Input",ExpressionUUID->"db82f1c4-85cc-4ba4-b030-7c0b55e0d71b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[271796, 6039, 340, 7, 45, "Subsubsection",ExpressionUUID->"9b9c03f2-5512-40a8-bc34-15c41caa7d00"],
Cell[272139, 6048, 2804, 64, 241, "Input",ExpressionUUID->"a5040f32-e911-4b5d-8252-68ebe4a78354"]
}, Open  ]],
Cell[CellGroupData[{
Cell[274980, 6117, 181, 3, 45, "Subsubsection",ExpressionUUID->"e86bae5e-30a3-4231-a170-c58a9d7babd1"],
Cell[275164, 6122, 1955, 39, 115, "Input",ExpressionUUID->"e31ad947-1d98-4516-b7cc-65c687aa5149"],
Cell[277122, 6163, 418, 9, 30, "Input",ExpressionUUID->"67eda613-ee03-496a-b641-6f0a41c08034"]
}, Open  ]],
Cell[CellGroupData[{
Cell[277577, 6177, 183, 3, 45, "Subsubsection",ExpressionUUID->"337c1a85-9ab8-413b-9101-65978ef2e360"],
Cell[277763, 6182, 2196, 57, 115, "Input",ExpressionUUID->"be21ad37-c587-491d-b59f-48d36e20a5f3"],
Cell[279962, 6241, 696, 14, 30, "Input",ExpressionUUID->"2ffc3eee-a9f5-4e58-bf6b-5ba1dccfef50"]
}, Open  ]],
Cell[CellGroupData[{
Cell[280695, 6260, 195, 3, 45, "Subsubsection",ExpressionUUID->"0b6dd568-4c0b-48a3-aebe-858b663ead9c"],
Cell[280893, 6265, 3641, 91, 249, "Input",ExpressionUUID->"7008d5d4-13f2-41c9-8f09-33c38b078bc1"],
Cell[284537, 6358, 391, 9, 30, "Input",ExpressionUUID->"1a65a750-2e9e-4ebe-a414-cdce384ee13a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[284965, 6372, 450, 6, 45, "Subsubsection",ExpressionUUID->"a4595276-b22a-482d-aa39-8339f61f8871"],
Cell[285418, 6380, 2542, 39, 73, "Input",ExpressionUUID->"beff489b-d264-4303-896c-44ee63611e2d"],
Cell[287963, 6421, 471, 10, 30, "Input",ExpressionUUID->"86d64f19-d61b-4452-8a79-741e0261b63b"]
}, Open  ]],
Cell[288449, 6434, 176, 3, 45, "Subsubsection",ExpressionUUID->"9a77bf06-7afb-476f-adeb-341a0fd5b4b5"],
Cell[CellGroupData[{
Cell[288650, 6441, 231, 5, 37, "Subsubsection",ExpressionUUID->"2a7e32a4-2445-4f03-b154-5dba791a4164"],
Cell[288884, 6448, 2856, 73, 199, "Input",ExpressionUUID->"8dec5511-07cc-4276-98cc-1ee71122fe6d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[291777, 6526, 180, 3, 45, "Subsubsection",ExpressionUUID->"19749ecf-f6e0-42cc-8b75-d68f97e3f392"],
Cell[291960, 6531, 284, 6, 35, "Text",ExpressionUUID->"b9b7db25-3143-4281-8a95-103b684baa21"],
Cell[292247, 6539, 1618, 38, 178, "Input",ExpressionUUID->"3c0623a5-3c95-412f-8fd7-d672e4904b7f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[293902, 6582, 161, 3, 45, "Subsubsection",ExpressionUUID->"d3a4e2aa-ed1a-4548-b455-2383a6a468f8"],
Cell[294066, 6587, 1705, 46, 178, "Input",ExpressionUUID->"946b4ba4-865e-4336-9b60-f546d098f1f7"],
Cell[295774, 6635, 377, 9, 30, "Input",ExpressionUUID->"a93208ea-ec8f-4307-bf90-42fcea504d6f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

